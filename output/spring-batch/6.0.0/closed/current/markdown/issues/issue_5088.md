# Potential parameter key collision in `.getUniqueJobParameters()`

**Issueç•ªå·**: #5088

**çŠ¶æ…‹**: closed | **ä½œæˆè€…**: PENEKhun | **ä½œæˆæ—¥**: 2025-11-16

**ãƒ©ãƒ™ãƒ«**: in: documentation, in: core, type: enhancement

**URL**: https://github.com/spring-projects/spring-batch/issues/5088

## å†…å®¹

**Expected Behavior**

<!--- Tell us how it should work. Add a code example to explain what you think the feature should look like. This is optional, but it would help up understand your expectations. -->

The key used for the job parameter generated by getUniqueJobParameters() should never conflict with parameter names defined in a userâ€™s job. Users should be able to call getUniqueJobParametersBuilder() and add any parameter name freely, without the risk of overwriting the framework-generated unique parameter.

**Current Behavior**

Currently, `getUniqueJobParameters()` uses a hardcoded `"random"` key.

```java
public JobParameters getUniqueJobParameters() {
    return new JobParameters(Set.of(
        new JobParameter<>("random", this.secureRandom.nextLong(), Long.class)
    ));
}
```

This creates a collision risk because

```java
JobParameters params = jobOperatorTestUtils.getUniqueJobParametersBuilder()
    .addLong("random", 12345L)  // Overwrites the unique parameter!
    .toJobParameters();
```

The current behavior makes it impossible to safely use getUniqueJobParametersBuilder() when a userâ€™s job already defines a parameter named "random". In this case, the user-provided "random" parameter overwrites the framework-generated one, creating an unintended collision.

**Context**

<!--- 
How has this issue affected you?
What are you trying to accomplish?
What other alternatives have you considered?
Are you aware of any workarounds?
-->

- Q: What other alternatives have you considered?
  - 1. **Use a namespaced key** (e.g., `spring.batch.test.unique`) instead `random` key.
  - 2. **UUID as key + descriptive value** (e.g., `{UUID="Auto-generated by Spring Batch Test for unique job parameters"}`)






## ã‚³ãƒ¡ãƒ³ãƒˆ

### ã‚³ãƒ¡ãƒ³ãƒˆ 1 by fmbenhassine

**ä½œæˆæ—¥**: 2025-11-17

> The key used for the job parameter generated by getUniqueJobParameters() should never conflict with parameter names defined in a userâ€™s job.

It is the opposite: user defined parameter names should never conflict with those provided by the framework. The method `getUniqueJobParameters` mentions that it adds a random number but does not specify the parameter name (which is `random`). Two things:

- Parameters provided by the framework should be prefixed with `batch.` (similar to execution context attributes)
- The method `getUniqueJobParameters` should be updated to add the `batch.` prefix to the `random` parameter and mentions that clearly in the Javadoc.

### ã‚³ãƒ¡ãƒ³ãƒˆ 2 by PENEKhun

**ä½œæˆæ—¥**: 2025-11-17

> > The key used for the job parameter generated by getUniqueJobParameters() should never conflict with parameter names defined in a userâ€™s job.
> 
> It is the opposite: user defined parameter names should never conflict with those provided by the framework. The method `getUniqueJobParameters` mentions that it adds a random number but does not specify the parameter name (which is `random`). Two things:
> 
> * Parameters provided by the framework should be prefixed with `batch.` (similar to execution context attributes)
> * The method `getUniqueJobParameters` should be updated to add the `batch.` prefix to the `random` parameter and mentions that clearly in the Javadoc.

I applied at https://github.com/spring-projects/spring-batch/pull/5089 . Thank you!

### ã‚³ãƒ¡ãƒ³ãƒˆ 3 by fmbenhassine

**ä½œæˆæ—¥**: 2025-11-18

Resolved in #5089. Thank you for your contribution ğŸ™

