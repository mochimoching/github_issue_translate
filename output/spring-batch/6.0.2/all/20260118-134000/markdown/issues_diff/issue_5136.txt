Issue #5136: The implementation of jumpToItem(int itemLastIndex) in AbstractPaginatedDataItemReader does not handle restart behavior correctly.
Reference: PR #5137 (2025-12-05T15:08:28Z)
URL: https://github.com/spring-projects/spring-batch/pull/5137

--- Diff ---
diff --git a/spring-batch-infrastructure/src/main/java/org/springframework/batch/infrastructure/item/data/AbstractPaginatedDataItemReader.java b/spring-batch-infrastructure/src/main/java/org/springframework/batch/infrastructure/item/data/AbstractPaginatedDataItemReader.java
index 8dcd5e749a..fff83d1df2 100644
--- a/spring-batch-infrastructure/src/main/java/org/springframework/batch/infrastructure/item/data/AbstractPaginatedDataItemReader.java
+++ b/spring-batch-infrastructure/src/main/java/org/springframework/batch/infrastructure/item/data/AbstractPaginatedDataItemReader.java
@@ -118,9 +118,10 @@ protected void jumpToItem(int itemLastIndex) throws Exception {
 
 			Iterator<T> initialPage = doPageRead();
 
-			for (; current >= 0; current--) {
+			for (; current > 0; current--) {
 				initialPage.next();
 			}
+			this.results = initialPage;
 		}
 		finally {
 			this.lock.unlock();
diff --git a/spring-batch-infrastructure/src/test/java/org/springframework/batch/infrastructure/item/data/AbstractPaginatedDataItemReaderTests.java b/spring-batch-infrastructure/src/test/java/org/springframework/batch/infrastructure/item/data/AbstractPaginatedDataItemReaderTests.java
new file mode 100644
index 0000000000..87581f97ed
--- /dev/null
+++ b/spring-batch-infrastructure/src/test/java/org/springframework/batch/infrastructure/item/data/AbstractPaginatedDataItemReaderTests.java
@@ -0,0 +1,72 @@
+package org.springframework.batch.infrastructure.item.data;
+
+import org.junit.jupiter.api.Test;
+import org.springframework.batch.infrastructure.item.ExecutionContext;
+
+import java.util.Iterator;
+import java.util.List;
+
+import static org.junit.jupiter.api.Assertions.*;
+
+class AbstractPaginatedDataItemReaderTests {
+
+  static class PaginatedDataItemReader extends AbstractPaginatedDataItemReader<Integer> {
+
+    private final List<Integer> data = List.of(
+        0,1,2,3,4,5,6,7,8,9,
+        10,11,12,13,14,15,16,17,18,19
+    );
+
+    @Override
+    protected Iterator<Integer> doPageRead() {
+      int start = page * pageSize;
+      int end = Math.min(start + pageSize, data.size());
+      return data.subList(start, end).iterator();
+    }
+  }
+
+  @Test
+  void jumpToItem_shouldReadExactItem_afterJump() throws Exception {
+    PaginatedDataItemReader reader = new PaginatedDataItemReader();
+    reader.open(new ExecutionContext());
+
+    reader.jumpToItem(7);
+
+    Integer value = reader.read();
+    assertEquals(7, value);
+  }
+
+  @Test
+  void jumpToItem_zeroIndex() throws Exception {
+    PaginatedDataItemReader reader = new PaginatedDataItemReader();
+    reader.open(new ExecutionContext());
+
+    reader.jumpToItem(0);
+
+    Integer value = reader.read();
+    assertEquals(0, value);
+  }
+
+  @Test
+  void jumpToItem_lastItemInPage() throws Exception {
+    PaginatedDataItemReader reader = new PaginatedDataItemReader();
+    reader.open(new ExecutionContext());
+
+    reader.jumpToItem(9);
+
+    Integer value = reader.read();
+    assertEquals(9, value);
+  }
+
+  @Test
+  void jumpToItem_firstItemOfNextPage() throws Exception {
+    PaginatedDataItemReader reader = new PaginatedDataItemReader();
+    reader.open(new ExecutionContext());
+
+    reader.jumpToItem(10);
+
+    Integer value = reader.read();
+    assertEquals(10, value);
+  }
+
+}
\ No newline at end of file
diff --git a/spring-batch-infrastructure/src/test/java/org/springframework/batch/infrastructure/item/database/AbstractPagingItemReaderTests.java b/spring-batch-infrastructure/src/test/java/org/springframework/batch/infrastructure/item/database/AbstractPagingItemReaderTests.java
new file mode 100644
index 0000000000..dd04194355
--- /dev/null
+++ b/spring-batch-infrastructure/src/test/java/org/springframework/batch/infrastructure/item/database/AbstractPagingItemReaderTests.java
@@ -0,0 +1,77 @@
+package org.springframework.batch.infrastructure.item.database;
+
+import org.junit.jupiter.api.Test;
+import org.springframework.batch.infrastructure.item.ExecutionContext;
+
+import java.util.ArrayList;
+import java.util.List;
+
+import static org.junit.jupiter.api.Assertions.*;
+
+class AbstractPagingItemReaderTests {
+
+  static class PagingItemReader extends AbstractPagingItemReader<Integer> {
+
+    private final List<Integer> data = List.of(
+        0,1,2,3,4,5,6,7,8,9,
+        10,11,12,13,14,15,16,17,18,19
+    );
+
+    @Override
+    protected void doReadPage() {
+      int start = getPage() * getPageSize();
+      int end = Math.min(start + getPageSize(), data.size());
+
+      if (start >= data.size()) {
+        results = List.of();
+        return;
+      }
+
+      List<Integer> pageData = new ArrayList<>();
+      for (int i = start; i < end; i++) {
+        pageData.add(data.get(i));
+      }
+
+      this.results = pageData;
+    }
+
+    @Override
+    protected void doOpen() {}
+  }
+
+  @Test
+  void jumpToItem_shouldReadExactItem_afterJump() throws Exception {
+    PagingItemReader reader = new PagingItemReader();
+    reader.open(new ExecutionContext());
+
+    reader.jumpToItem(7);
+    assertEquals(7, reader.read());
+  }
+
+  @Test
+  void jumpToItem_zeroIndex() throws Exception {
+    PagingItemReader reader = new PagingItemReader();
+    reader.open(new ExecutionContext());
+
+    reader.jumpToItem(0);
+    assertEquals(0, reader.read());
+  }
+
+  @Test
+  void jumpToItem_lastItemInFirstPage() throws Exception {
+    PagingItemReader reader = new PagingItemReader();
+    reader.open(new ExecutionContext());
+
+    reader.jumpToItem(9);
+    assertEquals(9, reader.read());
+  }
+
+  @Test
+  void jumpToItem_firstItemOfNextPage() throws Exception {
+    PagingItemReader reader = new PagingItemReader();
+    reader.open(new ExecutionContext());
+
+    reader.jumpToItem(10);
+    assertEquals(10, reader.read());
+  }
+}
\ No newline at end of file
