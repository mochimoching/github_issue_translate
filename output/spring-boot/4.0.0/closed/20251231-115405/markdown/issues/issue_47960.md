# Document the level of support for the OpenTelemetry APIs

**Issue番号**: #47960

**状態**: closed | **作成者**: ThomasVitale | **作成日**: 2025-11-05

**ラベル**: type: documentation, theme: opentelemetry

**URL**: https://github.com/spring-projects/spring-boot/issues/47960

**関連リンク**:
- Commits:
  - [62177a1](https://github.com/spring-projects/spring-boot/commit/62177a1cd7b8fd6f0bf016a7a3ca32be8c5b7c3a)
  - [995e856](https://github.com/spring-projects/spring-boot/commit/995e8560f56b2f51abfe12a6e5efd8f36563c4c3)

## 内容

The Spring Boot OpenTelemetry Starter has mixed support for the OpenTelemetry APIs.

It would be useful to document this in the [OpenTelemetry Support](https://docs.spring.io/spring-boot/4.0-SNAPSHOT/reference/actuator/observability.html#actuator.observability.opentelemetry) section of the docs.

| Aspect | OpenTelemetry API | OpenTelemetry Exporter API | OTLP | OpenTelemetry Environment Variables Spec |
|---|---:|---:|---:|---:|
| Logging | ✅ |✅* |✅* |⚠️ |
| Metrics | ❌ |❌ |✅ |⚠️ |
| Tracing | ✅ |✅ |✅ |⚠️ |

_* No log is actually collected nor exported, since there is no support in Spring Boot for bridging logs from SLF4J/Logback/Log4J._

The key part is that metrics are only supported when registered via the Micrometer API. The OpenTelemetry Metrics API can be used to register metrics (since it's in the classpath), but all the metrics registered in that way will be ignored (as decided in https://github.com/spring-projects/spring-boot/issues/36546). So it's a potential source of confusion and something I'd recommend documenting. One of the consequence of this situation, is that the Resource API-related config used for logs and traces is not shared with the metrics support (related issue: https://github.com/spring-projects/spring-boot/issues/46229).

On the other hand, there is support for registering traces both via OpenTelemetry Tracing API and Micrometer Tracing API. That adds on the confusion since support for the two observability signals is not consistent.

Another difference is in how the observability signals can be exported. For logs and traces, there is suppport for the OpenTelemetry Exporter API (only the OTLP implementation is supported by Spring Boot, but a developer could plug in a different implementation on their own). For metrics, there is not. Furthermore, logs are not collected from SLF4J/Logback/Log4J, so no log is actually exported (though, the plumbing is there for developers to add this feature on their own using the OpenTelemetry Java Instrumentation). 

Finally, support for the OpenTelemetry Environment Variables specification is partially supported for the Resource API and a few more cases, but most environment variables are not supported. It would be nice to document which ones are supported (related issue: https://github.com/spring-projects/spring-boot/issues/47646).


## コメント

### コメント 1 by mhalbritter

**作成日**: 2025-11-10

Thanks for the suggestion and the nice work of collecting issues, @ThomasVitale . I've pushed something which should show up soon on [the snapshot docs](https://docs.spring.io/spring-boot/4.0-SNAPSHOT/reference/actuator/observability.html#actuator.observability.opentelemetry).

Please let me know what you think.

### コメント 2 by ThomasVitale

**作成日**: 2025-11-10

@mhalbritter thanks so much for working on this so quickly! I like the clarity of the new documentation!

Only one comment about this part:

> Logging and tracing use the OpenTelemetry SDK directly, so all environment variables [supported by OpenTelemetry](https://opentelemetry.io/docs/specs/otel/configuration/sdk-environment-variables/) also work.

As far as I can tell, even though the SDKs are used directly, the environment variables are not used because the various beans are constructed based on the values from the configuration properties (e.g. `management.opentelemetry.tracing.export.otlp.endpoint`). Wouldn't there be a need to read the env vars explicitly?

### コメント 3 by mhalbritter

**作成日**: 2025-11-11

Oh yeah, you're right. To get OpenTelemetry SDK to respect the variables, you have to use the [Zero-code SDK autoconfigure](https://opentelemetry.io/docs/languages/java/configuration/#zero-code-sdk-autoconfigure), which we don't do.

I've clarified the documentation and also added an example how to use `AutoConfiguredOpenTelemetrySdk`.

### コメント 4 by ThomasVitale

**作成日**: 2025-11-11

Great, thank you!

