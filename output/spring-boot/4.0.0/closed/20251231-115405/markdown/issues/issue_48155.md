# Elasticsearch client's sniffer functionality should not be enabled by default

**Issue番号**: #48155

**状態**: closed | **作成者**: anbusampath | **作成日**: 2025-11-17

**ラベル**: type: bug

**URL**: https://github.com/spring-projects/spring-boot/issues/48155

**関連リンク**:
- Commits:
  - [5e48766](https://github.com/spring-projects/spring-boot/commit/5e4876671d60eaf649f3dc2a38cf6874c46e2914)
  - [ae4bf3e](https://github.com/spring-projects/spring-boot/commit/ae4bf3e501d0fea7b7ab9b6e8799aab5cbec9446)

## 内容

Refer - https://github.com/spring-projects/spring-boot/issues/47301#issuecomment-3542187734 for background.

Elasticsearch Java Client 9.0.0 introduced [Rest5Client](https://www.elastic.co/docs/release-notes/elasticsearch/clients/java/9-0-0) which is drop-in replacement for [elasticsearch-rest-client ](https://mvnrepository.com/artifact/org.elasticsearch.client/elasticsearch-rest-client)and [elasticsearch-rest-client-sniffer](https://mvnrepository.com/artifact/org.elasticsearch.client/elasticsearch-rest-client-sniffer).

Spring Boot 3 enables sniffer feature only if elasticsearch-rest-client-sniffer dependency available on classpath. On cloud deployment, it is advised to not use sniff explained in [When not to sniff?](https://www.elastic.co/blog/elasticsearch-sniffing-best-practices-what-when-why-how). Spring Boot 4 enabled it by default. Since sniffing is optional opt-in feature, it is better to disable by default. 

Disable by default keeps functionally equal to previous version.

@l-trotta @filiphr Please share your thought as well.


## コメント

### コメント 1 by filiphr

**作成日**: 2025-11-17

Thanks for raising this @anbusampath. We personally never used the Sniffer. With Spring Boot 4 we are also disabling that by default and leave it to our users to enable it if they want to use it.

In any case reading the blog post you've shared I can imagine that people might have more problems if sniffing is enabled by default and they do not really understand it. From that point of view I would vote for making it opt-in in Spring Boot itself as well. 

### コメント 2 by wilkinsona

**作成日**: 2025-11-17

I think this section of the best practices blog post is key:

> The main takeaway from this is you should know your infrastructure before you enable sniffing. There are many solutions to this IP address issue, and there is no silver bullet, because it all depends on your system configuration.

We should disable it by default in Boot. Thanks for raising this, @anbusampath.

