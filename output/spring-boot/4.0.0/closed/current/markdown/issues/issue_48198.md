# With both Jackson 2 and 3 on the classpath, @JsonTest fails due to duplicate jacksonTesterFactoryBean

**Issue番号**: #48198

**状態**: closed | **作成者**: goafabric | **作成日**: 2025-11-20

**ラベル**: type: bug

**URL**: https://github.com/spring-projects/spring-boot/issues/48198

**関連リンク**:
- Commits:
  - [81ec7ae](https://github.com/spring-projects/spring-boot/commit/81ec7aeb703e7434288fcfa81260dc4d97d04620)

## 内容

When using the "funky" combination of 
- Spring Boot 4.0 (RC2)
- AOT Test Processing
- @JsonTest
- Legacy  spring-boot-jackson2 dependency

We get the following error below.
This may be a drastic combination, but its currently used in some of our projects.
Removing spring-boot-jackson2 solves the issue.

The problem persists in latest SNAPSHOT (20.11.2025)

Minimal Producer is attached.

```
Caused by: org.springframework.beans.factory.support.BeanDefinitionOverrideException: Invalid bean definition with name 'jacksonTesterFactoryBean' defined in class path resource [org/springframework/boot/jackson2/autoconfigure/Jackson2TesterTestAutoConfiguration.class]: Cannot register bean definition [Root bean: class=null; scope=prototype; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; fallback=false; factoryBeanName=org.springframework.boot.jackson2.autoconfigure.Jackson2TesterTestAutoConfiguration; factoryMethodName=jacksonTesterFactoryBean; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [org/springframework/boot/jackson2/autoconfigure/Jackson2TesterTestAutoConfiguration.class]] for bean 'jacksonTesterFactoryBean' since there is already [Root bean: class=null; scope=prototype; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; fallback=false; factoryBeanName=org.springframework.boot.jackson.autoconfigure.JacksonTesterTestAutoConfiguration; factoryMethodName=jacksonTesterFactoryBean; initMethodNames=null; destroyMethodNames=[(inferred)]; defined in class path resource [org/springframework/boot/jackson/autoconfigure/JacksonTesterTestAutoConfiguration.class]] bound.
```

## コメント

### コメント 1 by goafabric

**作成日**: 2025-11-20

[Archiv.zip](https://github.com/user-attachments/files/23649111/Archiv.zip)

### コメント 2 by wilkinsona

**作成日**: 2025-11-20

Thanks for the report and sample. You don't have to be using AOT for the problem to occur. It will also fail during a normal test run if you using `@JsonTest` and have both Jackson 2 and 3 on the classpath.

