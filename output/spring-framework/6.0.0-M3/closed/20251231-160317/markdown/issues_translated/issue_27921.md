# AutowiredAnnotationBeanPostProcessorのAOT相当品を実装

**Issue番号**: #27921

**状態**: closed | **作成者**: snicoll | **作成日**: 2022-01-11

**ラベル**: in: core, type: enhancement, theme: aot

**URL**: https://github.com/spring-projects/spring-framework/issues/27921

**関連リンク**:
- Commits:
  - [8cd55e6](https://github.com/spring-projects/spring-framework/commit/8cd55e651b605cd174d34b6a98672828b6fc1168)
  - [6fd95f6](https://github.com/spring-projects/spring-framework/commit/6fd95f60ea60b590689e18c8a0ad34c36773608b)
  - [8ada537](https://github.com/spring-projects/spring-framework/commit/8ada53707f11daa17002b31a94033d673dd4c6b1)
  - [31de85b](https://github.com/spring-projects/spring-framework/commit/31de85b77bc3cf732badbb9caec4bd2bd25550b2)
  - [c05167b](https://github.com/spring-projects/spring-framework/commit/c05167bc531f4b2dc695a3c7c376e362edb92d71)
  - [f9a00c9](https://github.com/spring-projects/spring-framework/commit/f9a00c9974ddb03786e66bedea1d54eb592d3e3b)
  - [e74e794](https://github.com/spring-projects/spring-framework/commit/e74e794dbbf439912b483a31dacdffa205b5234a)
  - [b8f675c](https://github.com/spring-projects/spring-framework/commit/b8f675cdb70d196c6408b7d6767bb7174059d3c9)
  - [2c57c9e](https://github.com/spring-projects/spring-framework/commit/2c57c9ec9cf9f2cad3314c8783674cbe5d4ab347)
  - [0cbae1c](https://github.com/spring-projects/spring-framework/commit/0cbae1ca08280dc7804492aded7b95f6f038e989)
  - [3a4f63c](https://github.com/spring-projects/spring-framework/commit/3a4f63cfcb04e753268763a7a5c7f1420018ab9e)
  - [dc6e8a4](https://github.com/spring-projects/spring-framework/commit/dc6e8a422d05d2660a3b3f36140c525e5c9d9018)
  - [2150272](https://github.com/spring-projects/spring-framework/commit/2150272f1789b76eb96d24c70f92cc0da7e4a47e)
  - [6b50c75](https://github.com/spring-projects/spring-framework/commit/6b50c75e03be62f1882c7a02bb1cdfa54c3af139)
  - [39fd3a2](https://github.com/spring-projects/spring-framework/commit/39fd3a2787ac93a39b73e4dd688f18bedeccd9e2)
  - [2141373](https://github.com/spring-projects/spring-framework/commit/2141373c432dfc18bb665ec4f54b1e3c3b121c99)
  - [d540460](https://github.com/spring-projects/spring-framework/commit/d540460a56cf282fdf51fb8bbe8b548beccc8a08)
  - [333b3c7](https://github.com/spring-projects/spring-framework/commit/333b3c76a33e9cbf9553d7a2d660834ecda95f7f)
  - [c9e90d5](https://github.com/spring-projects/spring-framework/commit/c9e90d5f75b05d4b55965679551ae40f2a7901e6)

## 内容

`InjectionMetadata`は、ビルド時に使用できる情報を提供します。たとえば、AOTなしでアプリが使用する`ApplicationContext`に対して`AutowiredAnnotationBeanPostProcessor`が有効になっている場合、`autowired`要素について調べることができるはずです。おそらく、ポストプロセッサに設定されたカスタム設定を再利用することさえ可能です。

インジェクションの動作方法には、一貫性を保つために合理化する必要があるロジックもあります。

## コメント

### コメント 1 by snicoll

**作成日**: 2022-01-31

`BeanPostProcessor`が、実行時に行うことを置き換えるコードコントリビューターを提供するためにオプトインできるインターフェースを設計しようとしています。現在のモデルは、`MergedBeanDefinitionPostProcessor#postProcessMergedBeanDefinition`と同様に、`RootBeanDefinition`に基づいてコントリビューターを返すインターフェースを実装することです。

プロセッサーはデフォルトで実行時に除外されますが、再度実行する必要があることを示すことができればよいでしょう。そのような機能が必要な場合、`BeanFactory`が処理されるフェーズは、「ビルド時」対「実行時」対「最適化された実行時」のような高レベルの概念になるべきです。

### コメント 2 by snicoll

**作成日**: 2022-02-14

これを進めるには、#28047が必要です。
