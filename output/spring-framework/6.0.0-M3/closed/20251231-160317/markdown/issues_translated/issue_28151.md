# 複数のinitまたはdestroyメソッドを考慮してAOT処理を更新

**Issue番号**: #28151

**状態**: closed | **作成者**: snicoll | **作成日**: 2022-03-09

**ラベル**: in: core, type: enhancement, theme: aot

**URL**: https://github.com/spring-projects/spring-framework/issues/28151

**関連リンク**:
- Commits:
  - [76457a5](https://github.com/spring-projects/spring-framework/commit/76457a542d4e9b5cd7f9a7620b3b7ecdede98425)
  - [672555a](https://github.com/spring-projects/spring-framework/commit/672555a568445d27ab3d1efc0d87dd9bde779acc)
  - [4a35b6c](https://github.com/spring-projects/spring-framework/commit/4a35b6c48d19c23a8146afdf2d07251c893c0acb)
  - [4ecda24](https://github.com/spring-projects/spring-framework/commit/4ecda241fbb18644b36bf968be5d1624e623016e)

## 内容

#28013が実装されたので、適切なinitおよびdestroyメソッド名でBean定義が登録されることを確認する必要があります。

## コメント

### コメント 1 by snicoll

**作成日**: 2022-03-10

ブロックされています。カスタムinitおよびdestroyメソッドを検出するBPPに`AotContributingBeanPostProcessor`を追加しました。今、`RootBeanDefinition`を変更するという選択肢が残されています。AOTの観点からは、Beanインスタンスサプライヤーが最初に生成される(したがってコントリビューターが事前に呼び出される)ため、問題ありません。

コンテキストの観点からは、`MergedDefinitionBeanPostProcessor`が基本の`BeanDefinition`クラスのメソッドを呼び出せないことを明示的に述べているため、少し奇妙です。

一般的な観点から見ると、`MergedDefinitionBeanPostProcessor`が#28103の一部として作成されたAPIを使用してそれらを登録していれば、このPPはAOTコントリビューティングである必要さえありません。これは現在の実装に示されており、必要に応じて`RootBeanDefinition`を変更し、常に`null`コントリビューションを返します。
