# Update AOT processing to account for multiple init or destroy methods

**Issue番号**: #28151

**状態**: closed | **作成者**: snicoll | **作成日**: 2022-03-09

**ラベル**: in: core, type: enhancement, theme: aot

**URL**: https://github.com/spring-projects/spring-framework/issues/28151

**関連リンク**:
- Commits:
  - [76457a5](https://github.com/spring-projects/spring-framework/commit/76457a542d4e9b5cd7f9a7620b3b7ecdede98425)
  - [672555a](https://github.com/spring-projects/spring-framework/commit/672555a568445d27ab3d1efc0d87dd9bde779acc)
  - [4a35b6c](https://github.com/spring-projects/spring-framework/commit/4a35b6c48d19c23a8146afdf2d07251c893c0acb)
  - [4ecda24](https://github.com/spring-projects/spring-framework/commit/4ecda241fbb18644b36bf968be5d1624e623016e)

## 内容

Now that #28013 is implemented we need to make sure that the bean definition is registered with the appropriate init and destroy method names.

## コメント

### コメント 1 by snicoll

**作成日**: 2022-03-10

I am blocked. I've added `AotContributingBeanPostProcessor` to the BPP that detects custom init and destroy methods. I am now left with the choice of mutating the `RootBeanDefinition`. From an AOT perspective, that's alright as the bean instance supplier is generated first (and therefore the contributors are invoked upfront).

From a context perspective, it is a little bit odd as `MergedDefinitionBeanPostProcessor` explicitly states that the methods of the base `BeanDefinition` class couldn't be invoked. 

Looking at things from a generic fashion, if `MergedDefinitionBeanPostProcessor` did register those using the API that was created as part of #28103, then this PP shouldn't even have to be an aot-contributing. It kind of shows in the current implementation where it mutates the `RootBeanDefinition` if necessary and always return a `null` contribution.

