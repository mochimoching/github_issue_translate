# XStreamMarshallerのデフォルトドライバーをXppDriverからDomDriverに変更

**Issue番号**: [#27464](https://github.com/spring-projects/spring-framework/issues/27464)

**状態**: closed | **作成者**: sbrannen | **作成日**: 2021-09-24

**ラベル**: in: data, type: enhancement

**URL**: https://github.com/spring-projects/spring-framework/issues/27464

**関連リンク**:
- Commits:
  - [30efa4d](https://github.com/spring-projects/spring-framework/commit/30efa4d478d6673ecfc735bef1ce65decadf4e77)

## 内容

## 概要

コミットa247b83cd9c9aefd3c329d493c5ce7cd11d0cdfaで説明されているように、XStreamの`XppDriver`はXPP3ライブラリに依存しており、そのJARの一部として`javax.xml.namespace.QName`を公開しています。`QName`型は、モジュラーJRE(Java 9以降)の`java.xml`システムモジュールでも公開されています。

これにより、`unnamed`モジュールと`java.xml`システムモジュールの間で_スプリットパッケージ_が発生し、Java言語仕様ではこれを違法と定義しています([§6.5.5.2](https://docs.oracle.com/javase/specs/jls/se11/html/jls-6.html#jls-6.5.5.2)および[§7.4.3](https://docs.oracle.com/javase/specs/jls/se11/html/jls-7.html#jls-7.4.3)を参照)。

ほとんどのJavaコンパイラは現在このルールを強制していませんが、Eclipseコンパイラは強制しています。これにより、Eclipse IDEで`spring-oxm`をそのまま使用することが不可能になります。さらに、バグ[JDK-8215739](https://bugs.openjdk.java.net/browse/JDK-8215739)が将来のOpenJDKバージョンで修正された場合、このルールは`spring-oxm`のすべてのユーザーに影響します。

これを踏まえて、チームは`XStreamMarshaller`のデフォルトドライバーを`XppDriver`から`DomDriver`に切り替えることを決定しました。`defaultDriver`は設定可能なため、ユーザーは必要に応じて`XppDriver`に戻すことができます。

## 成果物

- [x] `XStreamMarshaller`のデフォルトドライバーを`XppDriver`から`DomDriver`に変更
- [x] a247b83cd9c9aefd3c329d493c5ce7cd11d0cdfaの関連変更を元に戻す
