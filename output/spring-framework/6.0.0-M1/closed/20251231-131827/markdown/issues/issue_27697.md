# Refactor HttpMethod from enum to class

**Issue番号**: #27697

**状態**: closed | **作成者**: poutsma | **作成日**: 2021-11-18

**ラベル**: in: web, type: enhancement

**URL**: https://github.com/spring-projects/spring-framework/issues/27697

**関連リンク**:
- Commits:
  - [d075b43](https://github.com/spring-projects/spring-framework/commit/d075b43412ed86053249a6b82c879bf9f9820084)
  - [df0118d](https://github.com/spring-projects/spring-framework/commit/df0118d097c1692b08b6670542af441aebeb4250)
  - [47041ef](https://github.com/spring-projects/spring-framework/commit/47041ef407fff323c6fabd2511e2e0a3aa719273)
  - [b15b13a](https://github.com/spring-projects/spring-framework/commit/b15b13a68033e00aef52df28d70503e78a7723fb)
  - [5955253](https://github.com/spring-projects/spring-framework/commit/59552533402941d3ec81237e67be387c970cad4f)
  - [c710ada](https://github.com/spring-projects/spring-framework/commit/c710ada6ecfb49071ce5e27b432e885d748443b7)
  - [bc76dea](https://github.com/spring-projects/spring-framework/commit/bc76dea25a05b9ed821416dca401a943cc71035b)
  - [6623b31](https://github.com/spring-projects/spring-framework/commit/6623b31c2197b3a9c1c6fa43e52d09c427de99df)
  - [64eebf8](https://github.com/spring-projects/spring-framework/commit/64eebf86dd6d51ea4672f7f7c82d645538bd2696)
  - [6e335e3](https://github.com/spring-projects/spring-framework/commit/6e335e3a9ff7727dc42e790904ae98a6d0edb7b5)
  - [d370fca](https://github.com/spring-projects/spring-framework/commit/d370fcaa1778bd89f0c5c455a8ba33ceb4e5cedd)
  - [445f25c](https://github.com/spring-projects/spring-framework/commit/445f25c466c64f206f5f141c56a1b7cf63f3a30b)
  - [7a4207c](https://github.com/spring-projects/spring-framework/commit/7a4207cd7bfbe57217b1718111f8c56cb076a34d)
  - [f10998b](https://github.com/spring-projects/spring-framework/commit/f10998b7d24b7f086eab248382faa93c6943a84a)
  - [11d6822](https://github.com/spring-projects/spring-framework/commit/11d682292eeba75c100d1562aab875833929e1d7)
  - [a55c5eb](https://github.com/spring-projects/spring-framework/commit/a55c5eb324f8408ba29a2fecc4bd4c27890357c7)
  - [6f5cdf6](https://github.com/spring-projects/spring-framework/commit/6f5cdf6cab11bf9106e6aa0fbd30d2bf28fa6c33)
  - [88e6544](https://github.com/spring-projects/spring-framework/commit/88e6544d9d3498359b49a2548a1b6ef52b32a5ad)
  - [97625e3](https://github.com/spring-projects/spring-framework/commit/97625e365803526658d47a26cc6f010259154be1)

## 内容

According to [the HTTP specification](https://datatracker.ietf.org/doc/html/rfc2616#section-5.1.1), the HTTP method is not limited to the well known set (GET, HEAD, PUT, POST, etc.), but can also be an "extension-method". Well known extensions include [WebDAV](http://www.webdav.org/specs/rfc4918.html#http.methods.for.distributed.authoring), which added methods like LOCK, COPY, and MOVE.

In Spring Framework, HTTP methods are enumerated in `HttpMethod`. Because this type is an Java `enum`, Spring framework needs several workarounds, to allow for HTTP methods not in the enum, such as having both `HttpRequest::getMethod` as well as `HttpRequest::getMethodValue`.

If we change `HttpMethod` from `enum` to `class`, we no longer need these workarounds. If we make sure that the new `class` has the same methods that `java.lang.Enum` exposes, and given that upgrading to 6.0 requires a recompilation anyway, I believe that now is the time to make this long overdue change.

Note that this issue does *not* include support for non-standard HTTP (i.e. WebDAV) methods in Spring MVC and/or WebFlux. 

## コメント

### コメント 1 by quaff

**作成日**: 2021-11-25

> such as having both HttpMethod::getMethod as well as HttpRequest::getMethodValue.

`HttpMethod::getMethod` should be `HttpRequest::getMethod`

### コメント 2 by poutsma

**作成日**: 2021-11-25

@quaff Fixed, thanks!

### コメント 3 by quaff

**作成日**: 2021-12-01

Can we use `extension-method` for `RequestMapping`?

### コメント 4 by poutsma

**作成日**: 2021-12-01

> Can we use `extension-method` for `RequestMapping`?

I am not sure what you mean by that, can you elaborate? Because annotations can refer to enum elements but not classes, `RequestMapping` uses the `RequestMethod` enumeration.

### コメント 5 by quaff

**作成日**: 2021-12-02

> > Can we use `extension-method` for `RequestMapping`?
> 
> I am not sure what you mean by that, can you elaborate? Because annotations can refer to enum elements but not classes, `RequestMapping` uses the `RequestMethod` enumeration.

I mean should `RequestMapping` introduce `String[] methodValue()` to supports `extension-method`?

### コメント 6 by poutsma

**作成日**: 2021-12-02

> I mean should `RequestMapping` introduce `String[] methodValue()` to supports `extension-method`?

`RequestMapping` uses `RequestMethod`, and that's fine the way it is. As I wrote in the description, we have no intention of supporting non-standard HTTP methods. `HttpMethod` is a lower-level component that is used for our HTTP abstraction, and that did need support for non-standard methods.

### コメント 7 by tamizh-m

**作成日**: 2024-05-28

Hi @poutsma , After upgrading to Spring 6, I am unable to serialize and deserialize 'HttpMethod' using 'ObjectMapper' because the class does not have a public constructor or a getter for 'name' attribute. This issue did not arise previously when HttpMethod was an enum. Would be helpful if you can provide a workaround for this?

### コメント 8 by poutsma

**作成日**: 2024-05-28

@tamizh-m Please file a new issue. This issue is closed.

