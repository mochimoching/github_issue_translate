# Jakarta EE 9のサポート(jakarta.*名前空間のアノテーションとインターフェース)

**Issue番号**: [#25354](https://github.com/spring-projects/spring-framework/issues/25354)

**状態**: closed | **作成者**: zenbones | **作成日**: 2020-07-02

**ラベル**: type: dependency-upgrade

**URL**: https://github.com/spring-projects/spring-framework/issues/25354

**関連リンク**:
- Commits:
  - [b88ed7f](https://github.com/spring-projects/spring-framework/commit/b88ed7f4bb719a71a4a6fb9442e8dc731159c331)
  - [4a89ac7](https://github.com/spring-projects/spring-framework/commit/4a89ac7a213f7bd97b4b53291fd2f56ac91622e5)
  - [d84ca2b](https://github.com/spring-projects/spring-framework/commit/d84ca2ba90d27a7c63d7b35a6259b5b9cf341118)
  - [555807e](https://github.com/spring-projects/spring-framework/commit/555807ea9c632522240b871b025dd9448e837c58)
  - [f4ede92](https://github.com/spring-projects/spring-framework/commit/f4ede9200955646e32ffb30118c833c0a762d918)
  - [19ce194](https://github.com/spring-projects/spring-framework/commit/19ce194fc46709372e022de614d22e6081718217)

## 内容

JEE9でjakarta.*名前空間の依存関係への切り替えのタイミングはいつですか? その変更が行われた使用またはビルド可能なバージョンはありますか?

## コメント

### コメント 1 by jhoeller

**作成日**: 2020-07-02

そのような切り替えの immediate な計画はなく、早期アクセスブランチの計画もありません。今後のSpring Framework 5.3世代は、Java 8以降と互換性があり、現在の本番環境で即座に使用できるよう、javax名前空間のEE 8 APIに基づいています。それ以降、Spring Framework 6は後の時点でjakarta名前空間を採用する可能性があります。

jakarta名前空間のAPIはまだ最終版ではなく、すべての主要プロバイダーが本番リリースでそれらをサポートするまでには長い時間がかかると予想しています。Tomcat、Jetty、Undertowだけでなく、EclipseLink、Hibernate ORM、Hibernate Validatorも主要リリースを提供する必要があり、さらにいくつかの特殊用途プロバイダーやライブラリも必要です。jakarta名前空間のAPIに基づくSpringのバージョンを検討する前に。EE 9の名前空間変更自体には関連する価値の追加がないため、javax名前空間を通じた既存のアプリケーションサーバーや永続化プロバイダーとの後方互換性の方が重要です。

とはいえ、javax名前空間の継続使用が問題となる本番環境向けのスタックシナリオがある場合は、詳しく説明してください。今後のTomcat 10はまだサポートできないことを認識しており、当面はTomcat 9.0.x(Tomcat 10と機能的に同等で、javax名前空間に基づいている)を使用することをお勧めします。

### コメント 2 by krzyk

**作成日**: 2021-04-02

Hibernate validator 7.xがjakarta.*名前空間に切り替わり、Hibernate validationとSpring validationのどちらかを選択しなければならない問題が発生しました。

javax.*とjakarta.*名前空間の両方をサポートすることは本当に不可能ですか? それとも、コードで実装できる回避策はありますか?

### コメント 3 by andrei-ivanov

**作成日**: 2021-04-02

HV 6.2を使用できます: https://in.relation.to/2021/01/06/hibernate-validator-700-62-final-released/

### コメント 4 by krzyk

**作成日**: 2021-04-02

はい、ですがすべてのパッケージjakarta.validationをjavax.にリネームする必要があります。

リリースが12月だったことを考えると、validationにjakartaとjavaxの両方のパッケージを追加するのが良いと思います。

Springのソースからそのbeanをコピーし、そこでjavaxをjakartaにリネームすれば魔法のように動作すると期待していました :)

### コメント 5 by jhoeller

**作成日**: 2021-04-02

残念ながら、これは仕様ごとには機能しません。少なくともフレームワークプロバイダーとしての私たちには。Jakarta EE 9と`jakarta`名前空間へのすべてのEE APIの移行を同時に行う必要があります。そうしないと、API相互運用性の観点からも商用サポートの観点からも混乱するだけです。もちろん、個別のクラスを自分でコピーアンドペーストすることはできますが、これは推奨されず、当面は公式にサポートしません。

Jakarta EE 9でのEclipse Foundation強制の名前空間切り替えが、エコシステムが広く採用するまでに何年もかかる大きな破壊的変更であることは一般的に理解されています。だからこそ、多くの製品プロバイダーが2つのバージョンを並行してリリースすることを選択しました。例えば、Tomcat 9 vs 10、Jetty 10 vs 11、そしてHibernate Validator 6.2 vs 7です。それぞれのリリースのペアは、機能的にはほぼ同等で、それらのリリースが動作するパッケージ名前空間が異なるだけです。Spring Framework 6とSpring Boot 3が来年Jakarta EE 9+への一般的なアップグレードを行うまでの間、これらの最新のjavaxベースのリリースを利用することを強く推奨します。

### コメント 6 by Sudha-84

**作成日**: 2021-07-07

これについてのETAはありますか? ご回答いただければ幸いです。

### コメント 7 by jhoeller

**作成日**: 2021-07-07

まだETAはありません。ただ、Spring Framework 6とSpring Boot 3が2022年に一般提供される予定という大まかなガイダンスのみです。2021年第4四半期には最初の6.0マイルストーンをリリースしますが、最終的な本番リリースは少なくとも1年先です。当面は、**アクティブに開発されているSpring Framework 5.3.x系列で、すべての一般的なオープンソースプロジェクトの最新のjavaxベースのバージョンをサポートすること**を目指しており、Boot 2.4と2.5(および今後のBoot 2.6と2.7のリリース)もそれに基づいて構築されます。

これは、オープンソースエコシステムの残りの部分、そしてJava業界全体とも一致していることに注意してください。上記で概説したように、一部のオープンソースプロジェクトはすでにJakarta EE 9ベースの早期リリースを持っていますが、機能的に同等でまだ長期間メンテナンスされる並行したJava/Jakarta EE 8ベースのメインラインリリースを維持しています。これは、最近リリースされたHibernate ORM 5.5の場合も同様です。**当面はEE 8にとどまることを強く推奨します。**

### コメント 8 by Sudha-84

**作成日**: 2021-07-13

ご回答ありがとうございます。

### コメント 9 by mckramer

**作成日**: 2021-07-20

@jhoeller hibernate-validatorの観点から、そのアーティファクトは実際にすでに6.1.xでjakarta依存関係にアップグレードされており、Springもすでにそれに移行しています。おそらくそれは知られていなかったかもしれませんが、Springは現在jakarta.*への推移的な依存関係を持っています。

[spring-framework javax validation-api@2.0.1.Final](https://github.com/spring-projects/spring-framework/blob/main/build.gradle#L270)

[spring-framework hibernate-validator@6.2.0.Final](https://github.com/spring-projects/spring-framework/blob/main/build.gradle#L126)

[hibernate-validator jakarta.validation-api@2.0.2](https://github.com/hibernate/hibernate-validator/blob/6.2.0.Final/pom.xml#L347)

これにより、現在のSpringに競合が生じます。これは意図的ですか?

### コメント 10 by spencergibb

**作成日**: 2021-07-20

> Hibernate Validator 6.xはjavax.パッケージを維持し、Hibernate Validator 7.xはjakarta.パッケージに移行しました。

上記のコメントでリンクされている記事より: https://github.com/spring-projects/spring-framework/issues/25354#issuecomment-812572313

### コメント 11 by MCMicS

**作成日**: 2021-07-21

@mckramer Hibernate 6.xはまだjavax.を使用しています。`jakarta.validation-api`の2.0.2バージョンにはjavaxパッケージが含まれています。3.xバージョンでリネームされます。

### コメント 12 by jhoeller

**作成日**: 2021-07-21

@mckramer 残念ながら、混乱を招きます。Jakarta提供のアーティファクトは、バージョンに応じて`javax.`または`jakarta.` APIを含む可能性があります。

Jakarta EE 8は事実上Java EE 8の再パッケージ化であり、`javax`名前空間だけでなく、個々のAPIの既存のメジャーバージョン番号も保持し(例: Validation APIを2.0.1から2.0.2にバンプ)、ソースレベルとバイナリレベルで既存のAPI使用との互換性を維持し、ビルドアーティファクトの異なるMaven座標を提案するだけです。

Jakarta EE 9以降は、実際にAPIをJavaインターフェースレベルで`jakarta`名前空間に再パッケージ化し、すべての下流プロジェクトにコードを適応させることを強制します。これが、Spring Framework 6とSpring Boot 3で採用する新しいベースラインであり、そのベースライン上で確立されたバージョンを提供する一般的なオープンソースプロジェクト(例: Tomcat、Jetty、Hibernate)をサポートしますが、EE 8に固執したままの可能性がある他のいくつかのサーバーやライブラリのサポートは削除する可能性があります。

### コメント 13 by mckramer

**作成日**: 2021-07-21

そうですね、懸念は「api」の変更ではなく、Hibernate >= 6.1.xがjakartaアーティファクトを使用していることです。内部では同じパッケージ/クラスですが、別のアーティファクトです。その結果、javax validation-apiとjakarta validation-apiの両方のjarが最終アプリケーションのクラスパスに存在する可能性があり、クラスの重複が発生します。

アプリケーションは、多くの推移的な依存関係にわたって除外を管理し、両方のjarが解決されないようにする必要があります。

答えは単純に、SpringがJakarta EE 8パッケージ(Java EE 8ではなく)を優先し、アプリはそのように管理すべきということかもしれません。Springは一般的にjavax validation-api依存関係をオプションとして定義していますが、両方のアーティファクトの管理バージョンを含んでいます。

### コメント 14 by SushmitaGoswami

**作成日**: 2022-03-04

これについて何か更新はありますか? Springがjakartaに移行するのはいつになるか分かりますか? おおよその四半期は?

### コメント 15 by martin-g

**作成日**: 2022-03-04

Spring 6.xはJakarta APIに移行しました。

M1は数ヶ月前にリリースされました。

### コメント 16 by sbrannen

**作成日**: 2022-03-04

@SushmitaGoswami さん、関連するブログ投稿をご覧ください:

https://spring.io/blog/2021/09/02/a-java-17-and-jakarta-ee-9-baseline-for-spring-framework-6
