# Add support for HEAD methods in Spring's Resource handling

**Issue番号**: #28291

**状態**: closed | **作成者**: hannosgit | **作成日**: 2022-04-06

**ラベル**: in: web, type: enhancement

**URL**: https://github.com/spring-projects/spring-framework/issues/28291

**関連リンク**:
- Commits:
  - [5fc8a98](https://github.com/spring-projects/spring-framework/commit/5fc8a9839cb22b960d05d8e9b94d69ceb4297062)
  - [9adfa5e](https://github.com/spring-projects/spring-framework/commit/9adfa5e8b0f0cd65a0b14740e0a0f9832d80edcb)

## 内容

<!--
!!! For Security Vulnerabilities, please go to https://spring.io/security-policy !!!
-->
**Affects:**  Spring Web 5.3.18
**Tested with:** Tomcat and Jetty
**Tested with:** Linux and Windows

---

I want to download large files (>10GB) from a Spring Web Server, before I start the download I want to know the size of the remote file, so, therefore, I make a HEAD request on the remote file.

Static files are served via ResourceHandlers, eg.

``` Java
@Configuration
public class MvcConfig implements WebMvcConfigurer {

    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        registry
            .addResourceHandler("/**")
            .addResourceLocations("file:download/");
    }

}
```

and then when I make a HEAD request on a large file (> 10 GB), on the first try I get the response within milliseconds but when I try again the response takes seconds ( >10s).



## コメント

### コメント 1 by poutsma

**作成日**: 2022-04-07

The underlying reason for this is that resource handling in Spring MVC (and WebFlux) does not have explicit support for `HEAD` methods yet. Instead, we treat the request as a `GET`, write the entire file to the body, and rely on the standard `HttpServlet::doHead` functionality to ignore everything written.

I will introduce `HEAD` support in `ResourceHttpRequestHandler` and `ResourceWebHandler`.

