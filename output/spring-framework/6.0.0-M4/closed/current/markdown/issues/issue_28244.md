# Initialize NativeDetector at build time

**Issue番号**: #28244

**状態**: closed | **作成者**: sdeleuze | **作成日**: 2022-03-29

**ラベル**: type: enhancement, theme: aot

**URL**: https://github.com/spring-projects/spring-framework/issues/28244

**関連リンク**:
- Commits:
  - [cdb2463](https://github.com/spring-projects/spring-framework/commit/cdb2463dc88b721dd28845433f03ec6ed2cf5386)
  - [04b1b5d](https://github.com/spring-projects/spring-framework/commit/04b1b5d96e320a90961091cd9552dde8f78d9589)
  - [e681e71](https://github.com/spring-projects/spring-framework/commit/e681e713d4aa75be988d77f0108f80ecf15e21e9)
  - [c611561](https://github.com/spring-projects/spring-framework/commit/c6115619ebf15b89d048997944d7d0f516f49e2c)
  - [ff02c78](https://github.com/spring-projects/spring-framework/commit/ff02c787372431af9ca5a936d41f9f383c33af45)

## 内容

In order to allow code removal with constructs like `if (NativeDetector.inNativeImage()) { ... } else { ... }`, `NativeDetector` needs to be initialized at build time. `-H:+InlineBeforeAnalysis` is enabled by default as of GraalVM 21.3 so no further configuration is needed.

Since build time initialization is not necessarily something we want to expose in public APIs, embedding a `spring-core/src/main/resources/META-INF/native-image/org.springframework/spring-core/native-image.properties` file for that purpose is the solution chosen for now.

