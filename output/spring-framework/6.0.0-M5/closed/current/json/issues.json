[
  {
    "number": 28298,
    "title": "findAnnotationOnBean finds annotations from a static @Bean method's enclosing class",
    "state": "closed",
    "created_at": "2022-04-07T12:18:26Z",
    "updated_at": "2022-06-14T12:04:25Z",
    "author": "wilkinsona",
    "url": "https://github.com/spring-projects/spring-framework/issues/28298",
    "body": "**Affects:** 5.3.x\r\n\r\nWhen a bean is defined using a static method, `findAnnotationOnBean` finds an annotation from the `@Configuration` class to which the static `@Bean` method belongs. The annotation is not found if the `@Bean` method is not static.\r\n\r\nThe following tests illustrate this behavior:\r\n\r\n```java\r\npackage com.example;\r\n\r\nimport java.lang.annotation.ElementType;\r\nimport java.lang.annotation.Retention;\r\nimport java.lang.annotation.RetentionPolicy;\r\nimport java.lang.annotation.Target;\r\n\r\nimport org.junit.jupiter.api.Test;\r\n\r\nimport org.springframework.context.annotation.AnnotationConfigApplicationContext;\r\nimport org.springframework.context.annotation.Bean;\r\nimport org.springframework.context.annotation.Configuration;\r\n\r\nimport static org.assertj.core.api.Assertions.assertThat;\r\n\r\nclass FindAnnotationOnBeanTests {\r\n\r\n    @Test\r\n    void beanDefinedInInstanceMethodDoesNotHaveAnnotationsFromItsConfigurationClass() {\r\n        beanDoesNotHaveAnnotationsFromItsConfigurationClass(InstanceBeanMethodConfiguration.class);\r\n    }\r\n\r\n    @Test\r\n    void beanDefinedInStaticMethodDoesNotHaveAnnotationsFromItsConfigurationClass() {\r\n        beanDoesNotHaveAnnotationsFromItsConfigurationClass(StaticBeanMethodConfiguration.class);\r\n    }\r\n\r\n    void beanDoesNotHaveAnnotationsFromItsConfigurationClass(Class<?> config) {\r\n        try (AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(config)) {\r\n            ExampleAnnotation annotation = context.getBeanFactory().findAnnotationOnBean(\"exampleBean\",\r\n                    ExampleAnnotation.class);\r\n            assertThat(annotation).isNull();\r\n        }\r\n    }\r\n\r\n    @Configuration\r\n    @ExampleAnnotation\r\n    static class StaticBeanMethodConfiguration {\r\n\r\n        @Bean\r\n        static String exampleBean() {\r\n            return \"example\";\r\n        }\r\n\r\n    }\r\n\r\n    @Configuration\r\n    @ExampleAnnotation\r\n    static class InstanceBeanMethodConfiguration {\r\n\r\n        @Bean\r\n        String exampleBean() {\r\n            return \"example\";\r\n        }\r\n\r\n    }\r\n\r\n    @Target(ElementType.TYPE)\r\n    @Retention(RetentionPolicy.RUNTIME)\r\n    static @interface ExampleAnnotation {\r\n\r\n    }\r\n\r\n}\r\n```\r\n\r\n`beanDefinedInInstanceMethodDoesNotHaveAnnotationsFromItsConfigurationClass` passes but `beanDefinedInStaticMethodDoesNotHaveAnnotationsFromItsConfigurationClass` fails.",
    "labels": [
      "type: bug",
      "in: core"
    ],
    "comments": [
      {
        "author": "284831721",
        "created_at": "2022-04-08T06:03:58Z",
        "body": "I can't understand, so, which test result is expected? first or second.\r\n\r\nFrom the `findAnnotationOnBean` method's comment describe as follow, I think test 1 is the expected behavior, am I right?\r\n\r\n```\r\n/**\r\n\t * Find an {@link Annotation} of {@code annotationType} on the specified bean,\r\n\t * traversing its interfaces and super classes if no annotation can be found on\r\n\t * the given class itself, as well as checking the bean's factory method (if any).\r\n\t * @param beanName the name of the bean to look for annotations on\r\n\t * @param annotationType the type of annotation to look for\r\n\t * (at class, interface or factory method level of the specified bean)\r\n\t * @return the annotation of the given type if found, or {@code null} otherwise\r\n\t * @throws NoSuchBeanDefinitionException if there is no bean with the given name\r\n\t * @since 3.0\r\n\t * @see #getBeanNamesForAnnotation\r\n\t * @see #getBeansWithAnnotation\r\n\t */\r\n\r\n```"
      },
      {
        "author": "wilkinsona",
        "created_at": "2022-04-08T06:21:59Z",
        "body": "Both should pass. The tests are illustrating the described difference between static and instance bean methods."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "3da2b5c1b914a20f6728e614f51d8eb25d956c3d",
        "a36441064639eed2ed79986fce20f82ea8feef3a",
        "a14650e0dc37ad36e0d1c1d8ebbb0440bcfd312b",
        "a1fe05f40b02cc79dc3777ff6f90a04ac4de6eac"
      ]
    }
  },
  {
    "number": 28398,
    "title": "Avoid collectList when sending a Flux of objects as JSON using WebClient",
    "state": "closed",
    "created_at": "2022-04-29T20:51:36Z",
    "updated_at": "2023-07-11T15:31:02Z",
    "author": "micopiira",
    "url": "https://github.com/spring-projects/spring-framework/issues/28398",
    "body": "Would it be possible to send a flux of objects in the request body using WebClient with \"Content-Type: application/json\" but avoid having to collect the whole flux as a list in memory?\r\n\r\nLet's say I have a Flux containing millions of elements and my target server only accepts non-streaming content-types, the Jackson2JsonEncoder would then call \"collectList()\" on the flux, possibly running out of memory.\r\n\r\nCouldn't the Jackson2JsonEncoder somehow write the objects as they come available?",
    "labels": [
      "in: web",
      "type: enhancement"
    ],
    "comments": [
      {
        "author": "poutsma",
        "created_at": "2022-05-09T09:59:06Z",
        "body": "It is possible, but not with `application/json` as the Content-Type; it needs to be `application/x-ndjson` instead.\r\n\r\nThere is significant overhead for writing JSON content individually instead of collectively. That is why the `Jackson2JsonEncoder` collects to a list by default, and serializes that. If you specify a streaming mime-type, set to `application/x-ndjson` by defaultâ€“but changeable via the `streamingMediaTypes` property, then the `Jackson2JsonEncoder` will not collect the list but stream them as they arrive, with a newline in between the elements.\r\n\r\nDoes that answer your question?"
      },
      {
        "author": "micopiira",
        "created_at": "2022-05-09T18:16:14Z",
        "body": "Hey, I'm trying to POST to a server that only accepts `application/json` . With something more low level than WebClient, like reactor-netty I could do something like this:\r\n\r\n        Flux<String> flux = Flux.range(0, 1000000).map(Object::toString);\r\n        final Mono<HttpClientResponse> response = httpClient.headers(headers -> {\r\n                    headers.set(HttpHeaders.CONTENT_TYPE, MediaType.APPLICATION_JSON.toString());\r\n                    headers.set(HttpHeaders.ACCEPT, MediaType.APPLICATION_JSON.toString());\r\n                }).post()\r\n                .uri(\"/url\")\r\n                .send(ByteBufFlux.fromString(flux\r\n                        .map(o -> {\r\n                            try {\r\n                                return objectMapper.writeValueAsString(o);\r\n                            } catch (JsonProcessingException e) {\r\n                                throw new RuntimeException(e);\r\n                            }\r\n                        }).zipWith(Flux.just(\",\").repeat(), (a, b) -> a + b).startWith(\"[\").concatWithValues(\"]\")))\r\n                .response();\r\n\r\nWhich would then, atleast for what I know stream the objects to the target as they come available without having to wait for all of them.\r\n\r\nWould this kind of behaviour be possible to implement in WebClient or should I stick with more low level clients like reactor-netty?"
      },
      {
        "author": "poutsma",
        "created_at": "2022-05-10T08:13:26Z",
        "body": ">I'm trying to POST to a server that only accepts application/json \r\n\r\nYou can change the `streamingMediaTypes ` property of `Jackson2JsonEncoder` from the default to `application/json`, and trigger the streaming behavior that way. The reference docs explains [how to change codec defaults](https://docs.spring.io/spring-framework/docs/current/reference/html/web-reactive.html#webflux-config-message-codecs)."
      },
      {
        "author": "micopiira",
        "created_at": "2022-05-11T18:07:16Z",
        "body": "I see,   however it does not produce valid JSON \"out of the box\". Heres what I tried:\r\n\r\n```java\r\nprivate final WebClient webClient = WebClient.builder()\r\n   .baseUrl(\"http://localhost:8080/\")\r\n   .codecs(clientCodecConfigurer -> {\r\n     final Jackson2JsonEncoder jackson2JsonEncoder = new Jackson2JsonEncoder();\r\n     jackson2JsonEncoder.setStreamingMediaTypes(List.of(MediaType.APPLICATION_JSON));\r\n     clientCodecConfigurer.defaultCodecs().jackson2JsonEncoder(jackson2JsonEncoder);\r\n    })\r\n   .build();\r\n\r\n    Flux<MyEntity> flux = ...;\r\n    webClient.post()\r\n               .uri(\"/\")\r\n               .contentType(MediaType.APPLICATION_JSON)\r\n               .accept(MediaType.APPLICATION_JSON)\r\n               .body(flux, MyEntity.class)\r\n               .retrieve()\r\n               .bodyToMono(MyResponse.class)\r\n```\r\n\r\nThis will not wrap the JSON in an array nor add commas between the items. Should I manually map my `Flux<MyEntity>` into a `Flux<String>` with the wrapping `[` & `]` and commas in between the items?"
      },
      {
        "author": "rstoyanchev",
        "created_at": "2022-05-17T11:00:59Z",
        "body": "Looking at the Javadoc of `setStreamingMediaTypes` it's mainly about flushing per item (for event streams that emit periodically) vs a single flush at the end (for continuous streams).\r\n\r\nMaybe, if we are in the [streaming section](https://github.com/spring-projects/spring-framework/blob/874077d16ec126ca19d4b9fbb4157cfdc4eac382/spring-web/src/main/java/org/springframework/http/codec/json/AbstractJackson2Encoder.java#L155-L183) and the media type is \"application/json\" (i.e. explicitly set as a streaming media type), we could simply add the opening and closing square brackets to ensure valid JSON is produced. \r\n\r\nWe could also switch to flushing at some regularity > 1 (or just leave it to the underlying server buffer) since we know it's a media type that implies continues writing and shouldn't require explicit flushes. In which case I'm even wondering about removing the non-streaming section entirely, and doing this by default, so that we always write `Flux` items as they come with flushing as the only difference between streaming and non-streaming media types.\r\n"
      },
      {
        "author": "hu553in",
        "created_at": "2023-07-11T14:22:35Z",
        "body": "@rstoyanchev is there a way to override this behavior to old-way now?\r\nI need to temporarily configure Spring WebFlux Kotlin `Flow` endpoints to have `Content-Type: application/json` and to be collected to list before writing...\r\nBecause my frontend app is not able to process stream at the moment"
      },
      {
        "author": "bclozel",
        "created_at": "2023-07-11T14:55:54Z",
        "body": "@hu553in this issue is about the other way around: avoiding to buffer all elements before sending them as a single JSON document from the client. If you're using the server side of WebFlux and an `application/json` content type, data should not be streamed to the client. Maybe create a new StackOverflow question explaining the problem and showing how you're using this?"
      },
      {
        "author": "hu553in",
        "created_at": "2023-07-11T15:21:21Z",
        "body": "@bclozel [done](https://stackoverflow.com/questions/76663504/how-to-return-kotlin-flow-as-non-streaming-json-data-using-content-type-applica), thank you... :)\r\nwill be glad if you check it, maybe you have simple answer.. I don't think that this is very complex issue"
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "ce568468aed09147e335b5d5a717e1b2dac581a8"
      ]
    }
  },
  {
    "number": 28438,
    "title": "Update documentation for RFC 7807 support",
    "state": "closed",
    "created_at": "2022-05-10T11:36:41Z",
    "updated_at": "2022-07-13T12:12:28Z",
    "author": "rstoyanchev",
    "url": "https://github.com/spring-projects/spring-framework/issues/28438",
    "body": "Following the changes for #27052 and sub-tasks, we need an update in the reference documentation. In the mean time, the best alternative is the commit history for #27052 and sub-tasks, the Javadoc  on the added types, and the [sample project](https://github.com/rstoyanchev/sandbox-rfc7807).",
    "labels": [
      "type: documentation",
      "in: web"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "eea793be98ae70f2f6be970738678fe927c2cf4a",
        "ff9a4ab35c1dad7e1f1ba640280461fc84cf2300"
      ]
    }
  },
  {
    "number": 28439,
    "title": "Add WebFlux equivalent of ResponseEntityExceptionHandler",
    "state": "closed",
    "created_at": "2022-05-10T11:39:32Z",
    "updated_at": "2022-07-13T10:00:21Z",
    "author": "rstoyanchev",
    "url": "https://github.com/spring-projects/spring-framework/issues/28439",
    "body": "This would be helpful to facilitate customization of error messages for all framework exceptions especially for RFC 7807 problem details, under #27052.",
    "labels": [
      "in: web",
      "type: enhancement"
    ],
    "comments": [
      {
        "author": "rstoyanchev",
        "created_at": "2022-07-13T10:00:20Z",
        "body": "Fixed in 263811ecfa912a55bce8d0371ed20202abcf5dd5 but referenced wrong issue."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "b64835d2c8d6e195aa6d553fda6230b392b6f4f0"
      ]
    }
  },
  {
    "number": 28455,
    "title": "Resolve package cycle around MissingServletRequestPartException",
    "state": "closed",
    "created_at": "2022-05-12T11:47:43Z",
    "updated_at": "2022-06-01T17:19:10Z",
    "author": "jhoeller",
    "url": "https://github.com/spring-projects/spring-framework/issues/28455",
    "body": "Since #27910 / #27948 `web.multipart.MissingServletRequestPartException` extends `web.bind.ServletRequestBindingException` which unfortunately creates a package cycle since the `web.bind` package depends on `web.multipart` within its binder implementations.\r\n\r\nThe root of the problem there is that `MissingServletRequestPartException` serves two rather different purposes: It is being thrown by `RequestPartServletServerHttpRequest` as a low-level API exception (which is why it lives in the `web.multipart` package), but then also used by `RequestParamMethodArgumentResolver` for handler method argument binding (for which it should actually live in `web.bind`). The proper solution would be to use a different exception type for the bind purpose, and to only let that one extend `ServletRequestBindingException` as of 6.0. Let's revisit this for M5.",
    "labels": [
      "in: web",
      "type: regression"
    ],
    "comments": [
      {
        "author": "rstoyanchev",
        "created_at": "2022-05-12T13:30:40Z",
        "body": "It looks like originally `MissingServletRequestPartException` came as a result of differentiating 4xx vs 5xx exception related to multipart handling, see #13284 and related fix 56c8c69c4ce04e9d35d19e26d279ccd3b2e5a385, and prior to that `RequestParamMethodArgumentResolver` used to raise the base class `ServletRequestBindingException`. \r\n\r\nI think it would be still useful to have a single exception for a missing part, no matter where it was detected. `RequestPartServletServerHttpRequest` is under `web.multipart` because it relates to multipart processing and that's the lowest place where it is needed. \r\n\r\nOne alternative would be to revert the changes under #27948, i.e. make it extend `ServletException` again, and document more explicitly the reason it does not extend `ServletRequestBindingException` is that it can be raised at a lower level and lives in a different package. In retrospect, I suspect #27910 was more a question than an actual problem. This essentially answers the \"if there is no good reason\" question under #27910.\r\n\r\n\r\n"
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "2269c0063a4f56985a8903b16d922ef05a7e6b30"
      ]
    }
  },
  {
    "number": 28458,
    "title": "Add resolver for request attributes for `@HttpExchange` methods",
    "state": "closed",
    "created_at": "2022-05-13T14:11:19Z",
    "updated_at": "2022-05-23T10:25:50Z",
    "author": "rstoyanchev",
    "url": "https://github.com/spring-projects/spring-framework/issues/28458",
    "body": "This can be used to provide hints to the `WebExchangeFilter` chain which is useful for security and other reasons.",
    "labels": [
      "in: web",
      "type: enhancement"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "496c1dcae195194be4c6c829b5e6a510d0817032",
        "495507e5d40bec0b7cd1d2759e9aed81bdb3ad07"
      ]
    }
  },
  {
    "number": 28469,
    "title": "Introduce a meta-annotation that indicates the annotated element requires reflection hints",
    "state": "closed",
    "created_at": "2022-05-17T07:17:03Z",
    "updated_at": "2022-05-20T13:23:06Z",
    "author": "snicoll",
    "url": "https://github.com/spring-projects/spring-framework/issues/28469",
    "body": "We're now at a stage where we need to port a number of hints in a sustainable way and avoid having to write dedicated code for common patterns we have in the portfolio. \r\n\r\nOn such simple pattern is the following:\r\n\r\n```java\r\n@EventListener\r\npublic void onContextRefresh(ContextRefreshedEvent event) { ... }\r\n```\r\n\r\nThe internal implementation processing `@EventListener` is creating a wrapper that invokes the method via reflection so that needs an invocation hint to work in restricted environment (native image).\r\n\r\nA more complex pattern could be\r\n\r\n```java\r\n@GetMapping(\"/dtos/{id}\")\r\npublic MyDto findById(String id) { ... }\r\n```\r\n\r\nIn this case, not only the `findById` method is invoked by reflection but the chances are high that `MyDto` is going to be serialized using some sort of converter and therefore require additional hints.\r\n\r\nRather than having dedicated `BeanRegistrationAotProcessor` or `BeanFactoryInitializationAotProcessor` we could build a generic one that checks for the presence of a certain annotation. We could then annotate the annotations that we know require reflection so that they are processed semi-automatically.\r\n\r\n```java\r\n@Target({ElementType.METHOD, ElementType.ANNOTATION_TYPE})\r\n@Retention(RetentionPolicy.RUNTIME)\r\n@Documented\r\n@Reflective\r\npublic @interface EventListener { ... }\r\n``` \r\n \r\n`@Reflective` could take the strategy to use (a bit like `@Conditional` does). This would help us implement a more fine-grained algorithm like the MVC use case.",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [
      {
        "author": "snicoll",
        "created_at": "2022-05-17T07:20:07Z",
        "body": "One thing to mention is that adding this meta-annotation can be temporary. Once the underlying infrastructure is fully resolved ahead-of-time, and therefore the need for reflection for AOT-based context is no longer necessary, the meta-annotation can be simply removed."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "255a52bc7a5f10a1f142f45e4ef7118f241314aa",
        "4cca190aad3cf643c765f39655432e0ebd00549e"
      ]
    }
  },
  {
    "number": 28474,
    "title": "Introduce AotDetector mode",
    "state": "closed",
    "created_at": "2022-05-18T13:20:36Z",
    "updated_at": "2022-06-02T12:58:25Z",
    "author": "snicoll",
    "url": "https://github.com/spring-projects/spring-framework/issues/28474",
    "body": "We need a way to opt-in for the use of AOT on the JVM. Right now, we rely on the system property that is set when building a native image (or running with the native image agent with Native Build Tools), but this should be restricted to things that should really behave differently there.\r\n\r\nSpring Native has [an `AotModeDetector`](https://github.com/spring-projects-experimental/spring-native/blob/d176e2d360350c5f91d0a44f9b7fefddd3f6d2db/spring-native/src/main/java/org/springframework/nativex/AotModeDetector.java#L29) we could use as an inspiration. This will also be relevant for #28205.",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "da8c4de263835afb3adf2c26ab62afb214157b85",
        "c606f757739aa30e801ca20837e51905dbb09560",
        "a9295e877e4388e83bf09b633de31486e30f1963"
      ]
    }
  },
  {
    "number": 28491,
    "title": "Support default methods in `@HttpExchange` interface",
    "state": "closed",
    "created_at": "2022-05-20T01:59:58Z",
    "updated_at": "2022-06-01T17:19:09Z",
    "author": "wonwoo",
    "url": "https://github.com/spring-projects/spring-framework/issues/28491",
    "body": "```java\r\n@HttpExchange(\"http://localhost:8080\")\r\npublic interface GreetingClient {\r\n\r\n    @GetExchange(\"/greeting\")\r\n    Flux<Greeting> greetings();\r\n\r\n    @PostExchange(\"/greeting\")\r\n    Mono<Greeting> greetings(@RequestBody Greeting greeting);\r\n\r\n    default Flux<Greeting> defaultMethod() {\r\n        return greetings(new Greeting(\"default method test\"))\r\n                .flatMapMany(it -> greetings());\r\n    }\r\n}\r\n```\r\n\r\ndefaultMethod method I hope it works! \r\n",
    "labels": [
      "in: web",
      "type: enhancement"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "cc56da7735291d1576d08f0f853e6dad07de0aa6"
      ]
    }
  },
  {
    "number": 28492,
    "title": "Support property placeholders in url attribute of @HttpExchange",
    "state": "closed",
    "created_at": "2022-05-20T04:11:24Z",
    "updated_at": "2022-12-02T19:15:08Z",
    "author": "xuan",
    "url": "https://github.com/spring-projects/spring-framework/issues/28492",
    "body": "**Affects:** 6.0.0-SNAPSHOT\r\n\r\n---\r\nHi Spring Team,\r\n\r\nCan you please add the ability to reference properties for `@HttpExchange`, `@GetExchange`, and `@PostExchange` defined in `application.yaml`?\r\n\r\nRight now, I have to hard code my URL in the annotation:\r\n\r\n```java\r\n@HttpExchange(url = \"/multitenant/public/api\")\r\npublic interface CumulusRepository {\r\n\r\n    @GetExchange(\"/get_stuff\")\r\n    Cumulus getCumulusAlerts(@RequestHeader Map<String, String> headers);\r\n\r\n    @PostExchange(\"/getAccessToken\")\r\n    Token getAccessToken(@RequestBody String credential);\r\n}\r\n```\r\n\r\nBut I wish to define my URL in `application.yaml` and reference it in the annotations like this:\r\n\r\n```java\r\n@HttpExchange(url = \"${cumulus.baseUrl}\")\r\npublic interface CumulusRepository {\r\n\r\n    @GetExchange(\"${cumulus.alertUrl}\")\r\n    Cumulus getCumulusAlerts(@RequestHeader Map<String, String> headers);\r\n\r\n    @PostExchange(\"${cumulus.tokenUrl}\")\r\n    Token getAccessToken(@RequestBody String credential);\r\n}\r\n```\r\n\r\n",
    "labels": [
      "in: web",
      "type: enhancement"
    ],
    "comments": [
      {
        "author": "jcthalys",
        "created_at": "2022-12-02T15:41:42Z",
        "body": "This is still not working for me:\r\n```java \r\n// using spring boot 3.0.0 and framework 6.0.2\r\n@SpringBootApplication\r\npublic class HttpInterfaceApplication {\r\n\r\n\tpublic static void main(String[] args) {\r\n\t\tSpringApplication.run(HttpInterfaceApplication.class, args);\r\n\t}\r\n\r\n\t@Bean\r\n\tApplicationListener<ApplicationReadyEvent> ready(GoogleClient googleClient) {\r\n\t\treturn event -> {\r\n\t\t\tString googlePage = googleClient.getGooglePage();\r\n\t\t\tSystem.out.println(googlePage);\r\n\t\t};\r\n\t}\r\n\r\n\t@Bean\r\n\tGoogleClient googleClient(HttpServiceProxyFactory factory) {\r\n\t\treturn factory.createClient(GoogleClient.class);\r\n\t}\r\n\r\n\t@Bean\r\n\tHttpServiceProxyFactory getHttpServiceProxyFactory(WebClient.Builder builder) {\r\n\t\treturn HttpServiceProxyFactory.builder()\r\n\t\t\t\t.clientAdapter(WebClientAdapter.forClient(builder.build())).build();\r\n\t}\r\n}\r\n\r\n@HttpExchange(url = \"${google.url}\")\r\ninterface GoogleClient {\r\n\t@GetExchange\r\n\tString getGooglePage();\r\n}\r\n```\r\nError:\r\n```log\r\njava.lang.IllegalArgumentException: Map has no value for 'google.url'\r\n\tat org.springframework.web.util.UriComponents$MapTemplateVariables.getValue(UriComponents.java:348) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.util.UriComponents.expandUriComponent(UriComponents.java:263) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.util.HierarchicalUriComponents$FullPathComponent.expand(HierarchicalUriComponents.java:921) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.util.HierarchicalUriComponents.expandInternal(HierarchicalUriComponents.java:439) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.util.HierarchicalUriComponents.expandInternal(HierarchicalUriComponents.java:52) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.util.UriComponents.expand(UriComponents.java:161) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.util.DefaultUriBuilderFactory$DefaultUriBuilder.build(DefaultUriBuilderFactory.java:391) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.util.DefaultUriBuilderFactory.expand(DefaultUriBuilderFactory.java:149) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.reactive.function.client.DefaultWebClient$DefaultRequestBodyUriSpec.uri(DefaultWebClient.java:228) ~[spring-webflux-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.reactive.function.client.DefaultWebClient$DefaultRequestBodyUriSpec.uri(DefaultWebClient.java:189) ~[spring-webflux-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.reactive.function.client.support.WebClientAdapter.newRequest(WebClientAdapter.java:105) ~[spring-webflux-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.reactive.function.client.support.WebClientAdapter.requestToBody(WebClientAdapter.java:69) ~[spring-webflux-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.service.invoker.HttpServiceMethod$ResponseFunction.lambda$initBodyFunction$5(HttpServiceMethod.java:378) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.service.invoker.HttpServiceMethod$ResponseFunction.execute(HttpServiceMethod.java:288) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.service.invoker.HttpServiceMethod.invoke(HttpServiceMethod.java:105) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.web.service.invoker.HttpServiceProxyFactory$HttpServiceMethodInterceptor.invoke(HttpServiceProxyFactory.java:271) ~[spring-web-6.0.2.jar:6.0.2]\r\n\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.0.2.jar:6.0.2]\r\n\tat org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:218) ~[spring-aop-6.0.2.jar:6.0.2]\r\n\r\n```\r\nWhen I use the url directly it works fine"
      },
      {
        "author": "renatomrcosta",
        "created_at": "2022-12-02T19:11:24Z",
        "body": "> This is still not working for me:\r\n\r\nI stumbled in the same issue, and found out perhaps a clue to clarify if the URL field considers `application properties` at all, or just URI placeholders.\r\n\r\nThis error indicates that the application properties with placeholders are not considered at all: If you try, it just considers it a path: (like when you call `\"/v1/api/customer/{customerId}\"`. The `$` sign in java or `\\$` in Kotlin were not parsed.\r\n\r\n```kotlin\r\n@HttpExchange(url = \"{httpbin}\") // I chose a single name here, because if we try to simply remove the braces and add the $ back, it still doesn't work, but it's easy enough to use to test.\r\ninterface HttpBinClient {\r\n    @GetExchange(\"/anything\")\r\n    fun anything(@PathVariable(\"httpbin\") httpbin: String): Mono<String>\r\n}\r\n```\r\n\r\n(Repo with working example here: [LINK](https://github.com/renatomrcosta/springboot3releaseplayground/blob/spring-issue-28492/src/main/kotlin/com/xunfos/springboot3releaseplayground/Springboot3releaseplaygroundApplication.kt))\r\n\r\nso, in this case: is it truly intended that the URL and other fields can be parameterized with application properties at all? If so, then this ticket shouldn't be closed as completed. \r\n\r\nOtherwise @jcthalys , I recommend taking the more verbose approach of providing a webClient with its baseUrl set per httpProxyFactory you need to build for the time being, and not setting the URL property at the annotation level. It's the approach I'll be taking for the time being."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "2a2fba6a37666b41205565b7d1a804373a6635d2"
      ]
    }
  },
  {
    "number": 28496,
    "title": "Break package tangle between o.s.aot and o.s.core",
    "state": "closed",
    "created_at": "2022-05-20T12:07:00Z",
    "updated_at": "2022-06-08T09:54:08Z",
    "author": "snicoll",
    "url": "https://github.com/spring-projects/spring-framework/issues/28496",
    "body": "Two hints registrar have been recently added that creates a cycle between those two packages. We should consider moving those, perhaps all the way up to `spring-context` as they aren't really useful without it.",
    "labels": [
      "type: task",
      "theme: aot"
    ],
    "comments": [
      {
        "author": "snicoll",
        "created_at": "2022-05-20T13:32:36Z",
        "body": "The tangle for spring factories hint is a little bit problematic as it relies on a package protected method in `SpringFactories`, cc @philwebb "
      },
      {
        "author": "philwebb",
        "created_at": "2022-05-20T17:29:19Z",
        "body": "Tricky. There's just enough code in `SpringFactoriesLoader.loadFactoriesResource` to make copy/paste unappealing. We could perhaps make it a `protected static` method then have a private subclass in `SpringFactoriesLoaderRuntimeHintsRegistrar` to access it again. Either that, or just make that method public."
      },
      {
        "author": "philwebb",
        "created_at": "2022-05-20T17:31:21Z",
        "body": "It feels a bit odd to have `spring-context` add the factory hints, I think I'd prefer a `org.springframework.aot.support` package that takes care of registering hints for items in `org.springframework.code`.\r\n\r\nIt would also be really nice to have a checkstyle rule to enforce the layering."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "16eff6835748be5316520b313e08a8a481b900d1"
      ]
    }
  },
  {
    "number": 28497,
    "title": "Introduce utility to register hints for an annotation that uses AliasFor",
    "state": "closed",
    "created_at": "2022-05-20T12:15:52Z",
    "updated_at": "2022-05-20T13:23:05Z",
    "author": "snicoll",
    "url": "https://github.com/spring-projects/spring-framework/issues/28497",
    "body": "The core framework allows the use of `@AliasFor` which creates a JDK proxy behind the scenes. Registering a reflection hint for the attributes of the annotation is not enough for this to be used at runtime in a native image. \r\n\r\nTo ease the registration, we'll add a utility that takes care of this logic.",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "2f94713078ddf9ed17426b062bd70bf0ab83fe83",
        "059b66bf26c2aa8b96847938a2eb00e7645c69e1",
        "2517c72f7d2a7406137c25c9f63ccdd35c082979"
      ]
    }
  },
  {
    "number": 28501,
    "title": "Create UrlResource factory methods that throw unchecked exceptions",
    "state": "closed",
    "created_at": "2022-05-22T16:57:15Z",
    "updated_at": "2022-05-23T12:30:00Z",
    "author": "sbrannen",
    "url": "https://github.com/spring-projects/spring-framework/issues/28501",
    "body": "## Overview\r\n\r\n`UrlResource` constructors throw checked exceptions which makes it difficult to use them in `java.util.Stream` and `java.util.Optional` APIs or other scenarios when a checked `IOException` is undesirable.\r\n\r\n## Proposal\r\n\r\nTo support such use cases, we should introduce factory methods in `UrlResource` that throw `UncheckedIOException`, initially for the constructor variants that accept a `URI` or `String`.\r\n\r\n## Related Issues\r\n\r\n- #21515 ",
    "labels": [
      "in: core",
      "type: enhancement"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "f07e7ab39d04c0f8b27f3e5678227952cc3ac380"
      ]
    }
  },
  {
    "number": 28504,
    "title": "Allow custom HTTP method with @HttpExchange methods",
    "state": "closed",
    "created_at": "2022-05-23T15:23:25Z",
    "updated_at": "2022-05-24T08:28:41Z",
    "author": "rstoyanchev",
    "url": "https://github.com/spring-projects/spring-framework/issues/28504",
    "body": "`@HttpExchange` is currently only allowed at the class level for inheriting common attributes, but at the method level one has to choose one of the HTTP method specific shortcut annotations. We can allow it at the method level for custom HTTP methods, or less common ones like OPTIONS which won't need a dedicated shortcut.",
    "labels": [
      "type: enhancement"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "ff890bc1cc11381a3cfffa66f9be9f013adc0b51"
      ]
    }
  },
  {
    "number": 28505,
    "title": "Refactor HttpServiceProxyFactory to be suitable as an infrastructure bean",
    "state": "closed",
    "created_at": "2022-05-23T15:30:33Z",
    "updated_at": "2022-05-24T08:28:41Z",
    "author": "rstoyanchev",
    "url": "https://github.com/spring-projects/spring-framework/issues/28505",
    "body": "Currently `HttpServiceProxyFactory` is friendly for programmatic use but is more likely to be declared as a bean since it needs a number of dependencies injected such as as a `ConversionService`, and an `EmbeddedValueResolver` as of #28492. In a Boot application one would also inject `WebClient.Builder`. ",
    "labels": [
      "in: web",
      "type: enhancement"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "48c1746693e91a0b2b96af837841dab98e535b5a"
      ]
    }
  },
  {
    "number": 28506,
    "title": "Support module path scanning for \"classpath*:\" resource prefix",
    "state": "closed",
    "created_at": "2022-05-23T16:50:34Z",
    "updated_at": "2022-05-25T13:07:11Z",
    "author": "sbrannen",
    "url": "https://github.com/spring-projects/spring-framework/issues/28506",
    "body": "In light of the findings from investigating #21515, we should introduce implicit support for scanning the module path whenever the `classpath*:` resource prefix is used.\r\n\r\nThis should allow existing applications relying on `classpath*:` semantics to work when migrating to the Java module system (for use cases not already supported by `ClassLoader`-based class path scanning).\r\n\r\nFor example, `@ComponentScan` should effectively work the same when an application is deployed on the class path or module path.",
    "labels": [
      "in: test",
      "in: core",
      "type: enhancement"
    ],
    "comments": [
      {
        "author": "sbrannen",
        "created_at": "2022-05-24T14:49:16Z",
        "body": "This issue has been resolved for inclusion in 6.0 M5.\r\n\r\nIn the interim, feel free to try out 6.0 snapshots for applications deployed with patched modules.\r\n\r\nI've created a new repository for demonstrating the use of the Spring Framework with the Java Module System: https://github.com/sbrannen/spring-module-system\r\n\r\nThat repository currently contains a single `maven-surefire-patched-module` project which demonstrates support for `@ComponentScan` in a patched module using Maven Surefire."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "fa8b3ef8b61319a08d5238888b3a6f77d18f04f9",
        "19b436c6aa14e79e6f3a98c15a8edff2a8c351fc",
        "190a459cfa538d16f7a73d23759859e4167a7409",
        "957faac91832a7f6e79ceb79bd573c66dde1afa6",
        "23a58e6bab2b5aecd77e30c2b2d0ee41b643876f"
      ]
    }
  },
  {
    "number": 28517,
    "title": "Ambiguous behavior for ClassNameGenerator::generateClassName",
    "state": "closed",
    "created_at": "2022-05-24T11:52:11Z",
    "updated_at": "2022-06-20T09:17:05Z",
    "author": "bclozel",
    "url": "https://github.com/spring-projects/spring-framework/issues/28517",
    "body": "`ClassNameGenerator` has two variants for the `generateClassName` feature. One that takes a target `Class<?>` and another that takes a target `String`. I'm a bit confused by the concept of a target here and I think we should explain that a bit more in the javadocs.\r\n\r\nThese methods also have different behavior:\r\n\r\n```java\r\nClassName first = this.generator.generateClassName(java.io.InputStream.class, \"bytes\");\r\n// will result in java.io.InputStream__Bytes\r\n\r\nClassName first = this.generator.generateClassName(\"java.io.InputStream\", \"bytes\");\r\n// will result in __.JavaIoInputStream__Bytes\r\n```\r\n\r\nEven if the difference of behavior is intended, the name and docs are very similar. Also, a common use case for the `ClassNameGenerator` is about generating sources in a specific package to work around visibility issues. The second variant can make this case more difficult to achieve.\r\n\r\nAs a side note, this class is also referring to the now defunct `@see GeneratedClassName`.\r\n\r\ncc @philwebb @snicoll ",
    "labels": [
      "in: core",
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [
      {
        "author": "philwebb",
        "created_at": "2022-05-24T17:34:36Z",
        "body": "The `String` variant was added to support generation where there isn't a single class that can be linked. I think it's currently only used in `BeanRegistrationsAotContribution`. We should probably rename that method to make it clearer that there is no target class.\r\n\r\nI know @snicoll was wondering about the use of the `__` package in general, perhaps we can make the generated `BeanRegistrations` class be in the same package as the `@SpringBootApplication` class then we can drop the string version entirely.\r\n\r\nThe `ClassNameGenerator` should be removed, we dropped that class during the prototype work."
      },
      {
        "author": "snicoll",
        "created_at": "2022-06-20T08:55:55Z",
        "body": "The second method that takes a `String` rather than a `Class<?>` has been removed in 4bd33cb6e0659df2cd0b9fa04feea8fd77e5a16d. I am going to look at the Javadoc and see if we can clarify "
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "63fae8c5a7ea21e4ff59ee094cc4541c048e8e54"
      ]
    }
  },
  {
    "number": 28518,
    "title": "Add reflection hints for Web controllers",
    "state": "closed",
    "created_at": "2022-05-24T14:07:30Z",
    "updated_at": "2022-06-13T13:29:35Z",
    "author": "snicoll",
    "url": "https://github.com/spring-projects/spring-framework/issues/28518",
    "body": "The core framework invokes `@RequestMapping`-annotated methods (`@GetMapping`, etc) using reflection. To run in a native image, we need hints for those. We may also want to infer that return types are going to be serialized, or that input times are going to be mapped from the request.\r\n\r\nAll this can go away if we generate an optimized code for the router but let's go the hints route for now.",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [
      {
        "author": "snicoll",
        "created_at": "2022-05-24T14:31:47Z",
        "body": "For the annotations themselves and loading `org/springframework/http/mime.types` it would be nice if those were contributed only if the application is going to use it. Adding a `RuntimeHintsRegistrar` in `aot.factories` would not achieve that goal but it's not clear cut where to put `@ImportRuntimeHints`. As it should be consistent, we can't really rely on Spring Boot for that. \r\n\r\nFor the annotations, I was tempted to add an import on `org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping` but it's not obvious that's going to be a bean so the annotation there feels a little bit odd."
      },
      {
        "author": "snicoll",
        "created_at": "2022-05-24T14:43:15Z",
        "body": "Considering that `MergedAnnotations` is required to automatically handle the creation of the proxy. I wonder if dealing with everything that is method specific can be a good thing. This would be more code but more tailored to what is actually happening in the application."
      },
      {
        "author": "sdeleuze",
        "created_at": "2022-06-08T13:45:43Z",
        "body": "I managed to make `webmvc-tomcat` sample working with https://github.com/sdeleuze/spring-framework/tree/gh-28518. I will refine it based on @snicoll feedback."
      },
      {
        "author": "sdeleuze",
        "created_at": "2022-06-13T12:44:21Z",
        "body": "This issue will be focused on reflection hints for controllers and reflection-based serialization of parameters annotated\r\nwith `@RequestBody` and return values annotated with `@ResponseBody`. I will create subsequent issues for other use-cases (`HttpEntity`, `@ControllerAdvice`, etc.)"
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "c956c06077a2c2c210bb79c5ef72d7a4527c041d",
        "966e46c833bba197382aa2c1224c67d8576e918c",
        "6bc1f3365a604545c8ba2f31efc19398b4e784b8",
        "3574f3d2c0ba128d967c7e9772e7ed2f32c9619a",
        "9aefe70bab08b4968e63178fa7e1ee00b8e69ac1",
        "10244cfdd44e6af28bf9eacc5e3388487b35ecc7",
        "5b21e65f2ad6debc6d32291b2711adfd038669d9",
        "bc065e8f8344b1c5d1f74f4b39c77e2ef753d06d",
        "239e979e5ab5eac58e7fc3134137ae256cc01375",
        "48d022d35ea9df900c84d1ccb7dead868821872c",
        "ef3f4655326b03860ff20a2b3cde370c3666ef84",
        "a57dead4be7e19c423df867852380b38c1f5ddbc",
        "0992f855e64216970cb2c3f92cf6e6eab0ad62e4",
        "12d756a2520dbd65f55d342ef83a9ce9ea8b4931",
        "5e56d9cb2171ff8bb051a8a5c30fbfeae1301d36",
        "90dcbe85bde899b9f9d2a1d16d952946806b9fb3",
        "dee47c366e909dc50978fa19b3dc06a9d73a182d",
        "2b76a12b86a62cc46886e1b7f0e52ea9d256f899",
        "ecf39cfaa6055513ee9918951099aba870ae8c74",
        "349156368ffa0a35a7565c1a1f8aeae636a9b666"
      ]
    }
  },
  {
    "number": 28526,
    "title": "Filtering of BeanRegistrationAotProcessor beans should be optional",
    "state": "closed",
    "created_at": "2022-05-25T22:22:29Z",
    "updated_at": "2022-07-18T11:46:26Z",
    "author": "philwebb",
    "url": "https://github.com/spring-projects/spring-framework/issues/28526",
    "body": "Currently `BeanDefinitionMethodGeneratorFactory.isImplicitlyExcluded` always filters beans that implement `BeanRegistrationAotProcessor`. For Spring Boot, we think we'll need to have bean that implements `BeanRegistrationAotProcessor` but isn't filtered.",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [
      {
        "author": "philwebb",
        "created_at": "2022-05-27T03:58:43Z",
        "body": "I think we can use `BeanRegistrationExcludeFilter` as a signal for this. Any AOT processor bean that doesn't implement `BeanRegistrationExcludeFilter` can be implicitly filtered. If it does implement `BeanRegistrationExcludeFilter` then we consider that a signal that it is handling its own filtering."
      },
      {
        "author": "philwebb",
        "created_at": "2022-06-09T02:08:45Z",
        "body": "Reopening because it's not particularly obvious that `BeanRegistrationExcludeFilter` is being implemented just to exclude the processor. Perhaps a default method on `AotProcessor` might be better."
      },
      {
        "author": "snicoll",
        "created_at": "2022-07-13T15:16:01Z",
        "body": "@philwebb I am assuming this one won't make it the release tomorrow."
      },
      {
        "author": "philwebb",
        "created_at": "2022-07-18T10:06:47Z",
        "body": "Sorry @snicoll, I didn't get to refine it. The original fix is in M5 so I'll move it back and open a new issue "
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "6f71328ba6f8d2d6d001cf26f24459852ee5dd8f"
      ]
    }
  },
  {
    "number": 28528,
    "title": "Proxy hint missing when `AliasFor` is used on the annotation itself",
    "state": "closed",
    "created_at": "2022-05-26T13:10:35Z",
    "updated_at": "2022-05-26T13:58:22Z",
    "author": "snicoll",
    "url": "https://github.com/spring-projects/spring-framework/issues/28528",
    "body": "`RuntimeHintsUtils#registerAnnotation` will not register a proxy hint for an annotation using `@AliasFor` against a local attribute. This leads to issues in a native environment:\r\n\r\n```\r\nCaused by: com.oracle.svm.core.jdk.UnsupportedFeatureError: Proxy class defined by interfaces [interface org.springframework.web.bind.annotation.RequestMapping, interface org.springframework.core.annotation.SynthesizedAnnotation] not found. Generating proxy classes at runtime is not supported. Proxy classes need to be defined at image build time by specifying the list of interfaces that they implement. To define proxy classes use -H:DynamicProxyConfigurationFiles=<comma-separated-config-files> and -H:DynamicProxyConfigurationResources=<comma-separated-config-resources> options.\r\n```",
    "labels": [
      "type: bug",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "718ef42d68acbdc9f62799d2e3762bd4d4361a04",
        "86a85f558c7c319c6dbb651807dce7ebbe2e1f3e"
      ]
    }
  },
  {
    "number": 28533,
    "title": "Improve options for exception handling in HTTP interface client ",
    "state": "closed",
    "created_at": "2022-05-27T15:48:06Z",
    "updated_at": "2022-06-24T14:55:55Z",
    "author": "rstoyanchev",
    "url": "https://github.com/spring-projects/spring-framework/issues/28533",
    "body": "There is no good way to handle exceptions from a single place. \r\n\r\nAn application may want to turn `WebClientException` into another exception, or handle a specific exception. `WebClient` provides status handlers, but those are configured per request, and not exposed through the builder.",
    "labels": [
      "in: web",
      "type: enhancement"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "a04e805d2709122e2bb43a35f71d6c4d1f04ab41",
        "24c46142c63ff0375e83374766903ac87c86d85d"
      ]
    }
  },
  {
    "number": 28552,
    "title": "Deprecate trailing slash match and change default value from true to false",
    "state": "closed",
    "created_at": "2022-06-01T13:43:46Z",
    "updated_at": "2025-02-05T08:25:04Z",
    "author": "vpavic",
    "url": "https://github.com/spring-projects/spring-framework/issues/28552",
    "body": "> Whether to match to URLs irrespective of the presence of a trailing slash. If enabled a method mapped to `\"/users\"` also matches to `\"/users/\"`.\r\n> The default value is `true`.\r\n\r\nEven though this behavior has been long present in Spring, it introduces ambiguity that can (combined with some other choices) easily have consequences in shape of security vulnerabilities. Consider this example:\r\n\r\n```java\r\n@SpringBootApplication\r\n@RestController\r\npublic class SampleApplication {\r\n\r\n    public static void main(String[] args) {\r\n        SpringApplication.run(SampleApplication.class, args);\r\n    }\r\n\r\n    @GetMapping(\"/resources\")\r\n    String resources() {\r\n        return \"Hello from /resources\";\r\n    }\r\n\r\n    @GetMapping(\"/resources/{id}\")\r\n    String resourceById(@PathVariable Long id) {\r\n        return \"Hello from /resources/\" + id;\r\n    }\r\n\r\n    @Bean\r\n    SecurityFilterChain filterChain(HttpSecurity httpSecurity) throws Exception {\r\n        return httpSecurity\r\n                .authorizeHttpRequests(requests -> {\r\n                    requests.antMatchers(\"/resources\").hasRole(\"admin\");\r\n                    requests.antMatchers(\"/resources/**\").hasRole(\"user\");\r\n                    requests.anyRequest().denyAll();\r\n                })\r\n                .httpBasic(Customizer.withDefaults())\r\n                .build();\r\n    }\r\n\r\n}\r\n```\r\n\r\n```properties\r\nspring.security.user.password=password\r\nspring.security.user.roles=user\r\n```\r\n\r\nDefault user (with role `user`) will get `403` attempting to `GET /resources` but can avoid protection by issuing `GET /resources/`, which wouldn't be possible with trailing slash matching disabled.\r\n\r\nLet me note that I'm aware that using `mvcMatchers` instead of `antMatchers` would have prevented this issue but that doesn't change the fact that there are many configurations out there relying on `antMatchers` and that sometimes `antMatchers` are simply more suitable for other reasons.\r\n\r\nAlso, I personally see little real benefit of having trailing slash matching enabled because:\r\n- if application renders server-side generated views navigation is either way established using hyperlinks\r\n- if application exposes APIs then even more so it is expected that requests are aligned with the API docs\r\n\r\nFor places where it's really needed for application to respond to both requests, I'd argue that it's either way better solution to configure redirects instead of application wide ambiguous request mappings.\r\n\r\nPlease consider making this change for `6.0`.",
    "labels": [
      "in: web",
      "type: enhancement"
    ],
    "comments": [
      {
        "author": "rstoyanchev",
        "created_at": "2022-06-08T14:17:15Z",
        "body": "I think most users would would expect that a trailing slash doesn't make a difference. From that perspective, the default is not unreasonable, and more than just HATEOAS style navigation or API guidance, even just manually typing a URL somewhere.\r\n\r\nIf we change the default, many would look to change it back, so overall it's hard to avoid the need to align Spring Security with with Spring MVC through `mvcMatchers`. One could argue that it's a safer default but this applies only when used with Spring Security. It's not unsafe by itself. \r\n\r\nFor configuring redirects, do you mean externally, like in a proxy? That would solve the problem at a different level, before Spring Security and Spring MVC, so I would be more interested in that direction but we can only make it a recommendation, and we can still make such a recommendation independent of this.\r\n\r\n\r\n\r\n"
      },
      {
        "author": "vpavic",
        "created_at": "2022-06-09T16:42:01Z",
        "body": "> From that perspective, the default is not unreasonable, and more than just HATEOAS style navigation or API guidance, even just manually typing a URL somewhere.\r\n\r\nI can see _manually typing a URL_ as a real argument only in case of web apps (not APIs) and even there it's only potentially useful for a few select URLs that are considered to be entry points into the application and are likely to be directly entered by the users.\r\n\r\n> One could argue that it's a safer default but this applies only when used with Spring Security. It's not unsafe by itself.\r\n\r\nThis is the part I strongly disagree with - what Spring Security does is nothing special nor unique. You can end up with the same kind of risks with other Java filter based security frameworks (for example, Apache Shiro) or by applying security (authorization) in an external component that sits in front of your Spring application. After all, on a high level, conceptually these all take the same approach.\r\n\r\n> For configuring redirects, do you mean externally, like in a proxy?\r\n\r\nEither externally in a proxy or using something like [Tuckey UrlRewriteFilter](https://www.tuckey.org/urlrewrite/) or even simply using `ViewControllerRegistry::addRedirectViewController` to add redirects where needed.\r\n\r\nWhat I would like to see in Spring are the defaults that are not ambiguous and are therefore less prone to abuse. When I see a handler annotated with `@GetMapping(\"/api/resources\")` that it really maps to only what I see, unless I opt into any additional (ambiguous) behavior explicitly. This change together with #23915 would achieve that."
      },
      {
        "author": "rstoyanchev",
        "created_at": "2022-06-10T13:57:52Z",
        "body": "I'm not necessarily disagreeing. I'm merely making the point that by itself, trailing slash is not unsafe. It's only when combined with a proxy or filter that also interprets URLs, where it becomes a problem, and the problem more generally is that there may be differences, which could go both ways. \r\n\r\nThat said, this is also the reason, I've come to see over time that URL paths should be left alone as is as much as possible, avoiding normalization as much as possible. It's the only way for frameworks to minimize differences and align naturally. This is also why `PathPatternParser` was designed to not decode the full path in order to match to mappings, unlike `AntPathMatcher`, doesn't even support suffix patterns, etc.\r\n\r\nIn any case, the only way to really make a significant difference here I think is to deprecate the trailingSlash option entirely and encourage an alternative solution, like a proxy or filter to redirect. That enforces being more precise about where you want to do that exactly, and it can be done ahead of security decisions. Otherwise the possibility for a mismatch between web and security frameworks remains. It's just too easy to flip the default back and not think about it again.\r\n\r\nThis is something that we'll discuss as a possibility for 6.0.\r\n"
      },
      {
        "author": "vpavic",
        "created_at": "2022-06-10T14:04:40Z",
        "body": "> In any case, the only way to really make a significant difference here I think is to deprecate the trailingSlash option entirely and encourage an alternative solution, like a proxy or filter to redirect.\r\n\r\nI like that even better. Thanks for the feedback."
      },
      {
        "author": "rstoyanchev",
        "created_at": "2022-06-21T09:50:05Z",
        "body": "**Team decision:** we'll go ahead with this. It aligns with various other path matching changes we've made in 5.2 and 5.3 such suffix pattern matching, path segment trimming, and path decoding, to make path matching more transparent and explicit. "
      },
      {
        "author": "wilkinsona",
        "created_at": "2022-06-21T10:07:04Z",
        "body": "Will the default be changed to false as part of this deprecation?"
      },
      {
        "author": "rstoyanchev",
        "created_at": "2022-06-21T11:23:42Z",
        "body": "Yes, I'm thinking that we might as well and that we'll have to, since otherwise you'd need to set it in order to stop using it. We had the same issue with suffix pattern matching. "
      },
      {
        "author": "rstoyanchev",
        "created_at": "2022-06-29T15:13:45Z",
        "body": "The trailing slash option is now deprecated and set to `false` in all applicable places. The change applies mainly to annotated controllers, since `SimpleUrlHandlerMapping`, it turns out, was already set to `false` by default. Nevertheless, it's now deprecated throughout and to be removed eventually."
      },
      {
        "author": "bclozel",
        "created_at": "2022-07-01T15:22:34Z",
        "body": "I've just found this while browing the code @rstoyanchev :\r\n\r\nhttps://github.com/spring-projects/spring-framework/blob/50240bb609b6441390d436005a7f2e7a4cdf5454/spring-webmvc/src/main/java/org/springframework/web/servlet/mvc/method/annotation/RequestMappingHandlerMapping.java#L85\r\n\r\nShould this value be changed as well?"
      },
      {
        "author": "rstoyanchev",
        "created_at": "2022-07-01T15:25:12Z",
        "body": "Looks like it, yes."
      },
      {
        "author": "MartinHaeusler",
        "created_at": "2022-12-02T14:47:55Z",
        "body": "This little stunt just cost us over 10 man-hours of pure frustration staring at 404 issues. We debugged through the entire security filter chain, the servlet, everything (great fun!) - until we arrived at the path matchers where it became apparent that the difference between the pattern (and its path placeholders) and the provided path was only the trailing slash. This may be apparent in small applications, but we have over 300 endpoint mappings. If the little phrase `404` would have appeared somewhere in the lengthy migration notes, we would have found it."
      },
      {
        "author": "bclozel",
        "created_at": "2022-12-02T14:52:00Z",
        "body": "@MartinHaeusler I'm sorry you went through this. Maybe we can improve the documentation to avoid the same issue for other developers. Can you share at which documentation you were looking at while working on this?"
      },
      {
        "author": "MartinHaeusler",
        "created_at": "2022-12-02T14:58:27Z",
        "body": "@bclozel we were looking at this:\r\n\r\nhttps://github.com/spring-projects/spring-boot/wiki/Spring-Boot-3.0-Migration-Guide\r\n\r\nBut given how big Spring Boot is (with all its modules) it's hard to tell which parts of this document are even relevant for any given application. We spent some time on google looking for \"Spring Boot 3 404\", but the search results produced nothing specific for the latest version. Up to this point, we were not even **aware** that some clients were sending trailing slashes to our endpoints, it just \"happened to work\". That's why the section on trailing slashes didn't really catch any attention. Making the migration guide easier to search through (i.e. \"if you do not update X, you will receive error Y\") would have been great. If there was any mention of \"if your application relied on this behavior, you will receive HTTP 404 errors\" in the migration guide, we would have found it instantly... No hard feelings. We are now aware of it and can move on."
      },
      {
        "author": "bclozel",
        "created_at": "2022-12-02T15:07:50Z",
        "body": "@MartinHaeusler I've added a quick mention of \"HTTP 404 errors\" in [the dedicated section of the Spring Boot migration guide](https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-3.0-Migration-Guide#spring-mvc-and-webflux-url-matching-changes), hopefully this will help others. Thanks for bringing this up."
      },
      {
        "author": "armlesshobo",
        "created_at": "2022-12-20T17:03:39Z",
        "body": "Are there any considerations for trimming trailing slashes by default?"
      },
      {
        "author": "kdebski85",
        "created_at": "2022-12-29T16:27:48Z",
        "body": "@bclozel  Migration guide should also provide a workaround for SpingFlux, not only SpringMVC.\r\nSomething like:\r\n\r\n```java\r\n@Configuration\r\nclass WebConfiguration implements WebFluxConfigurer {\r\n\r\n    @Override\r\n    public void configurePathMatching(PathMatchConfigurer configurer) {\r\n        configurer.setUseTrailingSlashMatch(true);\r\n    }\r\n}"
      },
      {
        "author": "philwebb",
        "created_at": "2022-12-29T18:54:11Z",
        "body": "@kdebski85 Thanks for the suggestions, I've updated the wiki."
      },
      {
        "author": "kdebski85",
        "created_at": "2022-12-30T09:05:57Z",
        "body": "@philwebb I found that the workaround with WebFluxConfigurer does not work when `authorizeExchange` with `pathMatchers` is used.\r\nI created https://github.com/spring-projects/spring-framework/issues/29755 for this issue."
      },
      {
        "author": "lpandzic",
        "created_at": "2023-01-31T12:53:52Z",
        "body": "This seems pretty problematic to me on a grander scale of things.\r\nConsider that many Spring Boot applications are in fact APIs served to many different customers over which the API developer has very little, if any, control over.\r\nSince this worked before Spring Boot 3 if any of those customers used legacy behavior suddenly application developer is in a impossible situation where he's essentially forced to support this legacy behavior indefinitely. I'm saying indefinitely because I find it highly unlikely anyone will be able to convince all of their customers  to fix it in their code for what seems to be for superficial or puristic reasons.\r\n\r\nNow I'm not necessarily against this  change, I just expect Spring Framework teams will get a lot of flak for this because of the situation explained above. It puts developers into an impossible situation which can be hard to detect at first and cause a lot of frustration.\r\n\r\nAt Infobip I know where to fix this for all our public API's without duplicating this change all over our codebase, but I'm not sure everyone will be that lucky."
      },
      {
        "author": "dkoding",
        "created_at": "2023-02-22T08:16:27Z",
        "body": "This brilliant move just cost our teams hundreds of man-hours. So thanks for that."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "d96b4a046342a5d886eeb967c05f8b7f95b6dfb1",
        "4bff95a18017b7a9f603315c606e8f31e74bd658",
        "0098f2931adaa919ddfe66eda2ef620036e7044a",
        "b312eca39177cf9bd588c52c3b56ca42b4f75271",
        "a81ba68da19efc6f09fe70497f4cf5d4d6c3b190",
        "93b343fbd605d05e3b209bd69f011022eccf72ec"
      ]
    }
  },
  {
    "number": 28555,
    "title": "Introduce RuntimeHints predicates utilities",
    "state": "closed",
    "created_at": "2022-06-02T12:37:34Z",
    "updated_at": "2022-06-10T17:38:18Z",
    "author": "bclozel",
    "url": "https://github.com/spring-projects/spring-framework/issues/28555",
    "body": "The new `RuntimeHints` API allows to describe hints for the reflection/proxies/resources needs at runtime.\r\nThe problem is, a single invocation at runtime can be covered by multiple, different hints.\r\n\r\nFor example, reflection introspection on the `myMethod` method for the class `MyClass` can be covered by any of:\r\n\r\n* `MemberCategory.INTROSPECT_PUBLIC_METHODS` if `myMethod` is public\r\n* `MemberCategory.INVOKE_PUBLIC_METHODS` if `myMethod` is public\r\n* `MemberCategory.INTROSPECT_DECLARED_METHODS` in all cases\r\n* `MemberCategory.INVOKE_DECLARED_METHODS` in all cases\r\n* a specific introspection or invokation reflection entry for `MyClass::myMethod`\r\n\r\nBecause of the knowledge required for checking if registered hints are enough for a particular use case, we should introduce `Predicate<RuntimeHints>` static utilities to be used in tests and in #27981 ",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "7f7f458a5977ad51f6ba7cfbb3440e33b754d60b",
        "15b69a3edec7a7f1dc166e3f07fa4b1cb54b0df9",
        "9c9b2356cec4a74c685320c5b8b1b6eb283f9dc0"
      ]
    }
  },
  {
    "number": 28556,
    "title": "Simplify SourceFileAssert assertion methods",
    "state": "closed",
    "created_at": "2022-06-03T00:24:38Z",
    "updated_at": "2022-06-03T01:09:19Z",
    "author": "philwebb",
    "url": "https://github.com/spring-projects/spring-framework/issues/28556",
    "body": "The `SourceFileAssert` class offers a lot of assertions that we ended up not using. We should remove them before the module is made public. This will also help keep qdox as an implementation detail that we could possibly remove later.",
    "labels": [
      "type: task",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "74caa9213a44e2b613025b2387d41389c9344953"
      ]
    }
  },
  {
    "number": 28557,
    "title": "Allow BeanRegistrationAotContributions to provide BeanRegistrationCodeFragments customization",
    "state": "closed",
    "created_at": "2022-06-03T00:30:35Z",
    "updated_at": "2022-06-03T01:09:20Z",
    "author": "philwebb",
    "url": "https://github.com/spring-projects/spring-framework/issues/28557",
    "body": "Currently only `BeanRegistrationCodeFragmentsCustomizer` can be used to customize `BeanRegistrationCodeFragments` but for parent/child context support we'd like to be able to apply customization directly from a `BeanRegistrationAotContribution`.\r\n\r\nMaking such a change should also allow us to from the `BeanRegistrationCodeFragmentsCustomizer` entirely since the same functionality could be achieved using the existing `BeanRegistrationAotProcessor` interface.",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "8d79ec0b67972f3bcd253b046c18fe22bc13d33a",
        "305055d6b1a42c7795891b7b389936ed80270505"
      ]
    }
  },
  {
    "number": 28558,
    "title": "Publish spring-core-test module",
    "state": "closed",
    "created_at": "2022-06-03T00:55:45Z",
    "updated_at": "2022-06-03T01:09:20Z",
    "author": "philwebb",
    "url": "https://github.com/spring-projects/spring-framework/issues/28558",
    "body": "Spring Boot now need to use the TestCompiler class so we should publish the module.",
    "labels": [
      "type: task",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "3ebdaeabd3b40bdfe197b4b2ee3f514906ac936e"
      ]
    }
  },
  {
    "number": 28561,
    "title": "ScopedProxyBeanRegistrationAotProcessor is never called",
    "state": "closed",
    "created_at": "2022-06-03T12:12:18Z",
    "updated_at": "2022-06-03T12:36:39Z",
    "author": "snicoll",
    "url": "https://github.com/spring-projects/spring-framework/issues/28561",
    "body": "The entry in `aot.factories` is pointing to a non existing factory class. This means that the processor is never called and scoped proxy handling does not work.",
    "labels": [
      "type: bug",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "3aefa88d3cb2f957f73a8fedd287f0f90c97df8e",
        "176ea5e9a7a04a81d76130c795d7597f0fc1de75"
      ]
    }
  },
  {
    "number": 28562,
    "title": "Stop initializing DataSize at build time for GraalVM",
    "state": "closed",
    "created_at": "2022-06-03T14:39:08Z",
    "updated_at": "2022-06-03T14:52:23Z",
    "author": "sbrannen",
    "url": "https://github.com/spring-projects/spring-framework/issues/28562",
    "body": "## Overview\r\n\r\nIn light of #28560, we can now revert the change made in #28328.\r\n\r\n## Related Issues\r\n\r\n- #28560\r\n- #28328\r\n- https://github.com/oracle/graal/issues/4489\r\n",
    "labels": [
      "type: task",
      "in: core"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "92f8ab774f6616a2c47b91ec74a95f96c596b954"
      ]
    }
  },
  {
    "number": 28563,
    "title": "Use a single `--initialize-at-build-time` parameter per file",
    "state": "closed",
    "created_at": "2022-06-03T15:38:43Z",
    "updated_at": "2022-06-03T15:41:09Z",
    "author": "sdeleuze",
    "url": "https://github.com/spring-projects/spring-framework/issues/28563",
    "body": "`native-image.properties` supports specifying a single `--initialize-at-build-time` parameter with multiple packages separated with `,`. This issue intend to use this capability since:\r\n - This is usually the recommended way to specify multiple packages.\r\n - This is consistent with the generated configuration.\r\n - It allows to group per module `--initialize-at-build-time` when passed to the `native-image` command.",
    "labels": [
      "type: task",
      "in: core"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "74c49c510a3e9bd8a7ec193e5ad33c3b75afbef3"
      ]
    }
  },
  {
    "number": 28565,
    "title": "Allow ApplicationContextAotGenerator to generated better class names",
    "state": "closed",
    "created_at": "2022-06-04T01:12:55Z",
    "updated_at": "2022-06-07T16:59:50Z",
    "author": "philwebb",
    "url": "https://github.com/spring-projects/spring-framework/issues/28565",
    "body": "Currently `ApplicationContextAotGenerator` always generates a `__.BeanFactoryRegistrations` class. For context hierarchy support we're going to need multiple registration classes so we should use different names. We'd also like to be able to provide a target class so that we can use a package other than `__`.",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [
      {
        "author": "snicoll",
        "created_at": "2022-06-07T14:13:56Z",
        "body": "The default classname is still generated in that `__` package. Is that expected? I was under the impression that this issue would move it at the same level as the application class itself."
      },
      {
        "author": "philwebb",
        "created_at": "2022-06-07T16:59:50Z",
        "body": "We'll need to make some updates on the Boot side to pass the target in."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "172102d225c916e2ca24b87aa0f0a74d824815b2",
        "4bd33cb6e0659df2cd0b9fa04feea8fd77e5a16d"
      ]
    }
  },
  {
    "number": 28567,
    "title": "Introduce attribute support in Kotlin RouterFunction DSL",
    "state": "closed",
    "created_at": "2022-06-05T10:47:07Z",
    "updated_at": "2022-06-08T15:10:03Z",
    "author": "christophejan",
    "url": "https://github.com/spring-projects/spring-framework/issues/28567",
    "body": "On current spring framework version (5.3.19), RouterFunction **attributes** are **not supported** by RouterFunction Kotlin **DSL**.\r\n<br />\r\n\r\nRouterFunction attributes is currently supported by Java Builder :\r\n- https://github.com/spring-projects/spring-framework/blob/172102d225c916e2ca24b87aa0f0a74d824815b2/spring-webflux/src/main/java/org/springframework/web/reactive/function/server/RouterFunctionBuilder.java#L335\r\n- https://github.com/spring-projects/spring-framework/blob/172102d225c916e2ca24b87aa0f0a74d824815b2/spring-webflux/src/main/java/org/springframework/web/reactive/function/server/RouterFunctionBuilder.java#L350\r\n- https://github.com/spring-projects/spring-framework/blob/172102d225c916e2ca24b87aa0f0a74d824815b2/spring-webmvc/src/main/java/org/springframework/web/servlet/function/RouterFunctionBuilder.java#L328\r\n- https://github.com/spring-projects/spring-framework/blob/172102d225c916e2ca24b87aa0f0a74d824815b2/spring-webmvc/src/main/java/org/springframework/web/servlet/function/RouterFunctionBuilder.java#L343\r\n<br />\r\n\r\nBut RouterFunction attributes support is missing from all Kotlin DSL :\r\n- https://github.com/spring-projects/spring-framework/blob/172102d225c916e2ca24b87aa0f0a74d824815b2/spring-webflux/src/main/kotlin/org/springframework/web/reactive/function/server/RouterFunctionDsl.kt#L65\r\n- https://github.com/spring-projects/spring-framework/blob/172102d225c916e2ca24b87aa0f0a74d824815b2/spring-webflux/src/main/kotlin/org/springframework/web/reactive/function/server/CoRouterFunctionDsl.kt#L66\r\n- https://github.com/spring-projects/spring-framework/blob/172102d225c916e2ca24b87aa0f0a74d824815b2/spring-webmvc/src/main/kotlin/org/springframework/web/servlet/function/RouterFunctionDsl.kt#L62\r\n",
    "labels": [
      "in: web",
      "type: enhancement",
      "theme: kotlin"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "cc1717871f4475459cebc1f39d5167a7af43abb5",
        "bbabf8d855cc8d48757bdc86f2f2c426a7438f0a",
        "283bc9ede936bd41b68ad2ee7fe00047d5550b93"
      ]
    }
  },
  {
    "number": 28570,
    "title": "BeanDefinitionPropertiesCodeGenerator should filter single inferred init/destroy method",
    "state": "closed",
    "created_at": "2022-06-05T23:12:42Z",
    "updated_at": "2022-06-05T23:16:26Z",
    "author": "philwebb",
    "url": "https://github.com/spring-projects/spring-framework/issues/28570",
    "body": "`BeanDefinitionPropertiesCodeGenerator` currently generates `setInitMethodNames()/setDestroyMethodNames()` methods with not parameters if only a single `AbstractBeanDefinition.INFER_METHOD` method is specified. Although this is harmless, it doesn't look great so we should just not add the statement.",
    "labels": [
      "type: task",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "9a9c3ea00e2a955c06452d1e28d092594cca53a8"
      ]
    }
  },
  {
    "number": 28574,
    "title": "CompileWithTargetClassAccessClassLoader does not implement findResource",
    "state": "closed",
    "created_at": "2022-06-06T19:30:00Z",
    "updated_at": "2022-06-06T19:31:19Z",
    "author": "philwebb",
    "url": "https://github.com/spring-projects/spring-framework/issues/28574",
    "body": "The `CompileWithTargetClassAccessClassLoader` implements `findResources` but missed `findResource`.",
    "labels": [
      "type: bug",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "26944f3c8ef2f1d5e2a45ab0081556382e90e960"
      ]
    }
  },
  {
    "number": 28578,
    "title": "BeanRegistrationCodeFragments sets a non-nullable field to null",
    "state": "closed",
    "created_at": "2022-06-07T09:36:17Z",
    "updated_at": "2022-06-07T17:11:14Z",
    "author": "snicoll",
    "url": "https://github.com/spring-projects/spring-framework/issues/28578",
    "body": "There is a strange arrangement in `BeanRegistrationCodeFragments` where a package private constructor sets a non-null field to `null`. Making the field nullable doesn't help as it's used in all methods implemented by that class. ",
    "labels": [
      "type: task",
      "theme: aot"
    ],
    "comments": [
      {
        "author": "snicoll",
        "created_at": "2022-06-07T09:39:37Z",
        "body": "cc @philwebb "
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "c01a2e897d410efbcbaef36ffd0f56208e276970"
      ]
    }
  },
  {
    "number": 28580,
    "title": "Allow @CompileWithTargetClassAccess to work with all classes",
    "state": "closed",
    "created_at": "2022-06-07T21:07:27Z",
    "updated_at": "2022-06-07T21:13:46Z",
    "author": "philwebb",
    "url": "https://github.com/spring-projects/spring-framework/issues/28580",
    "body": "Currently `@CompileWithTargetClassAccess` works by using `MethodHandles.privateLookupIn` and having target classes listed on the annotation. This is quite error prone and makes it impossible to have target access if the there isn't a class in the same package available.\r\n\r\nWe can probably get away with a reflection approach instead which will simplify a lot of tests.",
    "labels": [
      "type: task",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "46a2f2d71ce0c1687f289c01746e808f61b140d5",
        "7119d420cece91ca810ce917ac9ade6853169fde"
      ]
    }
  },
  {
    "number": 28582,
    "title": "Add support for annotation processors with TestCompiler",
    "state": "closed",
    "created_at": "2022-06-07T23:53:18Z",
    "updated_at": "2022-06-07T23:54:21Z",
    "author": "philwebb",
    "url": "https://github.com/spring-projects/spring-framework/issues/28582",
    "body": "See https://github.com/spring-projects/spring-boot/issues/31266 for background.\r\n",
    "labels": [
      "type: task",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "45ef21f900baa4dcad269100553818d4839b8cfb"
      ]
    }
  },
  {
    "number": 28585,
    "title": "Rationalize naming strategy in ApplicationContextAotGenerator",
    "state": "closed",
    "created_at": "2022-06-08T12:31:00Z",
    "updated_at": "2022-06-23T14:28:52Z",
    "author": "snicoll",
    "url": "https://github.com/spring-projects/spring-framework/issues/28585",
    "body": "`ApplicationContextAotGenerator` uses a `GenerationContext` to analyze an `ApplicationContext`. The generation context provides the necessary infrastructure to generate \"files\" (i.e. source code and resources). It's part of `spring-core`.\r\n\r\nAs part of this analysis, an `ApplicationContextInitializer` is generated and serves as the entry point for running an optimized version of the specified `ApplicationContext` at runtime. Additional files may be generated and needs extra help in terms of naming conventions.\r\n\r\nThe current API has a `ClassName` for the `ApplicationContextInitializer` as well as a target `Class` and a `name` for naming conventions purposes. I think that, at the very least, we should gather these in some sort of naming conventions strategy. Because we need to get a reference to the initializer classname, we could return something rather than `void`.\r\n\r\nThere is the use case that `ApplicationContextGenerator` is called for dedicated contexts (such as the management context in Spring Boot). In this case we want to pass along the `GenerationContext` so that it records all resources/files in a single place and an updated naming strategy.\r\n\r\n",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [
      {
        "author": "snicoll",
        "created_at": "2022-06-09T05:51:54Z",
        "body": "Another example is the `getAotProcessor` on `AotProcessor` that's used by the [management context stuff](https://github.com/spring-projects/spring-boot/blob/c56783064de907283e8f4c6fd04e4489682f9a9b/spring-boot-project/spring-boot-actuator-autoconfigure/src/main/java/org/springframework/boot/actuate/autoconfigure/web/server/ChildManagementContextInitializer.java#L99) in Spring Boot to only get the target application."
      },
      {
        "author": "snicoll",
        "created_at": "2022-06-17T13:23:36Z",
        "body": "We've discussed passing the `target/name` pair as constructor arguments of `ApplicationContextGenerator`. I don't think that works as we'd still need to get those values somehow and that would leave what we have in `AotProcessor`.\r\n\r\nhttps://github.com/snicoll/spring-framework/commit/88428edb3dd47891adc962d1efbfd44b223f6b98 is an attempt at making the naming strategy a separate, third argument. In short `BeanFactoryNamingConvention` hides the `target/name` pair and offer a way to generate class names for the bean factory at hand. The default implementation delegates to `ClassNameGenerator` (although the contract does not specify it strictly, which is a problem as it is a stateful thing).\r\n\r\nExperimenting with this reveals several interesting things:\r\n\r\n* Tests don't really care what the name of the entry point is as they rely on the fact that the first thing (initializer) that registers a class is the entry point.\r\n* Returning the initializer class name rather than passing it works really well (and the implementation is in control over the name like all the other ones)\r\n* That `Class<?> target` and `String name` can be abstracted behind a strategy interface except for [one use case](https://github.com/snicoll/spring-framework/blob/88428edb3dd47891adc962d1efbfd44b223f6b98/spring-beans/src/main/java/org/springframework/beans/factory/aot/BeanRegistrationsAotContribution.java#L68-L69). The naming strategy returning the bean factory name is a little odd as a result.\r\n\r\nThis works relatively nicely up to a point where we need to process another context as part of processing the context of the application. When this happens, the only reliable callback we have is `GenerationContext`. We don't have the third argument anymore (the naming convention) so we're stuffed.\r\n\r\n`GenerationContext` already has `ClassNameGenerator`. We could update `GeneratingContext` to provide a higher level class that encapsulates this + the naming convention for the bean factory. If we do that, we need to be able to change the naming convention when processing a child context, and yet keeping the current created objects so that clashes are identified properly.\r\n\r\nSpring Native had a `fork` option on the context where the naming convention can be changed. I never really liked the name but everything seems to point in the direction of some sort of feature like that."
      },
      {
        "author": "snicoll",
        "created_at": "2022-06-20T08:58:33Z",
        "body": "I also believe that tightening this will help us remove the AOT package name (`__`) altogether. #28585 is related."
      },
      {
        "author": "snicoll",
        "created_at": "2022-06-21T06:18:05Z",
        "body": "Another thing to note is that the \"name\" uniqueness is not enforced upfront. If you try to generate multiple contexts with the name `Test`, you'd end up with `__TestBeanDefinitions` and `TestBeanDefinitions1` rather than `__TestBeanDefinitions` and `Test1BeanDefinitions` .\r\n\r\nThis goes in the direction again of the  context being in charge of the registered names and their uniqueness. Unfortunately `GenerationContext` is in `spring-core` and does not know anything about the bean factory."
      },
      {
        "author": "snicoll",
        "created_at": "2022-06-21T07:43:35Z",
        "body": "Yet another thing. If we process multiple contexts against the same bean, and that bean requires autowiring, then we invoke multiple times `AutowiredAnnotationBeanPostProcessor` which leads to the same file being created multiple times with the same name.\r\n\r\nThe original design had the idea of registering that a processor already ran. Right now, it's not obvious to me what is \"static\" and what is bean factory specific (and therefore should be qualified)."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "fe39598e81e01710f709b001342b62606422fb5b",
        "6199835d6ea791a7f74a8e98f1a2a08c17014aef",
        "88428edb3dd47891adc962d1efbfd44b223f6b98"
      ]
    }
  },
  {
    "number": 28588,
    "title": "JdkHttpClientResourceFactory has dependency  on org.eclipse.jetty",
    "state": "closed",
    "created_at": "2022-06-08T19:12:44Z",
    "updated_at": "2022-06-14T09:01:30Z",
    "author": "j3graham",
    "url": "https://github.com/spring-projects/spring-framework/issues/28588",
    "body": "in spring-web, `org.springframework.http.client.reactive.JdkHttpClientResourceFactory` makes use of the jetty LifeCycle class.\r\n\r\nIt would be good to be able to use JdkHttpClientResourceFactory with no extra dependencies.\r\n\r\nThis is in v 6.0",
    "labels": [
      "in: web",
      "type: bug"
    ],
    "comments": [
      {
        "author": "poutsma",
        "created_at": "2022-06-13T14:06:36Z",
        "body": "@rstoyanchev was the usage of Jetty's `LifeCycle` type in `JdkHttpClientResourceFactory` intentional? I think it can be replaced with a check for `ExecutorService` in `destroy()`, and call `ExecutorService::shutdown` if so."
      },
      {
        "author": "rstoyanchev",
        "created_at": "2022-06-13T15:37:25Z",
        "body": "No, it's most certainly an oversight."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "1881e48bb4f5643a0dbdfa6f24a5e0fb055274f6"
      ]
    }
  },
  {
    "number": 28594,
    "title": "Support that the same RuntimeHintsRegistrar can be specified multiple times and invoked only once",
    "state": "closed",
    "created_at": "2022-06-09T09:17:04Z",
    "updated_at": "2022-06-09T13:03:49Z",
    "author": "snicoll",
    "url": "https://github.com/spring-projects/spring-framework/issues/28594",
    "body": "Given the conditional nature of `@ImportRutimeHints`, we should make sure that several classes can defined it with the same processor and that doesn't mean it is invoked multiple times.\r\n\r\nThe javadoc should be updated accordingly?",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "363722893b2dcb65a29eac01007bd45ac0b3563c"
      ]
    }
  },
  {
    "number": 28597,
    "title": "Fix `ResourceHintsWriter` for leading/trailing wildcards",
    "state": "closed",
    "created_at": "2022-06-09T12:30:19Z",
    "updated_at": "2022-06-09T12:51:41Z",
    "author": "sdeleuze",
    "url": "https://github.com/spring-projects/spring-framework/issues/28597",
    "body": "While working on spring-projects/spring-boot#31278 with @snicoll we found that specifying `static/*` resource pattern was not working as expected for example.",
    "labels": [
      "type: bug"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "1734debca1fae01f9a9851b9ac93d5a166c8f63a",
        "99ffd97a72ec6a85d8606bdc069e8073a4792642",
        "26ea97843bf95f41366851572ffff3e8b893410c"
      ]
    }
  },
  {
    "number": 28598,
    "title": "Improve `ResourcePatternHint` documentation",
    "state": "closed",
    "created_at": "2022-06-09T12:32:49Z",
    "updated_at": "2022-06-09T12:51:42Z",
    "author": "sdeleuze",
    "url": "https://github.com/spring-projects/spring-framework/issues/28598",
    "body": "Also add a link to this documentation to the various usages Javadoc.",
    "labels": [
      "type: documentation"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "5dfc79fc6e5a00184e9430d57174fb7cc1c7e3fb",
        "b9f85627a17a55270d5ba3d3b6e7b7d267ba8817",
        "7302e6d54b55de2e0be77040e3e03ca53a7c9a01"
      ]
    }
  },
  {
    "number": 28600,
    "title": "Remove obsolete references to @Required",
    "state": "closed",
    "created_at": "2022-06-09T12:51:41Z",
    "updated_at": "2022-06-09T12:54:59Z",
    "author": "sbrannen",
    "url": "https://github.com/spring-projects/spring-framework/issues/28600",
    "body": "`@Required` was removed in a previous 6.0 milestone.",
    "labels": [
      "type: documentation"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "74d1be9bd83eb5a3a1b1362e75b0fae511356375"
      ]
    }
  },
  {
    "number": 28606,
    "title": "Reflection configuration for parameter types with an inner class have wrong name",
    "state": "closed",
    "created_at": "2022-06-10T13:15:52Z",
    "updated_at": "2022-06-10T13:33:00Z",
    "author": "snicoll",
    "url": "https://github.com/spring-projects/spring-framework/issues/28606",
    "body": "",
    "labels": [
      "type: bug",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "100ce9642afb14b806e42ae9277f77171a7bc04c"
      ]
    }
  },
  {
    "number": 28607,
    "title": "Use PathPatternParser by default in Spring MVC",
    "state": "closed",
    "created_at": "2022-06-10T14:18:07Z",
    "updated_at": "2022-06-29T10:07:30Z",
    "author": "rstoyanchev",
    "url": "https://github.com/spring-projects/spring-framework/issues/28607",
    "body": "`PathPatternParser` was introduced for WebFlux in 5.0 as a replacement for `AntPathMatcher` that uses pre-compiled patterns, supports mapping without decoding the full URL path, and optimizes the pattern syntax for web (vs file system) paths. \r\n\r\nIt has been available for use in Spring MVC since version 5.3 and has been enabled as the default in Spring Boot since version 2.6 with https://github.com/spring-projects/spring-boot/issues/24805.\r\n\r\nThis issue is to consider switching the default in Spring Framework to `PathPatternParser` for 6.0, and potentially deprecate `PathMatcher` and related options.\r\n\r\n\r\n",
    "labels": [
      "in: web",
      "type: enhancement"
    ],
    "comments": [
      {
        "author": "bclozel",
        "created_at": "2022-06-21T08:07:40Z",
        "body": "I think we should do this (including the deprecation) for 6.0."
      },
      {
        "author": "rstoyanchev",
        "created_at": "2022-06-21T09:52:21Z",
        "body": "**Team decision:** we'll go ahead with it and align with the default in Boot. "
      },
      {
        "author": "rstoyanchev",
        "created_at": "2022-06-29T09:32:23Z",
        "body": "Parsed patterns are now enabled by default in Spring MVC. This means, each `HandlerMapping`, or rather every subclass of `AbstractHandlerMapping` has a `PathPatternParser` instance, and that effectively means parsed patterns are used instead of String path matching with `AntPathMatcher`. \r\n\r\nTo minimize unnecessary breakage where intentions are clear, String path matching is still enabled through the MVC config, when either of the following is true:\r\n- `PathPatternParser` is not explicitly set, while `AntPathMatcher` or `UrlPathHelper` related options are customized.\r\n- `PathPatternParser` is explicitly set to `null`.\r\n\r\nFurther steps have also been taken to minimize failures in existing tests. For example the URL path is parsed per handler lookup if not called by the `DispacherServlet`, which pre-parses and caches the path. Likewise, `MockHttpServletRequest` detects a Servlet path mapping, to ensure a Servlet path prefix is taken into account.\r\n\r\n\r\n"
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "8a9b082d8a0f84e7b72416e57e9b6a7a9321567e",
        "92cf1e13e8770aae306886555ed8210d95464d46",
        "14fd2605a39462f7ae3d0377aac249a171908a91"
      ]
    }
  },
  {
    "number": 28614,
    "title": "Register native hints for jakarta.inject annotations",
    "state": "closed",
    "created_at": "2022-06-13T16:32:41Z",
    "updated_at": "2022-06-13T16:51:14Z",
    "author": "bclozel",
    "url": "https://github.com/spring-projects/spring-framework/issues/28614",
    "body": "As of #28442, core Spring annotations are registered for native hints, including `@Order` and `@AliasFor`.\r\n\r\nSpring optionally supports `jakarta.inject.Inject` and `jakarta.inject.Qualifier`, detecting their presence on the classpath. We should ensure that similar hints are registered if they are present on the classpath during the AOT phase.",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "bb952cb95e37404b3f5b0eb8d7a659a3eeeddab0",
        "7e8b1ed40181ca224a62b8bed8c3e1911c66f9ad"
      ]
    }
  },
  {
    "number": 28617,
    "title": "Add ifPresent utility methods on RuntimeHints",
    "state": "closed",
    "created_at": "2022-06-14T09:01:02Z",
    "updated_at": "2022-06-14T12:15:44Z",
    "author": "snicoll",
    "url": "https://github.com/spring-projects/spring-framework/issues/28617",
    "body": "Based on concrete usage of the API, it looks like a `registerIfPresent` would be a nice addition to the API. This makes sure hints aren't contributed for things that aren't available.",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "d6d4b98780132fff58ba610d2cde53419d32ce4a"
      ]
    }
  },
  {
    "number": 28618,
    "title": "Remove support for cyclic annotation parameter types in Kotlin",
    "state": "closed",
    "created_at": "2022-06-14T10:41:31Z",
    "updated_at": "2022-06-14T11:14:33Z",
    "author": "poutsma",
    "url": "https://github.com/spring-projects/spring-framework/issues/28618",
    "body": "#28012 introduced support for cyclic annotation parameter types in Kotlin. However, in Kotlin 1.7 the compiler gives a warning for these cyclic parameters, which will turn into an error in Kotlin 1.9. See [KT-47932](https://youtrack.jetbrains.com/issue/KT-47932).\r\n\r\nWe could theoretically keep supporting cyclic annotation parameters, but by this point it is clear that this feature was never intended to be there. So removal seems better.\r\n\r\nEffectively, this would mean reverting https://github.com/spring-projects/spring-framework/commit/3ec612aaf8611d2ad6e6f7f3d5868feee5024477 and https://github.com/spring-projects/spring-framework/commit/3188c0f7db54cffdb95e7127e2adde959dd078f9.",
    "labels": [
      "type: task",
      "in: core",
      "theme: kotlin"
    ],
    "comments": [
      {
        "author": "poutsma",
        "created_at": "2022-06-14T11:14:32Z",
        "body": "Resolved in https://github.com/spring-projects/spring-framework/commit/bf9f261b9512a3d0f84844dfa75943a231ed5a87"
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "6a7a0bddb749cbc8d716d4aee3d10ff88e4793eb"
      ]
    }
  },
  {
    "number": 28619,
    "title": "Upgrade to Kotlin 1.7.0",
    "state": "closed",
    "created_at": "2022-06-14T10:42:28Z",
    "updated_at": "2022-06-14T15:22:03Z",
    "author": "poutsma",
    "url": "https://github.com/spring-projects/spring-framework/issues/28619",
    "body": "This will means dropping (support for) cyclic annotation type parameters, see #28618.",
    "labels": [
      "type: dependency-upgrade"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "4658b3fdb909b33ea39ca7f3beb830ecad2387f9"
      ]
    }
  },
  {
    "number": 28620,
    "title": "Introduce ResourcePatternHint#toRegex",
    "state": "closed",
    "created_at": "2022-06-14T12:55:47Z",
    "updated_at": "2022-06-14T13:08:17Z",
    "author": "sdeleuze",
    "url": "https://github.com/spring-projects/spring-framework/issues/28620",
    "body": "This change is done for several reasons:\r\n - Move the logic where it is documented.\r\n - Test it with `ResourcePatternHintTests`.\r\n - Allow `RuntimeHintsPredicates` to leverage this logic.",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "c235ad0b35c1df24eb2da8df31566e839cfd19c3",
        "0c0123823dcffc7d74eae931c38be84bad375a5d",
        "532bca2968c46a0f495f2f0fb6dcecd8f40c10b8",
        "7f7f458a5977ad51f6ba7cfbb3440e33b754d60b"
      ]
    }
  },
  {
    "number": 28622,
    "title": "Add reflection hints for `HttpEntity` used in Web controllers",
    "state": "closed",
    "created_at": "2022-06-14T13:37:40Z",
    "updated_at": "2022-06-20T16:16:25Z",
    "author": "sdeleuze",
    "url": "https://github.com/spring-projects/spring-framework/issues/28622",
    "body": "Follow-up of #28518.",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "be28563621c7a1783f53633b4848fcfc4da0aea9",
        "93b340e5633d623e0899dd296bda7ce86ce02b20"
      ]
    }
  },
  {
    "number": 28623,
    "title": "Add reflection hints for data binding in Web controllers",
    "state": "closed",
    "created_at": "2022-06-14T13:40:00Z",
    "updated_at": "2022-07-11T09:44:49Z",
    "author": "sdeleuze",
    "url": "https://github.com/spring-projects/spring-framework/issues/28623",
    "body": "Follow-up of #28518.",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "9d42779826b84fc5e4060c3b14287c33eef72835",
        "13888f38d0f3b44354e8dad4283c78bf0a43c281"
      ]
    }
  },
  {
    "number": 28624,
    "title": "Replace build-time initialization by constant field evaluation at build-time",
    "state": "closed",
    "created_at": "2022-06-14T14:03:33Z",
    "updated_at": "2022-06-24T11:56:52Z",
    "author": "sdeleuze",
    "url": "https://github.com/spring-projects/spring-framework/issues/28624",
    "body": "In order to compile to native images and to provide a reasonable footprint, we are currently forced to initialize classes containing `ClassUtils#isPresent` checks at build time. A meaningful concrete example of that requirement is provided by Spring MVC support that does not compile unless a few classes are initialized at build time, see 2b76a12b86a62cc46886e1b7f0e52ea9d256f899.\r\n\r\nThe drawback is that this build time init of `WebMvcConfigurationSupport` and `RestTemplate` forces to initialize transitively all classes used in static fields/blocks at build time as well : `ClassUtils`, `SpringProperties`, `ConcurrentReferenceHashMap`. Worse : for other classes with similar pattern, if they contain a static loggers, this will force to initialize Logback at build time which is a dead end in term of compatibility as shown multiple times in Spring Native.\r\n\r\nWe are working on a middle-long term solution with GraalVM to replace build time init by another mechanism, less viral, with less compatibility issues. But for time being, we need to find a solution to this issue.\r\n\r\nA pragmatic solution would be isolate classpath checks in a per module (`spring-core`, `spring-web`) class that would be itself init at build time but with no other purpose, removing the risk of viral expension of the classes init at build time. If we take the `WebMvcConfigurationSupport` use case, we would have something like:\r\n\r\n```java\r\npublic abstract class ClasspathUtils {\r\n\r\n    private static final boolean romePresent;\r\n    private static final boolean jaxb2Present;\r\n    private static final boolean jackson2Present;\r\n\r\n    static {\r\n        // ...\r\n    }\r\n\r\n    public static boolean isRomePresent() { ... }\r\n    public static boolean isJaxb2Present() { ... }\r\n    public static boolean isJackson2Present() { ... }\r\n    // ...\r\n}\r\n```\r\nBonus point, I think I like the fact that we provide reusable methods for classpath checks without arbitrary `String` parameter.\r\nImplementation would potentially even not use `ClassUtils` to limit the classes init at build time (not sure what is would use instead, to be discussed, not a blocking point).\r\n\r\nAny thoughts @jhoeller @snicoll @bclozel?",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [
      {
        "author": "philwebb",
        "created_at": "2022-06-14T15:10:56Z",
        "body": "Perhaps the `@Constant` annotation from this branch that we discussed in the past might help? https://github.com/philwebb/scratch-graal-conditions/tree/annotations"
      },
      {
        "author": "sdeleuze",
        "created_at": "2022-06-21T13:24:50Z",
        "body": "@philwebb Could you please confirm that [this build time initialization of classes](https://github.com/philwebb/scratch-graal-conditions/blob/annotations/src/main/java/gce/graalvm/ConstantFeature.java#L48) is just required for class level `@Constant` not for field level ones?"
      },
      {
        "author": "philwebb",
        "created_at": "2022-06-21T18:42:17Z",
        "body": "@sdeleuze correct, that's just for class-level use."
      },
      {
        "author": "sdeleuze",
        "created_at": "2022-06-22T10:29:08Z",
        "body": "Good news, I have been able to leverage the updated `@Constant` experiment to remove totally build time initialization from Spring Framework 6 (can be used for portfolio projects and Boot as well) while keeping the same benefits in term of build time code removal, see [this related WIP branch](https://github.com/sdeleuze/spring-framework/tree/gh-28624). Thanks a lot @philwebb!\r\n\r\nAs soon as GraalVM team provides a builtin solution via the working group @bclozel and I have joined, it would replace this GraalVM feature. That's why I have preferred not introducing a new annotation like `@Constant` but just target a set of patterns. Since we don't have a real idea of the timeframe, I think the GraalVM feature provide a reasonable path for this transition period."
      },
      {
        "author": "sdeleuze",
        "created_at": "2022-06-24T09:44:37Z",
        "body": "https://github.com/sdeleuze/build-time-constant-fields allows to test it works as expected. Not sure yet if/how we should integrate that in the CI, but probably good enough for this milestone to have such side repository to test the behavior.\r\n\r\nLogs printed during the native build allow to identify which fields are set to a constant value at build time."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "b9acbf3bebb977cd7e213e9621820edf8c6c62a1",
        "b5892940df9fe0d1ce269f7dc093e49938736bf8",
        "3f65686aaa2d1087900cb5f38c1aee0fe5b01879",
        "48d634ae4e78e1a7788acb5118991eba06587fb5"
      ]
    }
  },
  {
    "number": 28625,
    "title": "Set Kotlin language version to 1.7",
    "state": "closed",
    "created_at": "2022-06-14T15:14:05Z",
    "updated_at": "2022-06-15T08:56:43Z",
    "author": "poutsma",
    "url": "https://github.com/spring-projects/spring-framework/issues/28625",
    "body": "We should change the Kotlin language version to 1.7, see [here](https://github.com/spring-projects/spring-framework/blob/933965b7b4b608b7fb6214d25e5c71bbe674cecb/build.gradle#L280-L281). Doing this allows us to upgrade to Kotlin 1.9 within the 6.0.x timeline.",
    "labels": [
      "type: task",
      "theme: kotlin"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "070af5ceb4d410f69b0755abfb639092c4434c93"
      ]
    }
  },
  {
    "number": 28626,
    "title": "Add ResourceHints registrar for classpath patterns",
    "state": "closed",
    "created_at": "2022-06-14T16:10:14Z",
    "updated_at": "2022-06-14T16:19:16Z",
    "author": "snicoll",
    "url": "https://github.com/spring-projects/spring-framework/issues/28626",
    "body": "Having to scan locations is quite common. Rather than implementing that logic multiple times, this issue is about offering a basic implementation that can be customized with file names, locations, and file extensions.",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "ff9535ef15de35217472acd3acd3a62b9ae27a7e"
      ]
    }
  },
  {
    "number": 28635,
    "title": "Add Kotlinx Serialization support to BindingReflectionHintsRegistrar",
    "state": "closed",
    "created_at": "2022-06-15T15:43:11Z",
    "updated_at": "2022-06-15T15:55:02Z",
    "author": "sdeleuze",
    "url": "https://github.com/spring-projects/spring-framework/issues/28635",
    "body": "",
    "labels": [
      "type: enhancement",
      "theme: aot",
      "theme: kotlin"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "4e3393d7ff1d24f20c563386814a4f0d7160b601",
        "c5cf7c0ab034e5921b2717f3a06c9028a6b1420e",
        "2b1f61a587ed6640f62206e42bc04583f45c3ec7",
        "16d6dc36112ae1b0500a31c0848a06fb208d1237"
      ]
    }
  },
  {
    "number": 28641,
    "title": "Upgrade Dokka to 1.7",
    "state": "closed",
    "created_at": "2022-06-16T14:36:30Z",
    "updated_at": "2022-06-24T11:20:29Z",
    "author": "poutsma",
    "url": "https://github.com/spring-projects/spring-framework/issues/28641",
    "body": "",
    "labels": [
      "type: dependency-upgrade"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "dc4ae559c5d8df01f2b7388db827e330b361ffc7"
      ]
    }
  },
  {
    "number": 28655,
    "title": "Add automatic hint for autowired field support",
    "state": "closed",
    "created_at": "2022-06-19T08:47:09Z",
    "updated_at": "2022-06-20T09:25:54Z",
    "author": "snicoll",
    "url": "https://github.com/spring-projects/spring-framework/issues/28655",
    "body": "If a field is flagged with `@Autowired` the container uses reflection to set the value. A hint should have been generated automatically for this but it looks like that's not the case at the moment.",
    "labels": [
      "type: regression",
      "theme: aot"
    ],
    "comments": [
      {
        "author": "snicoll",
        "created_at": "2022-06-19T08:58:58Z",
        "body": "This is a regression of a refactoring. We used to [flag a field regardless of its visibility](https://github.com/spring-projects/spring-framework/blob/4fe1eaddecaabb41b9fad3c7c5af786b9a68ab83/spring-beans/src/main/java/org/springframework/beans/factory/annotation/AutowiredAnnotationBeanPostProcessor.java#L863) and that is no longer the case."
      },
      {
        "author": "snicoll",
        "created_at": "2022-06-19T09:06:30Z",
        "body": "A bit frustrating as the tests that were validating hints have been contributed have been dropped apparently."
      },
      {
        "author": "snicoll",
        "created_at": "2022-06-20T09:25:54Z",
        "body": "Even more frustrating when I realize I was the one saying the hints was wrong in a review document ðŸ™„"
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "365481379d8e331214118a9dc930fb5f201ef8cc"
      ]
    }
  },
  {
    "number": 28659,
    "title": "Move Mock duplicates to test fixtures",
    "state": "closed",
    "created_at": "2022-06-20T06:12:19Z",
    "updated_at": "2022-06-20T06:57:51Z",
    "author": "snicoll",
    "url": "https://github.com/spring-projects/spring-framework/issues/28659",
    "body": "The AOT tests are relying on mock implementations that are duplicated in the codebase. We should rationalize those in test fixtures instread as it makes it hard to change an interface that those duplicated mocks implement.",
    "labels": [
      "type: task",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "90759fb38f71b76f36992d3b0a0405fe5aea6f2b"
      ]
    }
  },
  {
    "number": 28665,
    "title": "Allow dynamic properties in ProblemDetail",
    "state": "closed",
    "created_at": "2022-06-20T17:29:42Z",
    "updated_at": "2022-07-12T12:05:40Z",
    "author": "rstoyanchev",
    "url": "https://github.com/spring-projects/spring-framework/issues/28665",
    "body": "There is a need for a generic map of properties in `ProblemDetail` for properties that are not known ahead of time, and cannot be exposed as setters from a subclass. Based on feedback on https://github.com/spring-projects/spring-framework/issues/27052#issuecomment-1140294702 and https://github.com/spring-projects/spring-framework/issues/27052#issuecomment-1141907448,  ",
    "labels": [
      "in: web",
      "type: enhancement"
    ],
    "comments": [
      {
        "author": "vy",
        "created_at": "2022-07-05T21:16:48Z",
        "body": "@rstoyanchev, getting unknown properties mapped to a single field can be tricky for Jackson. Even though this ticket is closed, I would strongly encourage adding tests for checking whether both de- and serialization works as expected."
      },
      {
        "author": "rstoyanchev",
        "created_at": "2022-07-08T13:39:41Z",
        "body": "@vy, happy to re-open and make further updates. That said, from Jackson's perspective, isn't it just a straight-forward `Map` field to serialize and deserialize? In other words, could you clarify the tricky part is you have in mind?"
      },
      {
        "author": "vy",
        "created_at": "2022-07-09T10:22:37Z",
        "body": "I think we have a misunderstanding about the use case here. Let me try to clarify it with an example. Let the server have a `CustomProblemDetail` extending from `ProblemDetail`:\r\n\r\n```java\r\nimport org.springframework.http.ProblemDetail;\r\n\r\npublic class CustomProblemDetail extends ProblemDetail {\r\n\r\n    private final String host;\r\n\r\n    public CustomProblemDetail(ProblemDetail parent, String host) {\r\n        super(parent);\r\n        this.host = host;\r\n    }\r\n\r\n    public void setHost(String host) {\r\n        this.host = host;\r\n    }\r\n\r\n    public String getHost() {\r\n        return this.host;\r\n    }\r\n\r\n}\r\n```\r\n\r\nDue to a service failure, the server responds with a `CustomProblemDetail` and the client receives the following JSON:\r\n\r\n```json\r\n{\r\n  \"type\": \"/problem/bad-request\",\r\n  \"title\": \"Bad Request\",\r\n  \"status\": 400,\r\n  \"detail\": \"miserable failure\",\r\n  \"instance\": \"/greeting\",\r\n  \"host\": \"awesome-x3csd3.bol.com\"\r\n}\r\n```\r\n\r\nNote the extra `host` entry at the bottom.\r\n\r\nSince the client doesn't know about the `CustomProblemDetail` class, it will try to deserialize this JSON to a `ProblemDetail`. It would expect `ProblemDetail#properties` to contain a single entry: `host=awesome-x3csd3.bol.com`, though it won't since we didn't use any `@JsonAnyGetter`, `@JsonAnySetter`, etc. magic there. Hence the `host` information get totally lost during deserialization and this should exactly be the goal this feature aims to prevent."
      },
      {
        "author": "rstoyanchev",
        "created_at": "2022-07-11T10:16:28Z",
        "body": "Thanks for clarifying.\r\n\r\nThe goal is to avoid dependency on any serialization technology at the lowest level. `ProblemDetail` is the basic abstraction that Spring MVC and WebFlux can use to raise exceptions with the standard fields, and that also helps to enable a range of features for handling and rendering such responses.\r\n\r\nExtra properties and serialization magic remain as a separate layer, through sub-classes and a global exception handler cloning the original exception to create the sub-class, as with your `CustomProblemDetail` above.\r\n\r\nOriginally I left `Map<String, Object> properties` out of `ProblemDetail`, thinking that sub-classes would declare it and add `@JsonAnyGetter/Setter`. I introduced it here, thinking it would be useful still for the base class to provide a way to add dynamic properties from the server side, but your example above is with a property that's known on the server side, but not on the client side. So I'm not sure if dynamic properties from the server side are something all that useful? In any case, the expectation is still for a sub-class to override `getProperties` and `setProperty` and to add `@JsonAnyGetter/Setter`, which does mean that out of the box, a `properties: {}` map is what gets serialized. If that seems not unacceptable, then it doesn't make sense to have `properties` in `ProblemDetail` after all.\r\n\r\nI'm thinking that we should add a `JacksonProblemDetail` sub-class with the `@JsonAnyGetter/Setter` annotations and apply it from `ResponseEntityExceptionHandler`, if Jackson is present, or perhaps even create it by default for Spring MVC/WebFlux exceptions when Jackson is present. Then a `CustomProblemDetail` could also extend from `JacksonProblemDetail`.\r\n\r\nWhat do you think?\r\n\r\n\r\n"
      },
      {
        "author": "vy",
        "created_at": "2022-07-11T20:07:55Z",
        "body": "I am happy to hear that we are on the same page. (And thanks so much for hearing me out! :pray:)\r\n\r\n> So I'm not sure if dynamic properties from the server side are all something useful?\r\n\r\nI think they certainly are! Ideally people shouldn't subclass `ProblemDetail` and should simply use its `properties` to tailor the content. So please keep it.\r\n\r\n> I'm thinking that we should add a `JacksonProblemDetail` sub-class with the `@JsonAnyGetter/Setter` annotations and apply it from `ResponseEntityExceptionHandler`, if Jackson is present, or perhaps even create it by default for Spring MVC/WebFlux exceptions when Jackson is present. Then a `CustomProblemDetail` could also extend from `JacksonProblemDetail`.\r\n\r\nWhat about introducing a `ProblemDetailJacksonMixIn` and registering it to the available `ObjectMapper` bean and/or as an `ObjectMapper` customizer? This way, if I am not mistaken, `ProblemDetail` subclasses employing Jackson for serialization will implicitly use the mix-in for the `properties` field, unless they override it or use a custom `ObjectMapper`.\r\n\r\nThe reason I prefer a mix-in compared to a `JacksonProblemDetail`, the former will implicitly work for any `ProblemDetail` subclass thrown against Jackson, whereas the latter approach expects the user to _always_ subclass from `JacksonProblemDetail` instead."
      },
      {
        "author": "rstoyanchev",
        "created_at": "2022-07-12T10:57:41Z",
        "body": "No worries, and thanks for tracking this and providing feedback. This is very much appreciated!\r\n\r\nGood suggestion for the Jackson mix-in. We'll go with that and register it automatically from `Jackson2ObjectMapperBuilder` so it will require no further configuration. The only drawback is that `properties` will render as a nested map with other libraries but Jackson is popular and comparable solutions could probably be found for others too. The benefit of built-in support for additional properties, and reducing the need for sub-classing, that just works with Jackson is overall a good place to be.\r\n"
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "45ee7913bff4543dd3b4d701d969743aee258b20",
        "380aedb12a5cc39fa0505d0169a0c0b37f0a1b7b",
        "263811ecfa912a55bce8d0371ed20202abcf5dd5",
        "c139f3d526d29a2e152ce336d29e068774f83dd5"
      ]
    }
  },
  {
    "number": 28666,
    "title": "Stop using SpringFactoriesLoader.loadFactoryNames in the TestContext framework",
    "state": "closed",
    "created_at": "2022-06-20T18:07:33Z",
    "updated_at": "2022-06-24T18:05:09Z",
    "author": "sbrannen",
    "url": "https://github.com/spring-projects/spring-framework/issues/28666",
    "body": "`AbstractTestContextBootstrapper.getDefaultTestExecutionListenerClassNames()` is currently the only remaining use of `SpringFactoriesLoader.loadFactoryNames()` in the core Spring Framework.\r\n\r\nSince `SpringFactoriesLoader.loadFactoryNames()` will be deprecated in #27954, we should stop using it and remove the `getDefaultTestExecutionListenerClassNames()` method from `AbstractTestContextBootstrapper`. \r\n\r\nWe should likely remove `getDefaultTestExecutionListenerClasses()` as well and refactor `getTestExecutionListeners()` to make use of the new `FailureHandler` support in `SpringFactoriesLoader`.",
    "labels": [
      "in: test",
      "type: task",
      "theme: aot"
    ],
    "comments": [
      {
        "author": "sbrannen",
        "created_at": "2022-06-20T18:09:31Z",
        "body": "Since `getDefaultTestExecutionListenerClassNames()` and `getDefaultTestExecutionListenerClasses()` are both `protected` methods and therefore part of the \"public\" API for anyone extending `AbstractTestContextBootstrapper` (see https://github.com/spring-projects/spring-framework/issues/27954#issuecomment-1160646333), we could potentially deprecate those two methods in `5.3.x`.\r\n\r\n@jhoeller & @snicoll, thoughts? "
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "d1b65f6d3e90af3f55d1b4d347afb3ebe9a3de44",
        "f5503298fb00d0dde053ec3bb4cd9f91c41313a2"
      ]
    }
  },
  {
    "number": 28683,
    "title": "StackOverflowError when using BindingReflectionHintsRegistrar",
    "state": "closed",
    "created_at": "2022-06-23T08:22:47Z",
    "updated_at": "2022-06-23T13:47:28Z",
    "author": "mhalbritter",
    "url": "https://github.com/spring-projects/spring-framework/issues/28683",
    "body": "Minimal reproducer:\r\n\r\n```\r\nimport org.springframework.hateoas.CollectionModel;\r\n\r\npublic static void main(String[] args) {\r\n  BindingReflectionHintsRegistrar reflectionHintsRegistrar = new BindingReflectionHintsRegistrar();\r\n  ReflectionHints reflectionHints = new ReflectionHints();\r\n  reflectionHintsRegistrar.registerReflectionHints(reflectionHints, CollectionModel.class);\r\n}\r\n```\r\n\r\nIt looks like the `ResolvableType` in the `CollectionModel1` is the problem, as this crashes too:\r\n\r\n```\r\nreflectionHintsRegistrar.registerReflectionHints(reflectionHints, ResolvableType.class);\r\n```",
    "labels": [
      "type: bug",
      "in: core"
    ],
    "comments": [
      {
        "author": "mhalbritter",
        "created_at": "2022-06-23T08:33:56Z",
        "body": "The same happens with the `org.springframework.integration.IntegrationPatternType` type.\r\n\r\nThere's no `ResolvableType` involved, but the type references itself (with a type in between the cycle)."
      },
      {
        "author": "mhalbritter",
        "created_at": "2022-06-23T08:49:01Z",
        "body": "It seems the cycle detection is broken:\r\n\r\n```\r\npublic class Bar {\r\n  public Bar getBar() {\r\n    return null;\r\n  }\r\n}\r\n```\r\n\r\nthrows an Exception too."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "900349fcca1cd15d50a26cc4d6a360e30e9f9972",
        "fb1aa4f5d5601ddd1fe7928b39c6408a3003a59a",
        "b121eed7533490448e7e98ca84cf34cd4983b0c8",
        "fe6fd498899d6c6d3023d8ef8e8cea6955a3aef6",
        "58aeab3ab68766676942bd097dc42b5f1d2c553c",
        "1aaa44bbfe4a6efbab09f3ac48fe6babd60b2ad9",
        "0546003dce08724a90bc715b65893386eaca675e",
        "61e9aa9f42b34666d94067c23f9c54eea1226a63",
        "7df17370db12cc91e8b62d70a28a1fdb01101588",
        "51187517a3b6fa14e8d0647879d898af90ebe4fa"
      ]
    }
  },
  {
    "number": 28688,
    "title": "Field `PROPAGATION_REQUIRED` not found in class `TransactionDefinition` in native image",
    "state": "closed",
    "created_at": "2022-06-23T14:30:34Z",
    "updated_at": "2023-08-02T07:43:07Z",
    "author": "mhalbritter",
    "url": "https://github.com/spring-projects/spring-framework/issues/28688",
    "body": "In the `batch` sample from `spring-native` in `sb-3.0.x` branch, running the native image fails with the following exception:\r\n\r\n```\r\norg.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'batchApplication': Unsatisfied dependency expressed through field 'jobBuilderFactory': Error creating bean with name 'org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration': Unsatisfied dependency expressed through field 'configurers': Error creating bean with name 'batchConfigurer': Unable to initialize Spring Batch\r\n\tat org.springframework.beans.factory.aot.AutowiredFieldValueResolver.resolveValue(AutowiredFieldValueResolver.java:195) ~[na:na]\r\n\tat org.springframework.beans.factory.aot.AutowiredFieldValueResolver.resolveAndSet(AutowiredFieldValueResolver.java:167) ~[na:na]\r\n\tat com.example.batch.BatchApplication__Autowiring.apply(BatchApplication__Autowiring.java:14) ~[na:na]\r\n\tat org.springframework.beans.factory.support.InstanceSupplier.lambda$andThen$0(InstanceSupplier.java:64) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1223) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainFromSupplier(AbstractAutowireCapableBeanFactory.java:1209) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1156) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:566) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:526) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:930) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:926) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:592) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.refresh(SpringApplication.java:735) ~[batch:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:431) ~[batch:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:310) ~[batch:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1307) ~[batch:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1296) ~[batch:3.0.0-SNAPSHOT]\r\n\tat com.example.batch.BatchApplication.main(BatchApplication.java:49) ~[batch:0.0.1-SNAPSHOT]\r\nCaused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration': Unsatisfied dependency expressed through field 'configurers': Error creating bean with name 'batchConfigurer': Unable to initialize Spring Batch\r\n\tat org.springframework.beans.factory.aot.AutowiredFieldValueResolver.resolveValue(AutowiredFieldValueResolver.java:195) ~[na:na]\r\n\tat org.springframework.beans.factory.aot.AutowiredFieldValueResolver.resolveAndSet(AutowiredFieldValueResolver.java:167) ~[na:na]\r\n\tat org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration__Autowiring.apply(SimpleBatchConfiguration__Autowiring.java:17) ~[na:na]\r\n\tat org.springframework.beans.factory.support.InstanceSupplier.lambda$andThen$0(InstanceSupplier.java:64) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1223) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainFromSupplier(AbstractAutowireCapableBeanFactory.java:1209) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1156) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:566) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:526) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:225) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveNamedBean(DefaultListableBeanFactory.java:1267) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveNamedBean(DefaultListableBeanFactory.java:1228) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveBean(DefaultListableBeanFactory.java:483) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.getBean(DefaultListableBeanFactory.java:338) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.getBean(DefaultListableBeanFactory.java:331) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.batch.core.configuration.annotation.AbstractBatchConfiguration__BeanDefinitions.getJobBuildersInstance(AbstractBatchConfiguration__BeanDefinitions.java:30) ~[na:na]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1223) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainFromSupplier(AbstractAutowireCapableBeanFactory.java:1209) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1156) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:566) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:526) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1374) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1294) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.aot.AutowiredFieldValueResolver.resolveValue(AutowiredFieldValueResolver.java:189) ~[na:na]\r\n\t... 21 common frames omitted\r\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'batchConfigurer': Unable to initialize Spring Batch\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1752) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:604) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:526) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.addCandidateEntry(DefaultListableBeanFactory.java:1590) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1554) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveMultipleBeans(DefaultListableBeanFactory.java:1445) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1332) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1294) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.aot.AutowiredFieldValueResolver.resolveValue(AutowiredFieldValueResolver.java:189) ~[na:na]\r\n\t... 52 common frames omitted\r\nCaused by: java.lang.IllegalStateException: Unable to initialize Spring Batch\r\n\tat org.springframework.boot.autoconfigure.batch.BasicBatchConfigurer.initialize(BasicBatchConfigurer.java:107) ~[batch:0.0.1-SNAPSHOT]\r\n\tat org.springframework.boot.autoconfigure.batch.BasicBatchConfigurer.afterPropertiesSet(BasicBatchConfigurer.java:96) ~[batch:0.0.1-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1798) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1748) ~[batch:6.0.0-SNAPSHOT]\r\n\t... 65 common frames omitted\r\nCaused by: org.springframework.core.Constants$ConstantException: Field 'PROPAGATION_REQUIRED' not found in class [org.springframework.transaction.TransactionDefinition]\r\n\tat org.springframework.core.Constants.asObject(Constants.java:145) ~[na:na]\r\n\tat org.springframework.core.Constants.asNumber(Constants.java:113) ~[na:na]\r\n\tat org.springframework.transaction.support.DefaultTransactionDefinition.setPropagationBehaviorName(DefaultTransactionDefinition.java:122) ~[batch:6.0.0-SNAPSHOT]\r\n\tat org.springframework.transaction.interceptor.TransactionAttributeEditor.setAsText(TransactionAttributeEditor.java:65) ~[na:na]\r\n\tat org.springframework.transaction.interceptor.NameMatchTransactionAttributeSource.setProperties(NameMatchTransactionAttributeSource.java:87) ~[na:na]\r\n\tat org.springframework.batch.core.repository.support.AbstractJobRepositoryFactoryBean.initializeProxy(AbstractJobRepositoryFactoryBean.java:182) ~[batch:5.0.0-M3]\r\n\tat org.springframework.batch.core.repository.support.AbstractJobRepositoryFactoryBean.afterPropertiesSet(AbstractJobRepositoryFactoryBean.java:212) ~[batch:5.0.0-M3]\r\n\tat org.springframework.batch.core.repository.support.JobRepositoryFactoryBean.afterPropertiesSet(JobRepositoryFactoryBean.java:225) ~[na:na]\r\n\tat org.springframework.boot.autoconfigure.batch.BasicBatchConfigurer.createJobRepository(BasicBatchConfigurer.java:134) ~[batch:0.0.1-SNAPSHOT]\r\n\tat org.springframework.boot.autoconfigure.batch.BasicBatchConfigurer.initialize(BasicBatchConfigurer.java:102) ~[batch:0.0.1-SNAPSHOT]\r\n\t... 68 common frames omitted\r\n```\r\n\r\nI guess there are some hints missing.",
    "labels": [
      "in: data",
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [
      {
        "author": "christophstrobl",
        "created_at": "2022-06-27T11:57:41Z",
        "body": "```java\r\nRuntimeHintsUtils.registerAnnotation(hints, org.springframework.transaction.annotation.Transactional.class);\r\n\r\nhints.reflection()\r\n\t.registerTypes(asList(\r\n\t\tTypeReference.of(org.springframework.transaction.annotation.Isolation.class),\r\n\t\tTypeReference.of(org.springframework.transaction.annotation.Propagation.class),\r\n\t\tTypeReference.of(org.springframework.transaction.TransactionDefinition.class)),\r\n\t\thint -> ...)\r\n\r\nhints.reflection()\r\n\t.registerTypes(asList(\r\n\t\tTypeReference.of(AutoProxyRegistrar.class),\r\n\t\tTypeReference.of(ProxyTransactionManagementConfiguration.class),\r\n\t\tTypeReference.of(\"org.springframework.transaction.interceptor.BeanFactoryTransactionAttributeSourceAdvisor$1\")), ...\r\n```\r\n\r\n_(updated to make use of RuntimeHintsUtils.registerAnnotation)_"
      },
      {
        "author": "sdeleuze",
        "created_at": "2022-06-28T11:12:21Z",
        "body": "@christophstrobl Thanks for the hints ;-) What about annotating `ProxyTransactionManagementConfiguration` with `@ImportRuntimeHints(TransactionRuntimeHintsRegistrar.class)` where `TransactionRuntimeHintsRegistrar` would register those entries?"
      },
      {
        "author": "snicoll",
        "created_at": "2022-06-28T11:43:56Z",
        "body": "Please don't register proxies like that, and use registerAnnotation. "
      },
      {
        "author": "sbrannen",
        "created_at": "2023-08-01T11:15:15Z",
        "body": "@christophstrobl, do you recall why you needed to register reflection hints for the enum constant fields in `Isolation` and `Propagation`?\r\n\r\nI'm asking, because while working on #30854 I wondered if we still need those hints."
      },
      {
        "author": "sbrannen",
        "created_at": "2023-08-01T13:34:45Z",
        "body": "> @christophstrobl, do you recall why you needed to register reflection hints for the enum constant fields in `Isolation` and `Propagation`?\r\n\r\n@sdeleuze, Christoph informed me that he does not recall. Do you recall?"
      },
      {
        "author": "sdeleuze",
        "created_at": "2023-08-02T07:43:07Z",
        "body": "I don't, but if we change something here, worth to check if we have a related smoke test and check after that it does not break. In any case, I would advise to test on a sample with both 22.3 and 23.0 GraalVM releases."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "50240bb609b6441390d436005a7f2e7a4cdf5454"
      ]
    }
  },
  {
    "number": 28689,
    "title": "native-image: Support for MethodValidationPostProcessor",
    "state": "closed",
    "created_at": "2022-06-23T14:49:33Z",
    "updated_at": "2022-07-01T08:20:36Z",
    "author": "mhalbritter",
    "url": "https://github.com/spring-projects/spring-framework/issues/28689",
    "body": "When running the native-image from the spring-native sample `cloud-config/configserver` on the `sb-3.0.x` branch, i get the following exception:\r\n\r\n```\r\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name 'methodValidationPostProcessor': Instantiation of supplied bean failed\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1234) ~[configserver:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainFromSupplier(AbstractAutowireCapableBeanFactory.java:1209) ~[configserver:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1156) ~[configserver:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:566) ~[configserver:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:526) ~[configserver:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[configserver:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[configserver:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[configserver:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:205) ~[configserver:6.0.0-SNAPSHOT]\r\n\tat org.springframework.context.support.PostProcessorRegistrationDelegate.registerBeanPostProcessors(PostProcessorRegistrationDelegate.java:261) ~[na:na]\r\n\tat org.springframework.context.support.AbstractApplicationContext.registerBeanPostProcessors(AbstractApplicationContext.java:771) ~[configserver:6.0.0-SNAPSHOT]\r\n\tat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:576) ~[configserver:6.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[configserver:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.refresh(SpringApplication.java:735) ~[configserver:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:431) ~[configserver:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:310) ~[configserver:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1307) ~[configserver:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1296) ~[configserver:3.0.0-SNAPSHOT]\r\n\tat org.demo.configserver.ConfigServerApplication.main(ConfigServerApplication.java:19) ~[configserver:0.0.1-SNAPSHOT]\r\nCaused by: com.oracle.svm.core.jdk.UnsupportedFeatureError: Proxy class defined by interfaces [interface jakarta.validation.Validator, interface org.springframework.aop.SpringProxy, interface org.springframework.aop.framework.Advised, interface org.springframework.core.DecoratingProxy] not found. Generating proxy classes at runtime is not supported. Proxy classes need to be defined at image build time by specifying the list of interfaces that they implement. To define proxy classes use -H:DynamicProxyConfigurationFiles=<comma-separated-config-files> and -H:DynamicProxyConfigurationResources=<comma-separated-config-resources> options.\r\n\tat com.oracle.svm.core.util.VMError.unsupportedFeature(VMError.java:89) ~[na:na]\r\n\tat com.oracle.svm.reflect.proxy.DynamicProxySupport.getProxyClass(DynamicProxySupport.java:158) ~[na:na]\r\n\tat java.lang.reflect.Proxy.getProxyConstructor(Proxy.java:48) ~[configserver:na]\r\n\tat java.lang.reflect.Proxy.newProxyInstance(Proxy.java:1037) ~[configserver:na]\r\n\tat org.springframework.aop.framework.JdkDynamicAopProxy.getProxy(JdkDynamicAopProxy.java:126) ~[na:na]\r\n\tat org.springframework.aop.framework.ProxyFactory.getProxy(ProxyFactory.java:110) ~[na:na]\r\n\tat org.springframework.context.annotation.ContextAnnotationAutowireCandidateResolver.buildLazyResolutionProxy(ContextAnnotationAutowireCandidateResolver.java:130) ~[na:na]\r\n\tat org.springframework.context.annotation.ContextAnnotationAutowireCandidateResolver.getLazyResolutionProxyIfNecessary(ContextAnnotationAutowireCandidateResolver.java:54) ~[na:na]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1291) ~[configserver:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.aot.AutowiredInstantiationArgumentsResolver.resolveArgument(AutowiredInstantiationArgumentsResolver.java:302) ~[na:na]\r\n\tat org.springframework.beans.factory.aot.AutowiredInstantiationArgumentsResolver.resolveArguments(AutowiredInstantiationArgumentsResolver.java:232) ~[na:na]\r\n\tat org.springframework.beans.factory.aot.AutowiredInstantiationArgumentsResolver.resolve(AutowiredInstantiationArgumentsResolver.java:154) ~[na:na]\r\n\tat org.springframework.boot.autoconfigure.validation.ValidationAutoConfiguration__BeanDefinitions.getMethodValidationPostProcessorInstance(ValidationAutoConfiguration__BeanDefinitions.java:68) ~[na:na]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1223) ~[configserver:6.0.0-SNAPSHOT]\r\n\t... 18 common frames omitted\r\n```\r\n\r\nLooks like there are some proxy hints missing.",
    "labels": [
      "in: core",
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "8c063a0e2ad5f6041c781474ab1fd5f9afacf1f0"
      ]
    }
  },
  {
    "number": 28690,
    "title": "native-image: Missing resource hint for ConfigurableMimeFileTypeMap",
    "state": "closed",
    "created_at": "2022-06-23T14:58:38Z",
    "updated_at": "2022-06-23T17:05:34Z",
    "author": "mhalbritter",
    "url": "https://github.com/spring-projects/spring-framework/issues/28690",
    "body": "Running the native-image from spring-native samples in branch `sb-3.0.x` leads to\r\n\r\n```\r\norg.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'javamailService': Unsatisfied dependency expressed through constructor parameter 0: Error creating bean with name 'mailSender': Instantiation of supplied bean failed\r\n\tat org.springframework.beans.factory.aot.AutowiredInstantiationArgumentsResolver.resolveArgument(AutowiredInstantiationArgumentsResolver.java:319) ~[na:na]\r\n\tat org.springframework.beans.factory.aot.AutowiredInstantiationArgumentsResolver.resolveArguments(AutowiredInstantiationArgumentsResolver.java:232) ~[na:na]\r\n\tat org.springframework.beans.factory.aot.AutowiredInstantiationArgumentsResolver.resolve(AutowiredInstantiationArgumentsResolver.java:154) ~[na:na]\r\n\tat com.example.javamail.service.JavamailService__BeanDefinitions.getJavamailServiceInstance(JavamailService__BeanDefinitions.java:31) ~[na:na]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1223) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainFromSupplier(AbstractAutowireCapableBeanFactory.java:1209) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1156) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:566) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:526) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:930) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:926) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:592) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[javamail:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.refresh(SpringApplication.java:735) ~[javamail:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:431) ~[javamail:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:310) ~[javamail:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1307) ~[javamail:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1296) ~[javamail:3.0.0-SNAPSHOT]\r\n\tat com.example.javamail.JavamailApplication.main(JavamailApplication.java:10) ~[javamail:0.0.1-SNAPSHOT]\r\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'mailSender': Instantiation of supplied bean failed\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1234) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainFromSupplier(AbstractAutowireCapableBeanFactory.java:1209) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1156) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:566) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:526) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:254) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1374) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1294) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.aot.AutowiredInstantiationArgumentsResolver.resolveArgument(AutowiredInstantiationArgumentsResolver.java:302) ~[na:na]\r\n\t... 22 common frames omitted\r\nCaused by: java.lang.IllegalStateException: Could not load specified MIME type mapping file: class path resource [org/springframework/mail/javamail/mime.types]\r\n\tat org.springframework.mail.javamail.ConfigurableMimeFileTypeMap.getFileTypeMap(ConfigurableMimeFileTypeMap.java:126) ~[na:na]\r\n\tat org.springframework.mail.javamail.ConfigurableMimeFileTypeMap.afterPropertiesSet(ConfigurableMimeFileTypeMap.java:110) ~[na:na]\r\n\tat org.springframework.mail.javamail.JavaMailSenderImpl.<init>(JavaMailSenderImpl.java:115) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.autoconfigure.mail.MailSenderPropertiesConfiguration.mailSender(MailSenderPropertiesConfiguration.java:44) ~[javamail:0.0.1-SNAPSHOT]\r\n\tat org.springframework.boot.autoconfigure.mail.MailSenderPropertiesConfiguration__BeanDefinitions.lambda$getMailSenderInstance$0(MailSenderPropertiesConfiguration__BeanDefinitions.java:41) ~[na:na]\r\n\tat org.springframework.util.function.ThrowingFunction.apply(ThrowingFunction.java:63) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.util.function.ThrowingFunction.apply(ThrowingFunction.java:51) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.aot.AutowiredInstantiationArgumentsResolver.resolve(AutowiredInstantiationArgumentsResolver.java:156) ~[na:na]\r\n\tat org.springframework.boot.autoconfigure.mail.MailSenderPropertiesConfiguration__BeanDefinitions.getMailSenderInstance(MailSenderPropertiesConfiguration__BeanDefinitions.java:41) ~[na:na]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1223) ~[javamail:6.0.0-SNAPSHOT]\r\n\t... 34 common frames omitted\r\nCaused by: java.io.FileNotFoundException: class path resource [org/springframework/mail/javamail/mime.types] cannot be opened because it does not exist\r\n\tat org.springframework.core.io.ClassPathResource.getInputStream(ClassPathResource.java:183) ~[javamail:6.0.0-SNAPSHOT]\r\n\tat org.springframework.mail.javamail.ConfigurableMimeFileTypeMap.createFileTypeMap(ConfigurableMimeFileTypeMap.java:149) ~[na:na]\r\n\tat org.springframework.mail.javamail.ConfigurableMimeFileTypeMap.getFileTypeMap(ConfigurableMimeFileTypeMap.java:123) ~[na:na]\r\n\t... 43 common frames omitted\r\n```\r\n\r\nThere's a resource hint missing.",
    "labels": [
      "in: core",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "16c43c2041a50a8e1fd0befbb71cc2aa9644620a"
      ]
    }
  },
  {
    "number": 28696,
    "title": "native-image: Problem with Scheduled annotation",
    "state": "closed",
    "created_at": "2022-06-24T08:48:03Z",
    "updated_at": "2022-07-04T15:10:10Z",
    "author": "mhalbritter",
    "url": "https://github.com/spring-projects/spring-framework/issues/28696",
    "body": "When running the native-image from the spring-native sample `scheduling-tasks` on the `sb-3.0.x` branch, i get the following exception:\r\n\r\n```\r\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name 'schedulingTasksApplication': Invalid declaration of container type [org.springframework.scheduling.annotation.Schedules] for repeatable annotation [org.springframework.scheduling.annotation.Scheduled]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:611) ~[scheduling-tasks:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:526) ~[scheduling-tasks:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[scheduling-tasks:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[scheduling-tasks:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[scheduling-tasks:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[scheduling-tasks:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:930) ~[scheduling-tasks:6.0.0-SNAPSHOT]\r\n\tat org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:926) ~[scheduling-tasks:6.0.0-SNAPSHOT]\r\n\tat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:592) ~[scheduling-tasks:6.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.refresh(SpringApplication.java:735) ~[scheduling-tasks:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:431) ~[scheduling-tasks:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:310) ~[scheduling-tasks:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1307) ~[scheduling-tasks:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1296) ~[scheduling-tasks:3.0.0-SNAPSHOT]\r\n\tat com.example.schedulingtasks.SchedulingTasksApplication.main(SchedulingTasksApplication.java:13) ~[scheduling-tasks:0.0.1-SNAPSHOT]\r\nCaused by: org.springframework.core.annotation.AnnotationConfigurationException: Invalid declaration of container type [org.springframework.scheduling.annotation.Schedules] for repeatable annotation [org.springframework.scheduling.annotation.Scheduled]\r\n\tat org.springframework.core.annotation.RepeatableContainers$ExplicitRepeatableContainer.<init>(RepeatableContainers.java:219) ~[na:na]\r\n\tat org.springframework.core.annotation.RepeatableContainers.of(RepeatableContainers.java:117) ~[scheduling-tasks:6.0.0-SNAPSHOT]\r\n\tat org.springframework.core.annotation.AnnotatedElementUtils.getRepeatableAnnotations(AnnotatedElementUtils.java:759) ~[na:na]\r\n\tat org.springframework.core.annotation.AnnotatedElementUtils.getMergedRepeatableAnnotations(AnnotatedElementUtils.java:455) ~[na:na]\r\n\tat org.springframework.scheduling.annotation.ScheduledAnnotationBeanPostProcessor.lambda$postProcessAfterInitialization$0(ScheduledAnnotationBeanPostProcessor.java:366) ~[scheduling-tasks:6.0.0-SNAPSHOT]\r\n\tat org.springframework.core.MethodIntrospector.lambda$selectMethods$0(MethodIntrospector.java:74) ~[na:na]\r\n\tat org.springframework.util.ReflectionUtils.doWithMethods(ReflectionUtils.java:366) ~[na:na]\r\n\tat org.springframework.core.MethodIntrospector.selectMethods(MethodIntrospector.java:72) ~[na:na]\r\n\tat org.springframework.scheduling.annotation.ScheduledAnnotationBeanPostProcessor.postProcessAfterInitialization(ScheduledAnnotationBeanPostProcessor.java:364) ~[scheduling-tasks:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsAfterInitialization(AbstractAutowireCapableBeanFactory.java:440) ~[scheduling-tasks:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1755) ~[scheduling-tasks:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:604) ~[scheduling-tasks:6.0.0-SNAPSHOT]\r\n\t... 14 common frames omitted\r\nCaused by: java.lang.NoSuchMethodException: No value method found\r\n\tat org.springframework.core.annotation.RepeatableContainers$ExplicitRepeatableContainer.<init>(RepeatableContainers.java:203) ~[na:na]\r\n\t... 25 common frames omitted\r\n```",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [
      {
        "author": "snicoll",
        "created_at": "2022-07-04T14:08:41Z",
        "body": "@sdeleuze is the registrar really necessary? Unless the implementation has changed, adding `@Reflective` should register the annotation as well. \n\nNow the agent is available it would be nice to have a test for this. "
      },
      {
        "author": "sdeleuze",
        "created_at": "2022-07-04T15:01:16Z",
        "body": "I will double check."
      },
      {
        "author": "sdeleuze",
        "created_at": "2022-07-04T15:10:10Z",
        "body": "It does not work without the registrar (maybe something to refine on `@Reflective` to refine later), I will add related tests."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "fd265a18c619b21f97f753871c6e1c32df65ba32"
      ]
    }
  },
  {
    "number": 28697,
    "title": "Add runtime hints for `AbstractHandshakeHandler`",
    "state": "closed",
    "created_at": "2022-06-24T08:51:35Z",
    "updated_at": "2022-06-30T14:52:04Z",
    "author": "mhalbritter",
    "url": "https://github.com/spring-projects/spring-framework/issues/28697",
    "body": "When running the native-image from the spring-native sample `websocket` on the `sb-3.0.x` branch, i get the following exception:\r\n\r\n```\r\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name 'stompWebSocketHandlerMapping': Instantiation of supplied bean failed\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1234) ~[websocket:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainFromSupplier(AbstractAutowireCapableBeanFactory.java:1209) ~[websocket:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1156) ~[websocket:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:566) ~[websocket:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:526) ~[websocket:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[websocket:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[websocket:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[websocket:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[websocket:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:930) ~[websocket:6.0.0-SNAPSHOT]\r\n\tat org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:926) ~[websocket:6.0.0-SNAPSHOT]\r\n\tat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:592) ~[websocket:6.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[websocket:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.refresh(SpringApplication.java:735) ~[websocket:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:431) ~[websocket:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:310) ~[websocket:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1307) ~[websocket:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1296) ~[websocket:3.0.0-SNAPSHOT]\r\n\tat com.example.websocket.WebsocketApplication.main(WebsocketApplication.java:20) ~[websocket:0.0.1-SNAPSHOT]\r\nCaused by: java.lang.IllegalStateException: Failed to instantiate RequestUpgradeStrategy: org.springframework.web.socket.server.standard.TomcatRequestUpgradeStrategy\r\n\tat org.springframework.web.socket.server.support.AbstractHandshakeHandler.initRequestUpgradeStrategy(AbstractHandshakeHandler.java:160) ~[websocket:6.0.0-SNAPSHOT]\r\n\tat org.springframework.web.socket.server.support.AbstractHandshakeHandler.<init>(AbstractHandshakeHandler.java:118) ~[websocket:6.0.0-SNAPSHOT]\r\n\tat org.springframework.web.socket.server.support.DefaultHandshakeHandler.<init>(DefaultHandshakeHandler.java:35) ~[na:na]\r\n\tat org.springframework.web.socket.server.support.WebSocketHttpRequestHandler.<init>(WebSocketHttpRequestHandler.java:73) ~[na:na]\r\n\tat org.springframework.web.socket.config.annotation.WebMvcStompWebSocketEndpointRegistration.getMappings(WebMvcStompWebSocketEndpointRegistration.java:160) ~[na:na]\r\n\tat org.springframework.web.socket.config.annotation.WebMvcStompEndpointRegistry.getHandlerMapping(WebMvcStompEndpointRegistry.java:155) ~[na:na]\r\n\tat org.springframework.web.socket.config.annotation.WebSocketMessageBrokerConfigurationSupport.stompWebSocketHandlerMapping(WebSocketMessageBrokerConfigurationSupport.java:92) ~[websocket:6.0.0-SNAPSHOT]\r\n\tat org.springframework.web.socket.config.annotation.WebSocketMessageBrokerConfigurationSupport__BeanDefinitions.lambda$getStompWebSocketHandlerMappingInstance$0(WebSocketMessageBrokerConfigurationSupport__BeanDefinitions.java:38) ~[na:na]\r\n\tat org.springframework.util.function.ThrowingFunction.apply(ThrowingFunction.java:63) ~[websocket:6.0.0-SNAPSHOT]\r\n\tat org.springframework.util.function.ThrowingFunction.apply(ThrowingFunction.java:51) ~[websocket:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.aot.AutowiredInstantiationArgumentsResolver.resolve(AutowiredInstantiationArgumentsResolver.java:156) ~[na:na]\r\n\tat org.springframework.web.socket.config.annotation.WebSocketMessageBrokerConfigurationSupport__BeanDefinitions.getStompWebSocketHandlerMappingInstance(WebSocketMessageBrokerConfigurationSupport__BeanDefinitions.java:38) ~[na:na]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1223) ~[websocket:6.0.0-SNAPSHOT]\r\n\t... 18 common frames omitted\r\nCaused by: java.lang.ClassNotFoundException: org.springframework.web.socket.server.standard.TomcatRequestUpgradeStrategy\r\n\tat java.lang.Class.forName(DynamicHub.java:1121) ~[websocket:na]\r\n\tat org.springframework.util.ClassUtils.forName(ClassUtils.java:284) ~[na:na]\r\n\tat org.springframework.web.socket.server.support.AbstractHandshakeHandler.initRequestUpgradeStrategy(AbstractHandshakeHandler.java:156) ~[websocket:6.0.0-SNAPSHOT]\r\n\t... 30 common frames omitted\r\n```",
    "labels": [
      "in: web",
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "ecdd934658fa99c3420fc583331edb1be6e1634d"
      ]
    }
  },
  {
    "number": 28701,
    "title": "RuntimeHints missing for WebFlux",
    "state": "closed",
    "created_at": "2022-06-24T14:06:55Z",
    "updated_at": "2022-06-30T08:04:20Z",
    "author": "mhalbritter",
    "url": "https://github.com/spring-projects/spring-framework/issues/28701",
    "body": "I had to add these hints to get WebFlux with Netty running, using the spring-native sample `webflux-netty` on [this branch](https://github.com/mhalbritter/spring-native/tree/mh/netty):\r\n\r\n```\r\n        hints.resources().registerPattern(\"org/springframework/http/codec/CodecConfigurer.properties\");\r\n        hints.reflection().registerType(DefaultClientCodecConfigurer.class, hint -> hint.withMembers(MemberCategory.INVOKE_PUBLIC_CONSTRUCTORS));\r\n        hints.reflection().registerType(DefaultServerCodecConfigurer.class, hint -> hint.withMembers(MemberCategory.INVOKE_PUBLIC_CONSTRUCTORS));\r\n        RuntimeHintsUtils.registerAnnotation(hints, RequestMapping.class);\r\n```\r\n\r\nI only did the minimal possible work that the sample passes, so I guess this is far from being complete.",
    "labels": [
      "in: web",
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "8a7f82b8008f70295396419da0f7fc687e60206c",
        "4ec3e1042a2018562e1aa1d1bc79c6d9b624d004"
      ]
    }
  },
  {
    "number": 28709,
    "title": "Jackson well-known module support in native image",
    "state": "closed",
    "created_at": "2022-06-27T09:42:42Z",
    "updated_at": "2022-06-30T13:28:59Z",
    "author": "mhalbritter",
    "url": "https://github.com/spring-projects/spring-framework/issues/28709",
    "body": "When running the binary from the `webflux-kotlin` sample from spring-native, I get the following exception:\r\n\r\n```\r\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name 'jacksonObjectMapper': Instantiation of supplied bean failed\r\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1234) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainFromSupplier(AbstractAutowireCapableBeanFactory.java:1209) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1156) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:566) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:526) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:930) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:926) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:592) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        at org.springframework.boot.web.reactive.context.ReactiveWebServerApplicationContext.refresh(ReactiveWebServerApplicationContext.java:66) ~[webflux-kotlin:3.0.0-SNAPSHOT]\r\n        at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:729) ~[webflux-kotlin:3.0.0-SNAPSHOT]\r\n        at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:428) ~[webflux-kotlin:3.0.0-SNAPSHOT]\r\n        at org.springframework.boot.SpringApplication.run(SpringApplication.java:310) ~[webflux-kotlin:3.0.0-SNAPSHOT]\r\n        at org.springframework.boot.SpringApplication.run(SpringApplication.java:1301) ~[webflux-kotlin:3.0.0-SNAPSHOT]\r\n        at org.springframework.boot.SpringApplication.run(SpringApplication.java:1290) ~[webflux-kotlin:3.0.0-SNAPSHOT]\r\n        at com.example.webflux.WebfluxApplicationKt.main(WebfluxApplication.kt:16) ~[webflux-kotlin:0.0.1-SNAPSHOT]\r\nCaused by: kotlin.jvm.KotlinReflectionNotSupportedError: Kotlin reflection implementation is not found at runtime. Make sure you have kotlin-reflect.jar in the classpath\r\n        at kotlin.jvm.internal.ClassReference.error(ClassReference.kt:88) ~[na:na]\r\n        at kotlin.jvm.internal.ClassReference.getConstructors(ClassReference.kt:21) ~[na:na]\r\n        at kotlin.reflect.jvm.ReflectJvmMapping.getKotlinFunction(ReflectJvmMapping.kt:146) ~[na:na]\r\n        at org.springframework.beans.BeanUtils$KotlinDelegate.instantiateClass(BeanUtils.java:869) ~[na:na]\r\n        at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:191) ~[na:na]\r\n        at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:152) ~[na:na]\r\n        at org.springframework.http.converter.json.Jackson2ObjectMapperBuilder.registerWellKnownModulesIfAvailable(Jackson2ObjectMapperBuilder.java:842) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        at org.springframework.http.converter.json.Jackson2ObjectMapperBuilder.configure(Jackson2ObjectMapperBuilder.java:689) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        at org.springframework.http.converter.json.Jackson2ObjectMapperBuilder.build(Jackson2ObjectMapperBuilder.java:672) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        at org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$JacksonObjectMapperConfiguration.jacksonObjectMapper(JacksonAutoConfiguration.java:113) ~[webflux-kotlin:3.0.0-SNAPSHOT]\r\n        at org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration_JacksonObjectMapperConfiguration__BeanDefinitions.lambda$getJacksonObjectMapperInstance$0(JacksonAutoConfiguration_JacksonObjectMapperConfiguration__BeanDefinitions.java:43) ~[na:na]\r\n        at org.springframework.util.function.ThrowingFunction.apply(ThrowingFunction.java:63) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        at org.springframework.util.function.ThrowingFunction.apply(ThrowingFunction.java:51) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        at org.springframework.beans.factory.aot.AutowiredInstantiationArgumentsResolver.resolve(AutowiredInstantiationArgumentsResolver.java:156) ~[na:na]\r\n        at org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration_JacksonObjectMapperConfiguration__BeanDefinitions.getJacksonObjectMapperInstance(JacksonAutoConfiguration_JacksonObjectMapperConfiguration__BeanDefinitions.java:43) ~[na:na]\r\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1223) ~[webflux-kotlin:6.0.0-SNAPSHOT]\r\n        ... 18 common frames omitted\r\n```\r\n\r\nThere is\r\n\r\n```\r\n\t\t<dependency>\r\n\t\t\t<groupId>org.jetbrains.kotlin</groupId>\r\n\t\t\t<artifactId>kotlin-reflect</artifactId>\r\n\t\t</dependency>\r\n```\r\n\r\nin the `pom.xml`, the sample runs with `mvn spring-boot:run`",
    "labels": [
      "type: enhancement",
      "theme: aot",
      "theme: kotlin"
    ],
    "comments": [
      {
        "author": "sdeleuze",
        "created_at": "2022-06-28T11:33:13Z",
        "body": "Seems related to the well-known Jackson modules (here `KotlinModule`) registered in [Jackson2ObjectMapperBuilder#registerWellKnownModulesIfAvailable](https://github.com/spring-projects/spring-framework/blob/efb83fa064b3d3335393defcf6d6fa785c0e3ef6/spring-web/src/main/java/org/springframework/http/converter/json/Jackson2ObjectMapperBuilder.java#L816).\r\n\r\nThere could be Kotlin reflection hints missing as well (but those ones should go in the reachability metadata reprository I think, not sure yet what we do in the interim).\r\n\r\nSpring Native [`KotlinHints`](https://github.com/spring-projects-experimental/spring-native/blob/main/spring-native-configuration/src/main/java/kotlin/KotlinHints.java) could be used as a source of inspiration."
      },
      {
        "author": "sdeleuze",
        "created_at": "2022-06-30T13:28:59Z",
        "body": "Notice I had to add Kotlin hints via https://github.com/spring-projects-experimental/spring-native/commit/3392357741671f29b5934a000f5d7c34070eadc0 to make it work, this will go to the reachability repo or better we could ask Kotlin team to ship that out of the box."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "f78251769c84ad94b9289b7b862e01a0c5eb8a79",
        "e94f2a8e3ffaf203053ec82ea7719e4ca11c6a77"
      ]
    }
  },
  {
    "number": 28714,
    "title": "Replace java.util.Date and TimeUnit usage in scheduling with appropiate java.time classes",
    "state": "closed",
    "created_at": "2022-06-27T18:50:44Z",
    "updated_at": "2022-07-08T16:59:57Z",
    "author": "desiderantes",
    "url": "https://github.com/spring-projects/spring-framework/issues/28714",
    "body": "Given that a lot of times we get the values for Triggers and such from configs or other places that use java.time types, and the fact that they're the proper types to model this sort of thing, it would be nice to reduce usage of java.util.Date (since it's so prone to improper handling).\r\n",
    "labels": [
      "in: core",
      "type: enhancement"
    ],
    "comments": [
      {
        "author": "poutsma",
        "created_at": "2022-07-08T14:31:10Z",
        "body": "@desiderantes This is now complete, see https://github.com/spring-projects/spring-framework/commit/9b739a2310bac781c89a22bf92650615f9dd7406. Let me know if there are `java.util.Date` usages that I missed."
      },
      {
        "author": "desiderantes",
        "created_at": "2022-07-08T16:59:57Z",
        "body": "@poutsma Whoah, thanks a lot! I don't see other usages of java.util.Date in scheduling (and I can't judge the usages in the other parts)"
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "9b739a2310bac781c89a22bf92650615f9dd7406"
      ]
    }
  },
  {
    "number": 28717,
    "title": "Add support for `@Transactional` in native images",
    "state": "closed",
    "created_at": "2022-06-28T08:34:19Z",
    "updated_at": "2022-07-08T14:50:55Z",
    "author": "mhalbritter",
    "url": "https://github.com/spring-projects/spring-framework/issues/28717",
    "body": "When running the `jdbc-tx` sample in `sb-3.0.x` branch from spring-native, it fails with:\r\n\r\n```\r\njava.lang.IllegalStateException: Failed to execute CommandLineRunner\r\n        at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:769) ~[jdbc-tx:3.0.0-SNAPSHOT]\r\n        at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:750) ~[jdbc-tx:3.0.0-SNAPSHOT]\r\n        at org.springframework.boot.SpringApplication.run(SpringApplication.java:318) ~[jdbc-tx:3.0.0-SNAPSHOT]\r\n        at org.springframework.boot.SpringApplication.run(SpringApplication.java:1301) ~[jdbc-tx:3.0.0-SNAPSHOT]\r\n        at org.springframework.boot.SpringApplication.run(SpringApplication.java:1290) ~[jdbc-tx:3.0.0-SNAPSHOT]\r\n        at app.main.SampleApplication.main(SampleApplication.java:23) ~[jdbc-tx:0.0.1.BUILD-SNAPSHOT]\r\nCaused by: java.lang.IllegalArgumentException: Expected transaction\r\n        at org.springframework.util.Assert.isTrue(Assert.java:121) ~[na:na]\r\n        at app.main.Runner.run(Runner.java:53) ~[jdbc-tx:0.0.1.BUILD-SNAPSHOT]\r\n        at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:766) ~[jdbc-tx:3.0.0-SNAPSHOT]\r\n        ... 5 common frames omitted\r\n```\r\n\r\nThis is the run method:\r\n\r\n```java\r\n\t@Override\r\n\t@Transactional\r\n\tpublic void run(String... args) throws Exception {\r\n\t\tAssert.isTrue(TransactionSynchronizationManager.isActualTransactionActive(), \"Expected transaction\");\r\n\t\ttry {\r\n\t\t\tfind(1L);\r\n\t\t}\r\n\t\tcatch (EmptyResultDataAccessException e) {\r\n\t\t\tentities.update(ADD_FOO, 1L, \"Hello\");\r\n\t\t}\r\n\t}\r\n```\r\n\r\nI guess that `@Transactional` doesn't work in native-image.",
    "labels": [
      "in: data",
      "theme: aot"
    ],
    "comments": [
      {
        "author": "sdeleuze",
        "created_at": "2022-06-28T11:06:11Z",
        "body": "Related to #28688."
      },
      {
        "author": "sdeleuze",
        "created_at": "2022-07-07T09:15:50Z",
        "body": "I have improved the support for `@Transactional` with [this commit](https://github.com/spring-projects/spring-framework/commit/0387d54607f371b7ff9e28dd8a89ec6203d3a09b) that makes `@Transactional` annotated with `@Reflective` and registers proxy hints for `SpringProxy` but the `jdbc-tx` sample [here](https://github.com/spring-projects-experimental/spring-native/tree/sb-3.0.x/samples/jdbc-tx) still fails when compiled as a native executable with `error creating bean with name 'userEndpoints': Unsatisfied dependency expressed through method 'userEndpoints' parameter 0: No qualifying bean of type 'app.main.Finder<app.main.model.Foo>' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {} error`, like if proxied beans can't be injected in native. Notice here we have `@Component public class Runner implements CommandLineRunner, Finder<Foo> { ... }` that needs to be injected in `@Bean public RouterFunction<?> userEndpoints(Finder<Foo> entities) { ... }`.This samples works correctly on JVM + AOT so this issue is native specific."
      },
      {
        "author": "sdeleuze",
        "created_at": "2022-07-07T12:53:36Z",
        "body": "As discussed with @sbrannen, we need to replace the `SpringProxyRuntimeHintsRegistrar` by an AOT processor that will register dynamically the required proxies like here `CommandLineRunner.class, Finder.class, SpringProxy.class, Advised.class, DecoratingProxy.class` + reflection entries for proxied interfaces with [declared methods](https://github.com/spring-projects/spring-framework/blob/main/spring-aop/src/main/java/org/springframework/aop/framework/JdkDynamicAopProxy.java#L136)."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "c77a3bcc4f13624c40874a2e9148353126fc49f7",
        "69739e5e87ae0fdec8c6bef797012860151f51a3",
        "0387d54607f371b7ff9e28dd8a89ec6203d3a09b",
        "8d12d4d0c6e8499de8e48a4b66ae547d7a2cfb98",
        "975a7f0e4c15d21ca7a3acade5d7657ad9183be1",
        "032a9c8f38a68c8c1b305b496082f4a5c4f87121",
        "49fd7c99ae6483b4878145bf79ae1fe93de74f7d",
        "8ccf05adeefa3fd2a377eba067a156ea163dd616",
        "dfbcaf31dcbcd37d065db581fb62e8def726f389",
        "1458d5f39fef06d01348352fc67d5bc2cbe812e9"
      ]
    }
  },
  {
    "number": 28721,
    "title": "Add support for records in BindingReflectionHintsRegistrar",
    "state": "closed",
    "created_at": "2022-06-28T13:43:04Z",
    "updated_at": "2022-06-30T10:10:26Z",
    "author": "mhalbritter",
    "url": "https://github.com/spring-projects/spring-framework/issues/28721",
    "body": "Using `BindingReflectionHintsRegistrar` with records lead to this Jackson exception on native image runtime:\r\n\r\n```\r\nException in thread \"main\" com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Failed to access RecordComponents of type `nativeplayground.R`\r\n        at com.fasterxml.jackson.databind.SerializerProvider.reportBadDefinition(SerializerProvider.java:1300)\r\n        at com.fasterxml.jackson.databind.SerializerProvider._createAndCacheUntypedSerializer(SerializerProvider.java:1447)\r\n        at com.fasterxml.jackson.databind.SerializerProvider.findValueSerializer(SerializerProvider.java:544)\r\n        at com.fasterxml.jackson.databind.SerializerProvider.findTypedValueSerializer(SerializerProvider.java:822)\r\n        at com.fasterxml.jackson.databind.ser.DefaultSerializerProvider.serializeValue(DefaultSerializerProvider.java:308)\r\n        at com.fasterxml.jackson.databind.ObjectMapper._writeValueAndClose(ObjectMapper.java:4568)\r\n        at com.fasterxml.jackson.databind.ObjectMapper.writeValueAsString(ObjectMapper.java:3821)\r\n        at nativeplayground.SerializeMain.main(SerializeMain.java:14)\r\n```\r\n\r\nFor records, there has to be this in the reflect-config.json:\r\n\r\n```\r\n  {\r\n    \"name\": \"nativeplayground.R\",\r\n    \"allDeclaredMethods\": true\r\n  }\r\n```\r\n\r\nIt would be nice if `BindingReflectionHintsRegistrar` would support records.",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "da68781b9ef3d00151ad938209c69c7b7c35288a"
      ]
    }
  },
  {
    "number": 28722,
    "title": "HtmlUnit / MockMvc integration handles forwarded URLs partially",
    "state": "closed",
    "created_at": "2022-06-28T15:52:00Z",
    "updated_at": "2022-06-29T09:18:40Z",
    "author": "rstoyanchev",
    "url": "https://github.com/spring-projects/spring-framework/issues/28722",
    "body": "Currently `ForwardRequestPostProcessor` uses the forwarded URL only to set the servletPath of the mock request, which means `requestUri` and `servletPath` are out of sync.\r\n\r\nThis hasn't been reported as an issue since `UrlPathHelper` falls back on the `servletPath` if it doesn't match the `requestURI` but that's not really correct behavior, and causes issues in more modern setups like parsed patterns where we rely mainly on the `requestURI` and only check the `servletPath` if a Servlet prefix mapping can be confirmed with Servlet 4.0. \r\n\r\nIn the absence of a Servlet container, i.e. with mock request and response, there is actually no good way to take a `forwardedUrl` and break it down into `contextPath`, `servletPath`, and `pathInfo`. At best, we can assert that the forwarded URL does start with the same `contextPath`, but otherwise break it down into `contextPath` + `servletPath`.\r\n\r\nThis was uncovered while working on #28607.",
    "labels": [
      "in: test",
      "in: web",
      "type: bug"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "9c2ad4a1b15f64375aa537097f649d3f2b26b402"
      ]
    }
  },
  {
    "number": 28727,
    "title": "AOT generated code leads to exception on startup: Object of class [java.lang.Boolean] must be an instance of boolean",
    "state": "closed",
    "created_at": "2022-06-29T12:18:18Z",
    "updated_at": "2022-06-29T15:04:03Z",
    "author": "mhalbritter",
    "url": "https://github.com/spring-projects/spring-framework/issues/28727",
    "body": "Hi,\r\n\r\nwhen running a Spring Boot project with the `starter-integration` in it in AOT mode, it crashes on startup with this exception:\r\n\r\n```\r\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name 'errorChannel': Instantiation of supplied bean failed\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1234) ~[spring-beans-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainFromSupplier(AbstractAutowireCapableBeanFactory.java:1209) ~[spring-beans-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1156) ~[spring-beans-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:566) ~[spring-beans-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:526) ~[spring-beans-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[spring-beans-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[spring-beans-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[spring-beans-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:930) ~[spring-beans-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:926) ~[spring-context-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:592) ~[spring-context-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.refresh(SpringApplication.java:729) ~[spring-boot-3.0.0-SNAPSHOT.jar!/:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:428) ~[spring-boot-3.0.0-SNAPSHOT.jar!/:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:310) ~[spring-boot-3.0.0-SNAPSHOT.jar!/:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1301) ~[spring-boot-3.0.0-SNAPSHOT.jar!/:3.0.0-SNAPSHOT]\r\n\tat org.springframework.boot.SpringApplication.run(SpringApplication.java:1290) ~[spring-boot-3.0.0-SNAPSHOT.jar!/:3.0.0-SNAPSHOT]\r\n\tat com.example.integrationaot.IntegrationAotApplication.main(IntegrationAotApplication.java:10) ~[classes!/:0.0.1-SNAPSHOT]\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]\r\n\tat org.springframework.boot.loader.MainMethodRunner.run(MainMethodRunner.java:49) ~[integration-aot-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]\r\n\tat org.springframework.boot.loader.Launcher.launch(Launcher.java:95) ~[integration-aot-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]\r\n\tat org.springframework.boot.loader.Launcher.launch(Launcher.java:58) ~[integration-aot-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]\r\n\tat org.springframework.boot.loader.JarLauncher.main(JarLauncher.java:65) ~[integration-aot-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]\r\nCaused by: java.lang.IllegalArgumentException: Object of class [java.lang.Boolean] must be an instance of boolean\r\n\tat org.springframework.util.Assert.instanceCheckFailed(Assert.java:702) ~[spring-core-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.util.Assert.isInstanceOf(Assert.java:602) ~[spring-core-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.util.Assert.isInstanceOf(Assert.java:633) ~[spring-core-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.aot.AutowiredArguments.get(AutowiredArguments.java:45) ~[spring-beans-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.integration.channel.PublishSubscribeChannel__BeanDefinitions.lambda$getErrorChannelInstance$0(PublishSubscribeChannel__BeanDefinitions.java:31) ~[classes!/:0.0.1-SNAPSHOT]\r\n\tat org.springframework.util.function.ThrowingFunction.apply(ThrowingFunction.java:63) ~[spring-core-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.util.function.ThrowingFunction.apply(ThrowingFunction.java:51) ~[spring-core-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.beans.factory.aot.AutowiredInstantiationArgumentsResolver.resolve(AutowiredInstantiationArgumentsResolver.java:156) ~[spring-beans-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\tat org.springframework.integration.channel.PublishSubscribeChannel__BeanDefinitions.getErrorChannelInstance(PublishSubscribeChannel__BeanDefinitions.java:31) ~[classes!/:0.0.1-SNAPSHOT]\r\n\tat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainInstanceFromSupplier(AbstractAutowireCapableBeanFactory.java:1223) ~[spring-beans-6.0.0-SNAPSHOT.jar!/:6.0.0-SNAPSHOT]\r\n\t... 25 common frames omitted\r\n```\r\n\r\nThis looks like a bug in the AOT generated code (?).\r\n\r\nReproducer repo: https://github.com/mhalbritter/integration-aot",
    "labels": [
      "type: bug",
      "in: core",
      "theme: aot"
    ],
    "comments": [
      {
        "author": "jhoeller",
        "created_at": "2022-06-29T12:40:24Z",
        "body": "Looks like a strict instance-of check where we should be using `isAssignableValue` as we do in other places."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "a21b27e6d924e5be356d337ad374e007469ccbda"
      ]
    }
  },
  {
    "number": 28728,
    "title": "Support by-type constructor references in `ConstructorOrFactoryMethodResolver`",
    "state": "closed",
    "created_at": "2022-06-29T13:20:21Z",
    "updated_at": "2022-06-29T15:04:04Z",
    "author": "mp911de",
    "url": "https://github.com/spring-projects/spring-framework/issues/28728",
    "body": "`ConstructorOrFactoryMethodResolver` supports type various constructor argument types such as by-name references through inspecting `BeanReference`. It would be neat to also support `RuntimeBeanReference` with a `Class` argument to lookup beans by their type rather than just the type name. Having by-type references that work similar to the non-AOT runtime arrangement would simplify bean definitions.\r\n\r\nFWIW, a `RuntimeBeanReference` leads to the following exception:\r\n\r\n```\r\nException in thread \"main\" org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'org.springframework.data.mongodb.core.mapping.MongoMappingContext' available\r\n\tat org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeanDefinition(DefaultListableBeanFactory.java:862)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getMergedLocalBeanDefinition(AbstractBeanFactory.java:1302)\r\n\tat org.springframework.beans.factory.support.AbstractBeanFactory.getType(AbstractBeanFactory.java:691)\r\n\tat org.springframework.beans.factory.aot.ConstructorOrFactoryMethodResolver.determineParameterValueType(ConstructorOrFactoryMethodResolver.java:137)\r\n\tat org.springframework.beans.factory.aot.ConstructorOrFactoryMethodResolver.determineParameterValueTypes(ConstructorOrFactoryMethodResolver.java:125)\r\n\tat org.springframework.beans.factory.aot.ConstructorOrFactoryMethodResolver.resolve(ConstructorOrFactoryMethodResolver.java:84)\r\n\tat org.springframework.beans.factory.aot.ConstructorOrFactoryMethodResolver.resolve(ConstructorOrFactoryMethodResolver.java:436)\r\n\tat org.springframework.beans.factory.aot.BeanDefinitionMethodGenerator.<init>(BeanDefinitionMethodGenerator.java:73)\r\n\tat org.springframework.beans.factory.aot.BeanDefinitionMethodGeneratorFactory.getBeanDefinitionMethodGenerator(BeanDefinitionMethodGeneratorFactory.java:91)\r\n\tat org.springframework.beans.factory.aot.BeanRegistrationsAotProcessor.processAheadOfTime(BeanRegistrationsAotProcessor.java:44)\r\n\tat org.springframework.beans.factory.aot.BeanRegistrationsAotProcessor.processAheadOfTime(BeanRegistrationsAotProcessor.java:32)\r\n\tat org.springframework.context.aot.BeanFactoryInitializationAotContributions.getContributions(BeanFactoryInitializationAotContributions.java:67)\r\n\tat org.springframework.context.aot.BeanFactoryInitializationAotContributions.<init>(BeanFactoryInitializationAotContributions.java:49)\r\n\tat org.springframework.context.aot.BeanFactoryInitializationAotContributions.<init>(BeanFactoryInitializationAotContributions.java:44)\r\n\tat org.springframework.context.aot.ApplicationContextAotGenerator.generateApplicationContext(ApplicationContextAotGenerator.java:53)\r\n\tat org.springframework.boot.AotProcessor.performAotProcessing(AotProcessor.java:150)\r\n\tat org.springframework.boot.AotProcessor.process(AotProcessor.java:111)\r\n\tat org.springframework.boot.AotProcessor.main(AotProcessor.java:221)\r\n```",
    "labels": [
      "type: bug",
      "in: core",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "d2e27ad75407e00175f717e2ed5bcf9249e6825c"
      ]
    }
  },
  {
    "number": 28735,
    "title": "Move `BindingReflectionHintsRegistrar` to spring-context",
    "state": "closed",
    "created_at": "2022-06-30T09:53:20Z",
    "updated_at": "2022-06-30T10:10:27Z",
    "author": "sdeleuze",
    "url": "https://github.com/spring-projects/spring-framework/issues/28735",
    "body": "Move `BindingReflectionHintsRegistrar` to `spring-context` module in `org.springframework.context.aot` package because:\r\n - Otherwise we can't test it with the agent that lives in spring-core-test\r\n - Conceptually this is for reflection based serialization like Jackson (that lives in `spring-web`) and databinder (that lives in `spring-context`)",
    "labels": [
      "type: task",
      "in: core",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "9135921d1d5522ababce683fd027adfcdda55822"
      ]
    }
  },
  {
    "number": 28745,
    "title": "Simplify hint registration for Spring AOP proxies",
    "state": "closed",
    "created_at": "2022-07-02T11:18:52Z",
    "updated_at": "2022-07-11T15:56:15Z",
    "author": "sbrannen",
    "url": "https://github.com/spring-projects/spring-framework/issues/28745",
    "body": "For JDK dynamic proxies created by Spring's AOP support, `SpringProxy`, `Advised`, and `DecoratingProxy` will often be included in the interfaces that the proxy implements.\r\n\r\nHere's an example taken from Spring Integration.\r\n\r\n```java\r\nproxyHints\r\n    .registerJdkProxy(RequestReplyExchanger.class, SpringProxy.class, Advised.class, DecoratingProxy.class)\r\n    .registerJdkProxy(AbstractReplyProducingMessageHandler.RequestHandler.class, SpringProxy.class, Advised.class, DecoratingProxy.class)\r\n    .registerJdkProxy(IntegrationFlow.class, SmartLifecycle.class, SpringProxy.class, Advised.class, DecoratingProxy.class);\r\n```\r\n\r\nWe should investigate options for simplifying the proxy hint registration for Spring AOP proxies so that users are not required to specify `SpringProxy`, `Advised`, and `DecoratingProxy`.\r\n\r\nOne option would be to introduce a new `registerSpringJdkProxy(...)` method (or similar) in `ProxyHints` that automatically registers the required Spring AOP interfaces. Though, it is not always the case that all 3 of those interfaces are implemented by the proxy. So we could document that this particular `registerSpringJdkProxy(...)` variant always registers those 3 particular interfaces to cover common use cases and allow users to continue to use `registerJdkProxy(...)` when the additional Spring AOP interfaces differ from that common set of 3.",
    "labels": [
      "in: core",
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [
      {
        "author": "snicoll",
        "created_at": "2022-07-02T14:00:13Z",
        "body": "We can't really do that, can we? Spring AOP is higher in the dependency tree. Perhaps something along the lines of RuntimeHintsUtils, but for SpringAopProxy?\n\nI am afk but perhaps AopUtils could be used?"
      },
      {
        "author": "sbrannen",
        "created_at": "2022-07-02T14:54:39Z",
        "body": "> Spring AOP is higher in the dependency tree.\r\n\r\nThat's a good point. We definitely cannot refer to the `Class` references, and it does unfortunately seem a bit out of place to be talking about Spring AOP in Spring Core.\r\n\r\n> We can't really do that, can we?\r\n\r\nWell, by using the class names we can implement it like this:\r\n\r\n```java\r\npublic ProxyHints registerSpringAopJdkProxy(Class<?>... proxiedInterfaces) {\r\n    return registerJdkProxy(jdkProxyHint -> {\r\n        jdkProxyHint.proxiedInterfaces(proxiedInterfaces);\r\n        jdkProxyHint.proxiedInterfaces(\r\n            TypeReference.of(\"org.springframework.aop.SpringProxy\"),\r\n            TypeReference.of(\"org.springframework.aop.framework.Advised\"),\r\n            TypeReference.of(\"org.springframework.core.DecoratingProxy\"));\r\n    });\r\n}\r\n```\r\n\r\n> Perhaps something along the lines of RuntimeHintsUtils, but for SpringAopProxy?\r\n\r\nSure. If we don't want to use the class name based approach I pasted above, we could introduce something along the lines of `RuntimeHintsUtils` for Spring AOP proxies in `spring-aop`.\r\n\r\n\r\n> I am afk but perhaps AopUtils could be used?\r\n\r\nNot that I'm aware of."
      },
      {
        "author": "snicoll",
        "created_at": "2022-07-03T21:20:23Z",
        "body": "> Well, by using the class names we can implement it like this:\r\n\r\nThat sounds like hiding a conceptual cycle to me.\r\n\r\n> Sure. If we don't want to use the class name based approach I pasted above, \r\n\r\nAre we doing this elsewhere, except in Javadoc links?\r\n\r\n> Not that I'm aware of.\r\n\r\nHow do you mean? I believe `AopUtils#registerAopProxyHints(Class<?>... proxiedInterfaces)` could be  a possibility."
      },
      {
        "author": "sbrannen",
        "created_at": "2022-07-04T15:12:27Z",
        "body": "**Team Decision**:\r\n\r\n- Introduce static utility methods in `AopProxyUtils` that combine user provided interfaces with `SpringProxy`, `Advised`, and `DecoratingProxy`.\r\n- This method could be named something along the lines of `completeProxiedInterfaces()` to align with the existing methods in that class.\r\n- We will need to two variants, one accepting `Class<?>...` and one accepting `TypeReference...`.\r\n- The returned arrays should be able to be supplied as input to both variants of `proxyHints.registerJdkProxy()`.\r\n- Cross reference these new methods from the Javadoc in the existing `registerJdkProxy()` methods in `spring-core` to make the AOP specific support _discoverable_ via the core user API."
      },
      {
        "author": "snicoll",
        "created_at": "2022-07-04T19:23:01Z",
        "body": "> Cross reference these new methods from the Javadoc in the existing registerJdkProxy() methods in spring-core to make the AOP specific support discoverable via the core user API.\r\n\r\nIf that is so important this was discussed, I'd like us to review `RuntimeHintsUtils#registerAnnotation`."
      },
      {
        "author": "sbrannen",
        "created_at": "2022-07-05T09:34:27Z",
        "body": "> If that is so important this was discussed, I'd like us to review `RuntimeHintsUtils#registerAnnotation`.\r\n\r\nDo you mean you'd like to cross reference `RuntimeHintsUtils` from `ProxyHints`?\r\n\r\nIf so, I agree that that's a good idea.\r\n\r\nIn any case, feel free to bring it up in the team or open an issue to discuss what you'd like to review."
      },
      {
        "author": "sbrannen",
        "created_at": "2022-07-11T14:39:59Z",
        "body": "Reopening to reduce the scope of this feature to `Class` references."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "49dfcad44743d9c87cfe64af263648861e4dea6b",
        "7bfcb4c753c86768a28c9612966b8f30184b48f2",
        "5178e9c28eda20859829937c1bc3d38b8b314726"
      ]
    }
  },
  {
    "number": 28754,
    "title": "Add native image support for WebSocket STOMP messaging",
    "state": "closed",
    "created_at": "2022-07-04T13:07:04Z",
    "updated_at": "2022-07-11T17:43:38Z",
    "author": "mhalbritter",
    "url": "https://github.com/spring-projects/spring-framework/issues/28754",
    "body": "The native sample `websocket-stomp` works with AOT mode, but not in native image.\r\n\r\nI identified at least two problems:\r\n\r\n* The return and parameter values from `GreetingController` are not registered in `reflect-config.json`\r\n* Even if I manually add runtime hints, the handler methods are not called when a STOMP message arrives at the server",
    "labels": [
      "in: web",
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "938b05bd322f51d70204f74939a4d01cc687b2c0",
        "bcb6f13fc4e0b38e9e9739f9709f621963cca5bd"
      ]
    }
  },
  {
    "number": 28760,
    "title": "Deprecate convention-based annotation attribute overrides in favor of `@AliasFor`",
    "state": "closed",
    "created_at": "2022-07-05T13:49:56Z",
    "updated_at": "2025-01-28T13:13:19Z",
    "author": "sbrannen",
    "url": "https://github.com/spring-projects/spring-framework/issues/28760",
    "body": "## Overview\n\n**Implicit** convention-based annotation attribute overrides have been supported for a long time; however, Spring Framework 4.2 introduced support for **explicit** annotation attribute overrides via `@AliasFor`.\n\nSince explicit overrides are favorable to implicit overrides, and since the support for convention-based overrides increases the complexity of Spring's annotation search algorithms, we will deprecate convention-based overrides in 6.0 and remove the support in 7.0 (see #28761).\n\n## Deliverables\n\n- [x] in 6.0, whenever a convention-based override is detected, log a warning stating the reasons mentioned above\n",
    "labels": [
      "in: core",
      "type: enhancement"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "e09cdcd92077e1c44772fe3d9fa1e1e638f59fe0",
        "73d92d66b938a5ff9080442396bed13c421d1f8f",
        "0beee7dc69f157a5cfd478c63abdc4b68ed6cc7e",
        "d7b45b7c8ee7bf9fc780d5512005a273846d9ee1",
        "0e861af0502e7dc7622f574e496652013c3f08a6",
        "a68f5b1674635bf3de79435f83c3d8f4b7ae9098"
      ]
    }
  },
  {
    "number": 28766,
    "title": "Upgrade to Reactor 2022.0.0-M4",
    "state": "closed",
    "created_at": "2022-07-06T10:30:21Z",
    "updated_at": "2022-07-13T09:58:08Z",
    "author": "rstoyanchev",
    "url": "https://github.com/spring-projects/spring-framework/issues/28766",
    "body": "",
    "labels": [
      "type: dependency-upgrade"
    ],
    "comments": [
      {
        "author": "rstoyanchev",
        "created_at": "2022-07-13T09:58:08Z",
        "body": "This was done in 7055ddb489d18c4940c5685eca8ea72f29c58679."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "0938909cd91772dd6de0387107ebfeef853642e0",
        "7f0abb718b0d596f58e127df3e83b59c11e43289"
      ]
    }
  },
  {
    "number": 28772,
    "title": "Provide SerializationHintsPredicates in RuntimeHintsPredicates",
    "state": "closed",
    "created_at": "2022-07-07T14:19:45Z",
    "updated_at": "2022-07-11T20:37:56Z",
    "author": "marcusdacoregio",
    "url": "https://github.com/spring-projects/spring-framework/issues/28772",
    "body": "It would be nice to have the `SerializationHintsPredicates` in `RuntimeHintsPredicates` as we have for `reflections`, `resource` and `proxies`.\r\n\r\nI've created one myself for now: \r\n```java\r\npublic class SerializationHintsPredicates {\r\n\r\n\tpublic TypeHintPredicate onType(TypeReference typeReference) {\r\n\t\tAssert.notNull(typeReference, \"'typeReference' should not be null\");\r\n\t\treturn new TypeHintPredicate(typeReference);\r\n\t}\r\n\r\n\tpublic TypeHintPredicate onType(Class<?> type) {\r\n\t\tAssert.notNull(type, \"'type' should not be null\");\r\n\t\treturn new TypeHintPredicate(TypeReference.of(type));\r\n\t}\r\n\r\n\tpublic static class TypeHintPredicate implements Predicate<RuntimeHints> {\r\n\r\n\t\tprivate final TypeReference type;\r\n\r\n\t\tTypeHintPredicate(TypeReference type) {\r\n\t\t\tthis.type = type;\r\n\t\t}\r\n\r\n\t\t@Override\r\n\t\tpublic boolean test(RuntimeHints hints) {\r\n\t\t\treturn hints.serialization().javaSerialization().anyMatch((hint) -> hint.getType().equals(this.type));\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n```",
    "labels": [
      "type: enhancement",
      "theme: aot"
    ],
    "comments": [
      {
        "author": "snicoll",
        "created_at": "2022-07-11T20:37:56Z",
        "body": "Good catch @marcusdacoregio, thanks!"
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "ee6a4e7c1e3245bd758c1a553f21ae8b3a8a6dbc"
      ]
    }
  },
  {
    "number": 28773,
    "title": "AnnotationTypeMapping tracks @AliasFor mappings as convention-based",
    "state": "closed",
    "created_at": "2022-07-07T15:31:46Z",
    "updated_at": "2023-08-23T08:11:40Z",
    "author": "sbrannen",
    "url": "https://github.com/spring-projects/spring-framework/issues/28773",
    "body": "While working on #28760, I noticed that `AnnotationTypeMapping.addConventionMappings()` actually adds convention-based mappings that it should not.\r\n\r\nFor example, in certain circumstances an explicit annotation attribute override configured via `@AliasFor` can be mapped as convention-based.\r\n\r\nAlthough this does not _appear_ to cause negative side effects (other than unnecessary processing), this is technically a bug that should be addressed.\r\n\r\nHowever, since there may be unknown use cases that somehow rely on the behavior of this bug, I currently only intend to apply the fix to 6.0.",
    "labels": [
      "type: bug",
      "in: core"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "81acbe7e2f2e2fc7afd83f9759e6ad8470766de1"
      ]
    }
  },
  {
    "number": 28784,
    "title": "Upgrade to Kotlin 1.7.10",
    "state": "closed",
    "created_at": "2022-07-11T08:07:14Z",
    "updated_at": "2022-07-11T08:14:21Z",
    "author": "sdeleuze",
    "url": "https://github.com/spring-projects/spring-framework/issues/28784",
    "body": "",
    "labels": [
      "type: dependency-upgrade",
      "theme: kotlin"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "4104ea7c1cbb5509664729a96b59f06d79bd5291"
      ]
    }
  },
  {
    "number": 28786,
    "title": "Reject JDK proxy hint registration for sealed interfaces",
    "state": "closed",
    "created_at": "2022-07-11T15:44:55Z",
    "updated_at": "2022-07-11T15:52:19Z",
    "author": "sbrannen",
    "url": "https://github.com/spring-projects/spring-framework/issues/28786",
    "body": "",
    "labels": [
      "type: enhancement"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "656dc549b16900f93dbbdce77c6b07cb4fccaa7e"
      ]
    }
  },
  {
    "number": 28787,
    "title": "Upgrade client support to R2DBC 1.0",
    "state": "closed",
    "created_at": "2022-07-11T16:37:46Z",
    "updated_at": "2022-07-13T08:33:04Z",
    "author": "sbrannen",
    "url": "https://github.com/spring-projects/spring-framework/issues/28787",
    "body": "This is a follow up to #28059.\r\n\r\nSince R2DBC 1.0 has been released, we should upgrade and ensure compatibility with 1.0 for Spring Framework 6.0.\r\n\r\nFor example, `io.r2dbc.spi.Result.getRowsUpdated()` returned `Publisher<Integer>` in 0.9 and apparently returns `Publisher<Long>` in 1.0.",
    "labels": [
      "in: data",
      "type: dependency-upgrade"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "7055ddb489d18c4940c5685eca8ea72f29c58679",
        "9d1dfc733d911e1a6aea7d8bb83fb6bd40f0168d"
      ]
    }
  },
  {
    "number": 28799,
    "title": "Move RuntimeHints predicates to a dedicated package",
    "state": "closed",
    "created_at": "2022-07-12T13:07:33Z",
    "updated_at": "2022-07-12T14:20:47Z",
    "author": "snicoll",
    "url": "https://github.com/spring-projects/spring-framework/issues/28799",
    "body": "The predicates support deserves to be in its own package. This will also avoid `.hint` to be too flat.",
    "labels": [
      "type: task"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "54a3f66d1d8ed97cf7d8449f70f579712b27afb9",
        "40c8b7c59f54e67a9279d49bbf0f35db77c45843"
      ]
    }
  },
  {
    "number": 28801,
    "title": "Name RuntimeHintsRegistrar implementations consistently",
    "state": "closed",
    "created_at": "2022-07-12T14:14:56Z",
    "updated_at": "2022-07-12T16:33:50Z",
    "author": "snicoll",
    "url": "https://github.com/spring-projects/spring-framework/issues/28801",
    "body": "We'd like to use `RuntimeHints` as suffix for `RuntimeHintsRegistrar` implementations (to follow the naming of `@ImportRuntimeHints`), and because it reads better than a `RuntimeHintsRegistrar` suffix. \r\n\r\nThis issue is about harmonizing the names we have at the moment.",
    "labels": [
      "type: task",
      "theme: aot"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "2c92d7da8f8feace44fcbef1578e80b341109b41"
      ]
    }
  },
  {
    "number": 28813,
    "title": "`HibernateTransactionManager` compatibility with Hibernate 6.0/6.1",
    "state": "closed",
    "created_at": "2022-07-13T14:13:11Z",
    "updated_at": "2022-07-13T16:11:17Z",
    "author": "odrotbohm",
    "url": "https://github.com/spring-projects/spring-framework/issues/28813",
    "body": "We [already fixed](https://github.com/spring-projects/spring-framework/issues/28007) references to API removed in Hibernate 6 for `HibernateJpaVendorAdapter` but apparently `HibernateTransactionManager` also refers to the [very same API](https://github.com/spring-projects/spring-framework/blob/0b5c5dbc313fcd61abdf8e0f3b68a6a8fbbc0f98/spring-orm/src/main/java/org/springframework/orm/hibernate5/HibernateTransactionManager.java#L565).",
    "labels": [
      "in: data",
      "type: enhancement"
    ],
    "comments": [
      {
        "author": "jhoeller",
        "created_at": "2022-07-13T15:58:21Z",
        "body": "To be clear, `HibernateTransactionManager` is part of our legacy `orm.hibernate5` package and should be replaced with `JpaTransactionManager` plus `HibernateJpaDialect` / `HibernateJpaVendorAdapter` with `LocalContainerEntityManagerFactoryBean` since we officially only support Hibernate 6.x via JPA.\r\n\r\nThat said, it turns out that we can make `HibernateTransactionManager` compatible with Hibernate 6.0/6.1 with a few minor tweaks where we're calling Hibernate 5.6's internal connection handling mechanisms instead of the public API (the latter is gone in Hibernate 6.0 but the internal coordinator SPI is still the same). We won't be able to guarantee compatibility with Hibernate 6.x going forward, but for a start this allows usage of `LocalSessionFactoryBean` and `HibernateTransactionManager` for transitional purposes when upgrading from Hibernate 5.5/5.6 to 6.0/6.1."
      }
    ],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "7a042062f59deb596e9208ecafebd4a08139dbf0"
      ]
    }
  },
  {
    "number": 28816,
    "title": "Guard against NPE in PathMatchConfigurer",
    "state": "closed",
    "created_at": "2022-07-13T17:09:29Z",
    "updated_at": "2022-07-13T19:24:51Z",
    "author": "mbhave",
    "url": "https://github.com/spring-projects/spring-framework/issues/28816",
    "body": "[This](https://github.com/spring-projects/spring-framework/blob/7a042062f59deb596e9208ecafebd4a08139dbf0/spring-webmvc/src/main/java/org/springframework/web/servlet/config/annotation/PathMatchConfigurer.java#L156) would cause an NPE if `suffixPatternMatch` is `null`.\r\n\r\n```java\r\nCaused by: java.lang.NullPointerException: Cannot invoke \"java.lang.Boolean.booleanValue()\" because \"suffixPatternMatch\" is null\r\n\tat org.springframework.web.servlet.config.annotation.PathMatchConfigurer.setUseSuffixPatternMatch(PathMatchConfigurer.java:156) ~[spring-webmvc-6.0.0-SNAPSHOT.jar:6.0.0-SNAPSHOT]\r\n\tat com.example.demo.PathMatchingThingyApplication.configurePathMatch(PathMatchingThingyApplication.java:14) ~[main/:na]\r\n\tat org.springframework.web.servlet.config.annotation.WebMvcConfigurerComposite.configurePathMatch(WebMvcConfigurerComposite.java:53) ~[spring-webmvc-6.0.0-SNAPSHOT.jar:6.0.0-SNAPSHOT]\r\n\tat org.springframework.web.servlet.config.annotation.DelegatingWebMvcConfiguration.configurePathMatch(DelegatingWebMvcConfiguration.java:58) ~[spring-webmvc-6.0.0-SNAPSHOT.jar:6.0.0-SNAPSHOT]\r\n\tat org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport.getPathMatchConfigurer(WebMvcConfigurationSupport.java:388) ~[spring-webmvc-6.0.0-SNAPSHOT.jar:6.0.0-SNAPSHOT]\r\n\tat org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport.mvcResourceUrlProvider(WebMvcConfigurationSupport.java:614) ~[spring-webmvc-6.0.0-SNAPSHOT.jar:6.0.0-SNAPSHOT]\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]\r\n\tat org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:130) ~[spring-beans-6.0.0-SNAPSHOT.jar:6.0.0-SNAPSHOT]\r\n\t... 34 common frames omitted\r\n```\r\n\r\nWhile the API doesn't expect nulls, it's worth investigating whether switching to `boolean` or adding an `Assert` would be possible. Similar case for `registeredSuffixPatternMatch `.",
    "labels": [
      "type: bug"
    ],
    "comments": [],
    "closing_references": {
      "pull_requests": [],
      "commits": [
        "4c08c276f79e00f66d56344b9aca901f1b326e0c"
      ]
    }
  }
]