*このドキュメントは生成AI(Claude Sonnet 4.5)によって2026年1月6日に生成されました。*

## 課題概要

Spring FrameworkのWebモジュール内でパッケージ間の循環依存（パッケージサイクル）が発生している問題の修正です。

**背景説明**:
- **パッケージサイクル**: 2つ以上のパッケージがお互いに依存し合っている状態。設計上望ましくない
- **MissingServletRequestPartException**: マルチパートリクエストで必要なパートが欠落している場合にスローされる例外
- **ServletRequestBindingException**: リクエストバインディングに関する例外の基底クラス

**問題の詳細**:
課題 [#27910](https://github.com/spring-projects/spring-framework/issues/27910) / [#27948](https://github.com/spring-projects/spring-framework/issues/27948) で、`MissingServletRequestPartException`が`ServletRequestBindingException`を継承するように変更されました。

しかし、これにより以下のパッケージサイクルが発生：
- `web.multipart`パッケージ: `MissingServletRequestPartException`が存在
- `web.bind`パッケージ: バインダー実装が`web.multipart`に依存
- 結果: `web.bind` ← `web.multipart` ← `web.bind` という循環参照

**根本原因**:
`MissingServletRequestPartException`が2つの異なる目的で使用されていた：
1. 低レベルAPI（`RequestPartServletServerHttpRequest`）での例外スロー → `web.multipart`に存在すべき
2. ハンドラーメソッド引数バインディング（`RequestParamMethodArgumentResolver`）での使用 → `web.bind`に存在すべき

## 原因

設計上の問題により、1つの例外クラスが2つの異なるレイヤー（低レベルのマルチパート処理とバインディングレイヤー）で使用されていたため。

課題 [#27948](https://github.com/spring-projects/spring-framework/issues/27948) での継承関係の変更が、既存のパッケージ依存関係と衝突してパッケージサイクルを引き起こしました。

## 対応方針

[2269c00](https://github.com/spring-projects/spring-framework/commit/2269c0063a4f56985a8903b16d922ef05a7e6b30)のコミットで修正されました。

**検討された選択肢**:

1. **別の例外型を導入**（当初の提案）:
   - バインディング目的用に新しい例外クラスを作成
   - Spring Framework 6.0からは新しい例外のみ`ServletRequestBindingException`を継承

2. **変更の取り消し**（採用された方針）:
   - [#27948](https://github.com/spring-projects/spring-framework/issues/27948) の変更を元に戻す
   - `MissingServletRequestPartException`を再び`ServletException`を継承させる
   - `ServletRequestBindingException`を継承しない理由を明示的に文書化

**採用された理由**:
- 欠落したパートに対して単一の例外を持つことは、検出場所に関わらず有用
- `RequestPartServletServerHttpRequest`は最も低レベルで必要とされるため`web.multipart`に配置するのが適切
- [#27910](https://github.com/spring-projects/spring-framework/issues/27910) は実際の問題というより質問だった

参考: [#13284](https://github.com/spring-projects/spring-framework/issues/13284) - `MissingServletRequestPartException`の元々の導入理由（マルチパート処理における4xx対5xxエラーの区別）
