*このドキュメントは生成AI(Claude Sonnet 4.5)によって2026年1月6日に生成されました。*

## 課題概要

`SourceFileAssert`クラスから、実際には使用されていない多くのアサーションメソッドを削除し、APIを整理するタスクです。

**背景説明**:
- **SourceFileAssert**: AOTで生成されたJavaソースファイルを検証するためのアサーションクラス（AssertJスタイル）
- **qdox**: Javaソースコードをパースするライブラリ
- **実装の詳細**: 外部に公開されない、内部実装で使用されるライブラリやAPIの詳細

**問題の詳細**:
AOTテストコードで使用するために`SourceFileAssert`クラスが作成されましたが、実装中に以下の問題が判明：

1. **未使用のアサーションメソッドが多数存在**: 当初想定した検証パターンの多くが実際には不要だった
2. **qdoxへの依存**: ソースコード解析にqdoxライブラリを使用しているが、これが外部に露出
3. **モジュール公開前の課題**: `spring-core-test`モジュールを正式に公開する前に整理が必要

**削除対象の例**:
```java
public class SourceFileAssert {
    // 使用されているメソッド
    public SourceFileAssert contains(String substring) { ... }
    public SourceFileAssert hasImport(String importName) { ... }
    
    // 使用されていないメソッド（削除対象）
    public SourceFileAssert hasField(String fieldName) { ... }
    public SourceFileAssert hasAnnotation(String annotationName) { ... }
    public SourceFileAssert hasMethod(String methodName, String... paramTypes) { ... }
    // ...その他多数
}
```

## 原因

AOTコード生成のテストAPIを設計する段階で、様々な検証パターンを想定して多くのアサーションメソッドを実装しました。

しかし、実際のテストコードを書く中で、以下のことが明らかに：
- 実際に必要な検証は限定的
- より単純なアサーションで十分
- 複雑なアサーションは保守コストが高い

このまま公開すると、使用されないAPIがパブリックインターフェースとして固定され、将来の変更が困難になります。

## 対応方針

[74caa92](https://github.com/spring-projects/spring-framework/commit/74caa9213a44e2b613025b2387d41389c9344953)のコミットで実装されました。

**実装内容**:

1. **未使用メソッドの削除**:
```java
// 削除前
public class SourceFileAssert extends AbstractAssert<SourceFileAssert, SourceFile> {
    public SourceFileAssert contains(String substring) { ... }       // 使用中 - 保持
    public SourceFileAssert hasImport(String importName) { ... }     // 使用中 - 保持
    public SourceFileAssert hasPackage(String packageName) { ... }   // 未使用 - 削除
    public SourceFileAssert hasField(String fieldName) { ... }       // 未使用 - 削除
    public SourceFileAssert hasMethod(...) { ... }                   // 未使用 - 削除
    public SourceFileAssert hasClassAnnotation(...) { ... }          // 未使用 - 削除
    // ...その他多数
}

// 削除後
public class SourceFileAssert extends AbstractAssert<SourceFileAssert, SourceFile> {
    // 実際に使用されているメソッドのみ保持
    public SourceFileAssert contains(String substring) { ... }
    public SourceFileAssert hasImport(String importName) { ... }
    // 必要最小限のメソッドのみ
}
```

2. **qdoxの実装詳細化**:
   - qdoxライブラリへの依存を内部実装の詳細として隠蔽
   - 将来的にqdoxを別の実装に置き換える柔軟性を確保
   - パブリックAPIからqdoxの型を排除

**使用例**（整理後）:
```java
@Test
void generatedSourceShouldContainExpectedCode() {
    SourceFile sourceFile = ...;  // AOTで生成されたソースファイル
    
    assertThat(sourceFile)
        .contains("public class MyGenerated")
        .hasImport("org.springframework.context.annotation.Bean");
}
```

**メリット**:
- より明確で保守しやすいAPI
- qdoxの実装詳細が隠蔽される
- 将来の変更が容易
- パブリックAPIの肥大化を防止
- 使用者が理解しやすいシンプルなインターフェース

**関連課題**: [#28558](https://github.com/spring-projects/spring-framework/issues/28558) - `spring-core-test`モジュールの公開
