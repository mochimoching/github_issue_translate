*このドキュメントは生成AI(Claude Sonnet 4.5)によって2026年1月6日に生成されました。*

## 課題概要

`spring-core-test`モジュールをSpring Frameworkの正式な公開モジュールとして利用可能にするタスクです。

**背景説明**:
- **spring-core-test**: AOTテストユーティリティを含む新しいテストサポートモジュール
- **TestCompiler**: 動的にJavaソースコードをコンパイルして実行するテストユーティリティクラス
- **モジュールの公開**: Mavenリポジトリでダウンロード可能にし、他のプロジェクトから依存関係として使用可能にすること

**問題の詳細**:
Spring Frameworkの内部でAOTコード生成のテストをサポートするために`spring-core-test`モジュールが作成されましたが、当初は内部使用のみを想定していました。

しかし、Spring Bootプロジェクトでも以下の機能が必要になりました：
- `TestCompiler`: 生成されたJavaコードを動的にコンパイル・実行してテスト
- `SourceFileAssert`: 生成されたソースファイルの内容を検証
- その他のAOTテストユーティリティ

**Spring Bootでの使用例**:
```java
// Spring BootのAOTテストコード
@Test
void generatedCodeShouldCompile() {
    // AOTで生成されたソースコード
    String generatedSource = """
        package com.example;
        
        public class GeneratedConfig {
            @Bean
            public MyService myService() {
                return new MyService();
            }
        }
        """;
    
    // TestCompilerでコンパイルして実行
    TestCompiler.forSystem()
        .compile(sourceFile("com/example/GeneratedConfig.java", generatedSource));
}
```

**課題**:
Spring Bootが`spring-core-test`を使用するには、このモジュールが公開されている必要があります。

## 原因

`spring-core-test`モジュールは、Spring Framework内部でのAOTテスト用に作成されましたが、当初は公開モジュールとして設計されていませんでした。

しかし、AOT機能がSpring Bootにも拡張され、同様のテストユーティリティが必要になったため、モジュールを公開する必要が生じました。

## 対応方針

[3ebdaea](https://github.com/spring-projects/spring-framework/commit/3ebdaeabd3b40bdfe197b4b2ee3f514906ac936e)のコミットで実装されました。

**実装内容**:

`spring-core-test`モジュールをMavenリポジトリに公開：

1. **Maven座標の設定**:
```xml
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-core-test</artifactId>
    <version>6.0.0-M5</version>
    <scope>test</scope>
</dependency>
```

2. **主要な公開API**:
   - `TestCompiler`: 動的コンパイルとクラスローディング
   - `SourceFile`: コンパイル対象のソースファイル表現
   - `SourceFileAssert`: AssertJスタイルのアサーション
   - その他のAOTテストサポートクラス

3. **公開前の準備**:
   - API整理（[#28556](https://github.com/spring-projects/spring-framework/issues/28556)）
   - ドキュメント作成
   - テストカバレッジの確認

**Spring Bootでの使用**:
```java
// Spring BootのBeanDefinition AOTテスト
@Test
void shouldGenerateValidBeanRegistrationCode() {
    // AOT処理でBean登録コードを生成
    GenerationContext context = ...;
    BeanRegistrationCodeGenerator generator = ...;
    SourceFile sourceFile = generator.generate(context);
    
    // 生成されたコードをコンパイルして検証
    TestCompiler.forSystem()
        .with(CompilerFiles.from(sourceFile))
        .compile(compiled -> {
            // コンパイル成功を確認
            assertThat(compiled.getSourceFile())
                .contains("registerBean")
                .hasImport("org.springframework.beans.factory.support.BeanDefinitionRegistry");
                
            // 実行して動作確認
            Object instance = compiled.getInstance(Object.class);
            assertThat(instance).isNotNull();
        });
}
```

**公開されるユーティリティの例**:
```java
// TestCompiler - 動的コンパイル
TestCompiler.forSystem()
    .compile(sourceFile);

// SourceFileAssert - アサーション
assertThat(generatedSource)
    .contains("public class")
    .hasImport("org.springframework.context.annotation.Bean");

// その他テストサポートクラス
```

**メリット**:
- Spring BootでのAOTテストが可能に
- 他のSpringエコシステムプロジェクトでも利用可能
- AOTコード生成のテストベストプラクティスの共有
- テストコードの重複削減

**関連課題**: 
- [#28556](https://github.com/spring-projects/spring-framework/issues/28556) - `SourceFileAssert`のAPI整理
