# o.s.aotとo.s.core間のパッケージの絡まりを解消

**課題番号**: #28496

**状態**: closed | **作成者**: snicoll | **作成日**: 2022-05-20

**ラベル**: type: task, theme: aot

**URL**: https://github.com/spring-projects/spring-framework/issues/28496

**関連リンク**:
- Commits:
  - [16eff68](https://github.com/spring-projects/spring-framework/commit/16eff6835748be5316520b313e08a8a481b900d1)

## 内容

最近、これら2つのパッケージ間にサイクルを作成する2つのヒントレジストラが追加されました。これらを移動することを検討すべきです。おそらく`spring-context`まで移動するのが良いでしょう。なぜなら、それなしでは実際には有用ではないからです。

## コメント

### コメント 1 by snicoll

**作成日**: 2022-05-20

Spring Factoriesヒントの絡まりは、`SpringFactories`のパッケージ保護されたメソッドに依存しているため、少し問題があります。cc @philwebb

### コメント 2 by philwebb

**作成日**: 2022-05-20

難しいですね。`SpringFactoriesLoader.loadFactoriesResource`には、コピー＆ペーストを魅力的でないものにするのに十分なコードがあります。おそらく、それを`protected static`メソッドにして、`SpringFactoriesLoaderRuntimeHintsRegistrar`にプライベートサブクラスを作成して再度アクセスすることができるかもしれません。あるいは、そのメソッドを単にpublicにすることもできます。

### コメント 3 by philwebb

**作成日**: 2022-05-20

`spring-context`がファクトリーヒントを追加するのは少し奇妙に感じます。私は`org.springframework.code`のアイテムのヒント登録を担当する`org.springframework.aot.support`パッケージを作る方が好ましいと思います。

また、レイヤリングを強制するcheckstyleルールがあると本当に素晴らしいでしょう。
