# Allow @CompileWithTargetClassAccess to work with all classes

**Issue番号**: #28580

**状態**: closed | **作成者**: philwebb | **作成日**: 2022-06-07

**ラベル**: type: task, theme: aot

**URL**: https://github.com/spring-projects/spring-framework/issues/28580

**関連リンク**:
- Commits:
  - [46a2f2d](https://github.com/spring-projects/spring-framework/commit/46a2f2d71ce0c1687f289c01746e808f61b140d5)
  - [7119d42](https://github.com/spring-projects/spring-framework/commit/7119d420cece91ca810ce917ac9ade6853169fde)

## 内容

Currently `@CompileWithTargetClassAccess` works by using `MethodHandles.privateLookupIn` and having target classes listed on the annotation. This is quite error prone and makes it impossible to have target access if the there isn't a class in the same package available.

We can probably get away with a reflection approach instead which will simplify a lot of tests.

